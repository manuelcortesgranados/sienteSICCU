<ui:composition
    xmlns:a4j="http://richfaces.org/a4j" 
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    >

    <rich:collapsiblePanel  id="simpleTogglepadres" switchType="ajax" 
                            header="#{var.proyectosAsociados}"
                            expanded="#{Supervisor$Contrato.boolproyectos}" 
                            toggleListener="#{Supervisor$Contrato.llenarObraAsociada}">
        <a4j:ajax event="switch" render="tablaProyectosContrato" />
        <center>

            <h:panelGroup id="tablaProyectosContrato">

                <h:panelGrid columns="3" styleClass="font-general">
                    <h:outputText  styleClass="ikont-"   value="#{var.consultar} #{var.proyectos} "  />
                    <h:inputText value="#{Supervisor$Contrato.buscarproyecto}" size="20" />
                    <a4j:commandButton value="#{var.buscarProyecto}" action="#{Supervisor$Contrato.llenarObraAsociada}" render="tProyHijo"  />
                </h:panelGrid >

                <rich:dataTable id="tProyHijo" styleClass="ikont-tabla-entidad-contratista"
                                rowKeyVar="filaSeleccionada"
                                value="#{Supervisor$Contrato.listaObraContrato}"
                                sortMode="single" var="_row"  rows="20"
                                rowClasses="cabezo_tabla01, cabezo_tabla02" style="width: 87%;">
                    <f:facet name="header">

                        <rich:column styleClass="ikont-colum-superior-consulta" colspan="10">
                            <h:outputText  styleClass="ikont-hot-contratoencontrados"   value="#{var.proyectos} encontrados #{Supervisor$Contrato.proyAsociados.size()} #{var.paginaCiu} #{Supervisor$Contrato.pagina} #{var.deCiu} #{Supervisor$Contrato.totalpaginas}" />
                        </rich:column>
                    </f:facet>
                    <rich:column id="tc_strnrocontrato"   styleClass="ikont-rc-tcstrnrocontrato">
                        <f:facet class="ikont-colum-superior-consulta" name="header">
                            <h:outputText  styleClass="ikont-hot-houtnrocontrato"   value="#{var.numeroObra} "/>
                        </f:facet>
                        <h:outputText  styleClass="ikont-hot-ststrnrocontrato"   id="st_strnrocontrato" value="#{_row.intcodigoobra}"/>
                    </rich:column>
                    <rich:column  styleClass="ikont-rc-tcstrnrocontrato">
                        <f:facet class="ikont-colum-superior-consulta" name="header">
                            <h:outputText  styleClass="ikont-hot-objetocontrato"   value="#{var.nombre} "/>
                        </f:facet>
                        <h:inputTextarea  value="#{_row.strnombreobra}" readonly="true" cols="35" rows="3" />
                    </rich:column>
                    <rich:column id="tc_valor" styleClass="ikont-rc-tcvalor">
                        <f:facet class="ikont-colum-superior-consulta" name="header">
                            <h:outputText  styleClass="ikont-hot-vlrcontra"   value="#{var.vlrcontra}"/>
                        </f:facet>
                        <h:outputText  styleClass="ikont-hot-numvlrcontrato"   value="#{_row.numvaltotobra}">
                            <f:convertNumber pattern="#{var.formatomoneda}"/>
                        </h:outputText>
                    </rich:column>
                    <rich:column id="tc_consultar_contrato"  >
                        <f:facet name="header" >
                            <h:outputText value="#{var.consultar}"/>
                        </f:facet>
<!--                        <a4j:commandLink type="submit" execute="@this" rendered="#{row.tipoestadobra.intestadoobra == 0 and SessionBeanCobra.usuarioObra.renderrecurso.btn_consultaproyecenconvenio}"
                                         id="irDatosBasicos"  onclick="document.location.href = '../NuevoProyecto/tipificacionproyecto.xhtml?id=#{_row.intcodigoobra}';">
                            <h:graphicImage  styleClass="ikont-"    value="/resources/imgs/bt_ver.png" />
                        </a4j:commandLink>-->
                        <a4j:commandLink id="irDetalle"
                                         onclick="document.location.href = '../Supervisor/DetalleObra.xhtml?id=#{_row.intcodigoobra}';">
                            <h:graphicImage  styleClass="ikont-"    value="/resources/imgs/bt_ver.png" />
                            <a4j:param assignTo="#{Supervisor$AdministrarObraNew.contratoId}" value="#{Supervisor$Contrato.contrato.intidcontrato}"/>
                            <a4j:param assignTo="#{Supervisor$Contrato.isFromContracts}" value="false" />
                            <a4j:param assignTo="#{Supervisor$AdministrarObraNew.isFromContracts}" value="false" />    
                        </a4j:commandLink>
                    </rich:column>
                    <f:facet name="footer">

                        <rich:column colspan="10" breakRowBefore="true">
                            <center>
                                <h:panelGrid columns="4">
                                    <a4j:commandButton id="btPriCont" value="#{var.primeroCiu}" disabled="#{!Supervisor$Contrato.primeraPagina}" action="#{Supervisor$Contrato.getFirstProjects}"
                                                       render="tProyHijo">
                                    </a4j:commandButton>

                                    <a4j:commandButton id="btAntCont" value="#{var.anteriorCiu}" disabled="#{!Supervisor$Contrato.anteriorPagina}" action="#{Supervisor$Contrato.getBackProyects}"
                                                       render="tProyHijo">
                                    </a4j:commandButton>

                                    <a4j:commandButton id="btSigCont" value="#{var.siguienteCiu}" disabled="#{!Supervisor$Contrato.siguientePagina}" action="#{Supervisor$Contrato.getNextProyects}"
                                                       render="tProyHijo">
                                    </a4j:commandButton>

                                    <a4j:commandButton id="btUltCont" value="#{var.ultimoCiu}" disabled="#{!Supervisor$Contrato.ultimoPagina}" action="#{Supervisor$Contrato.getLastProjects}"
                                                       render="tProyHijo">
                                    </a4j:commandButton>
                                </h:panelGrid>
                            </center>
                        </rich:column>

                    </f:facet>

                </rich:dataTable>
            </h:panelGroup>
        </center>
    </rich:collapsiblePanel>

</ui:composition>

