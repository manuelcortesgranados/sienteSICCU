<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition  
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:interkont="http://www.interkont.com/jsf"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:m="http://code.google.com/p/gmaps4jsf/"  
    template="/facelets/template_main.xhtml">


    <ui:define name="head">
        <title>Cobra - Supervisor</title>
        <h:outputScript  name="script_supervisor.js"/>
    </ui:define>
    <ui:define name="title">
        <h:outputText rendered="#{!var.permisonuevodise単o}"  styleClass="ikont-hot-imagenesproyecto"    value="#{var.imagenesproyecto}"/>            
        <h:outputText  styleClass="ikont-hot-strnombremedio"    value="#{Supervisor$AdministrarObraNew.obra.strnombremedio}"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodise単o}">
            <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>
            <ui:include src="/facelets/menu_lateral_administrar.xhtml"/>
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodise単o}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml"/>
        </h:panelGroup>

    </ui:define>
    <ui:define name="menusuperior">
        <h:panelGroup rendered="#{SessionBeanCobra.cobraService.ciu}" id="gpMenusuperior">
            <ui:include src="/facelets/menu_superior_detalle_ciudadano.xhtml"/>
        </h:panelGroup>
    </ui:define>
    <ui:define  rendered="#{var.permisonuevodise単o}" name="menusuperior">
        <ui:include  src="/facelets/menu_superior_administrar_proyecto.xhtml"/>
    </ui:define>
    <ui:define name="body">
        <body >
            <h:form target="_blank">
                <h:panelGrid id="panel_imagenesevolucion" styleClass="totalwidth">
                    <h:panelGroup >
                        <center>
                            <h:panelGroup>
                                <h:outputText  styleClass="ikont-hot-houtbusquedarapida"    value="#{var.houtbusquedarapida} "/>
                                <h:inputText id="idpalabraclave" styleClass="ikont-hit-palclav" value="#{Supervisor$AdministrarObraNew.palabraclave}" size="52"/>
                                <a4j:commandButton render="tablaImagenesevolucion" action="#{Supervisor$AdministrarObraNew.buscarimg}" value="Buscar" execute="idpalabraclave, @this"/>
                            </h:panelGroup>


                            <interkont:spacer height="20px" />
                            <h:panelGroup id="panelTablaImagenesevolucion">
                                <rich:dataTable id="tablaImagenesevolucion" 
                                                sortMode="single"
                                                binding="#{Supervisor$AdministrarObraNew.tablaImagenesevolucion}"  
                                                value="#{Supervisor$AdministrarObraNew.listaImagenesevolucionobra}"
                                                var="currentRow" 
                                                rowKeyVar="filaSeleccionada"
                                                rowClasses="cabezo_tabla01, cabezo_tabla02">
                                    <rich:column sortBy="#{currentRow.strubicacion}"  styleClass="ikont-rc-Imagen" id="Imagen" >
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-imagenes"   value="#{var.imagenes}"/>
                                        </f:facet>
                                        <center>
                                            <h:commandLink  action="#{Supervisor$AdministrarObraNew.bt_download_imagenevolucion_action}" immediate="true">
                                                <h:graphicImage  styleClass="ikont-hgi-strubicacion"   value="#{var.ipserver}/#{var.versioncobra}#{currentRow.strubicacion}"
                                                                 />
                                                <rich:jQuery selector="#Imagen img" query="addClass('pic-normal')"/>
                                                <rich:jQuery selector="#Imagen img" query="wrap('&lt;div class=\'wrap1\'&gt;&lt;/div&gt;')" />
                                                <rich:jQuery selector="#Imagen img" query="mouseover(function(){enlargePic(this)})"/>
                                                <rich:jQuery selector="#Imagen img" query="mouseout(function(){normalPic(this)})"/>
                                                <rich:jQuery name="enlargePic" query="stop().animate({width:'100px' })" />
                                                <rich:jQuery name="normalPic"  query="stop().animate({width:'70px'})" />
                                            </h:commandLink>
                                        </center>
                                    </rich:column>
                                    <rich:column 
                                        sortBy="#{currentRow.strnombre}" styleClass="ikont-rc-rcstrnombre">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-descripcion"   value="#{var.descripcion}"/>
                                        </f:facet>
                                        <h:outputText  styleClass="ikont-hot-strnombre"   value="#{currentRow.strnombre}"/>
                                    </rich:column>
                                    <rich:column  styleClass="ikont-rc-rctipo">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-headertipo"   value="#{var.tipo}"/>
                                        </f:facet>
                                        <h:outputText  styleClass="ikont-hot-strdesctipoimagen"   value="#{currentRow.tipoimagen.strdesctipoimagen}"/>
                                    </rich:column>
                                    <rich:column sortBy="#{currentRow.datefecha}" styleClass="ikont-rc-rcfechadelaimagen">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-fechadelaimagenheader"   id="fechadelaimagen" value="#{var.fechadelaimagen}"/>
                                        </f:facet>
                                        <h:outputText  styleClass="ikont-hot-fechadelaimagen"   value="#{currentRow.datefecha}">
                                            <f:convertDateTime pattern="yyyy-MMM-dd"/>
                                        </h:outputText>
                                    </rich:column>
                                    <rich:column styleClass="ikont-rc-rcver">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-verheader"   value="#{var.Ver}"/>
                                        </f:facet>
                                        <h:commandLink action="#{Supervisor$AdministrarObraNew.bt_download_imagenevolucion_action}"
                                                       immediate="true">
                                            <h:graphicImage  styleClass="ikont-hgi-btver"    value="/resources/imgs/bt_ver.png"/>
                                        </h:commandLink>
                                    </rich:column>
                                    <rich:column styleClass="ikont-rc-rceditar" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.ver_editarimagen}">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-headereditar"   value="#{var.editar}"/>
                                        </f:facet>
                                        <a4j:commandLink action="#{Supervisor$AdministrarObraNew.bt_editar_imagenevolucion_action}"
                                                         rendered="#{!currentRow.tipoimagen.boolobligatorio and SessionBeanCobra.usuarioObra.renderrecurso.pnlsubirimagen}" execute="@this"
                                                         oncomplete="#{rich:component('mp_editar_imagenevolucion')}.show(); return true;"
                                                         title="#{var.editar}" render="pg_campos_editar_imagenevolucion"  immediate="true">
                                            <h:graphicImage  styleClass="ikont-hgi-bteditar"  value="/resources/imgs/bt_editar.png"/>
                                        </a4j:commandLink>
                                    </rich:column>
                                    <rich:column styleClass="ikont-rc-rcestablecervalla" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.ver_editarimagen}">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-headerestablecervalla"   value="#{var.establecervalla}"/>
                                        </f:facet>
                                        <h:selectBooleanCheckbox  styleClass="ikont-hsbc-booleanvalla"  value="#{currentRow.booleanvalla}" 
                                                                  disabled="#{currentRow.booleanvalla and SessionBeanCobra.usuarioObra.renderrecurso.pnlsubirimagen}">
                                            <a4j:ajax listener="#{Supervisor$AdministrarObraNew.btEstablecerVallaAction}" event="change"
                                                      oncomplete="#{rich:component('mp_confirmarEstablecerVallaModal')}.show(); return true;"
                                                      render="panelGridConfEstablecerValla" execute="@this" immediate="true"/>
                                        </h:selectBooleanCheckbox>
                                    </rich:column>
                                    <rich:column  styleClass="ikont-rc-rcestablecerimagenactual" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.ver_editarimagen}">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-headerestablecerimagenactual"   value="#{var.establecerimagenactual}"/>
                                        </f:facet>
                                        <h:selectBooleanCheckbox  styleClass="ikont-hsbc-booleanactual"  value="#{currentRow.booleanactual}" 
                                                                  disabled="#{currentRow.booleanactual and SessionBeanCobra.usuarioObra.renderrecurso.pnlsubirimagen}">
                                            <a4j:ajax listener="#{Supervisor$AdministrarObraNew.btEstablecerImagenActualAction}" event="change"
                                                      oncomplete="#{rich:component('mp_confirmarEstablecerImagenActualModal')}.show(); return true;"
                                                      render="panelGridConfEstablecerImagenActual" execute="@this" immediate="true"/>
                                        </h:selectBooleanCheckbox>
                                    </rich:column>
                                    <rich:column  styleClass="ikont-rc-rceliminar" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.ver_eliminarimagen}">
                                        <f:facet name="header">
                                            <h:outputText  styleClass="ikont-hot-headereliminar"   value="#{var.eliminar}"/>
                                        </f:facet>
                                        <a4j:commandLink action="#{Supervisor$AdministrarObraNew.bt_eliminar_imagenevolucion_action}" execute="@this"
                                                         render="tablaImagenesevolucion"
                                                         rendered="#{!currentRow.tipoimagen.boolobligatorio and SessionBeanCobra.usuarioObra.renderrecurso.pnlsubirimagen}" title="#{var.eliminar}"  immediate="true">
                                            <h:graphicImage  styleClass="ikont-hgi-bteliminar"    value="/resources/imgs/bt_eliminar.png"/>
                                        </a4j:commandLink>
                                    </rich:column>
                                    <f:facet name="footer">
                                        <rich:dataScroller renderIfSinglePage="false"></rich:dataScroller>
                                    </f:facet>
                                </rich:dataTable>
                            </h:panelGroup>

                            <interkont:spacer height="20px"/>

                            <rich:collapsiblePanel id="singleslideimage" switchType="client" header="#{var.verimagenes}" expanded="false"  immediate="true"  >
                                <a4j:ajax event="click" render="panelImagenes"  />
                                <h:panelGroup rendered="#{Supervisor$AdministrarObraNew.iniima}">
                                    <ui:include src="SliderImagenes.xhtml"/>
                                </h:panelGroup>
                            </rich:collapsiblePanel>

                            <rich:dataTable   rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.pnlsubirimagen}">
                                <f:facet name="header">
                                    <rich:columnGroup>
                                        <rich:column colspan="3" >
                                            <h:outputText  styleClass="ikont-hot-subidarapidadeimagenes"   value="#{var.subidarapidadeimagenes}"/>
                                        </rich:column>
                                        <rich:column breakRowBefore="true" >
                                            <h:outputText  styleClass="ikont-hot-descripcionpnlsubirimagen"   value="#{var.descripcion}"/>
                                        </rich:column>
                                        <rich:column >
                                            <h:outputText  styleClass="ikont-hot-tipopnlsubirimagen"   value="#{var.tipo}"/>
                                        </rich:column>
                                        <rich:column >
                                            <h:outputText  styleClass="ikont-hot-fechadelaimagenpnlsubirimagen"   value="#{var.fechadelaimagen}"/>
                                        </rich:column>
                                        <rich:column >
                                            <h:outputText  styleClass="ikont-hot-subirpnlsubirimagen"   value="#{var.subir}"/>
                                        </rich:column>
                                    </rich:columnGroup>
                                </f:facet>
                                <f:facet name="footer">
                                    <rich:columnGroup >
                                        <rich:column >
                                            <h:inputText id="txt_strnombre_imagen" value="#{Supervisor$AdministrarObraNew.imagenevolucionobra.strnombre}"  required="true" requiredMessage="#{var.debeproporcionaadescrip}" size="30"/>
                                            <rich:message for="txt_strnombre_imagen" />
                                        </rich:column>
                                        <rich:column  >
                                            <h:selectOneMenu id="select_tipoimagen" value="#{Supervisor$AdministrarObraNew.imagenevolucionobra.tipoimagen.intidtipoimagen}">
                                                <f:selectItems value="#{Supervisor$AdministrarObraNew.selectItemTipoImagen}" />
                                            </h:selectOneMenu>
                                        </rich:column>

                                        <rich:column >
                                            <rich:calendar  locale="#{var.rcalendarlocale}" id="calendar_datefecha" value="#{Supervisor$AdministrarObraNew.imagenevolucionobra.datefecha}"
                                                            required="true" inputSize="10"/>
                                            <rich:message for="calendar_datefecha" />
                                        </rich:column>

                                        <rich:column >
                                            <h:panelGrid id="panel_subir_imagenevolucion"  columns="3">
                                                <a4j:commandButton id="adjuntarImagenevolucion"  immediate="true"  value="#{var.examinar}" styleClass="ikont-"  
                                                                   oncomplete="#{rich:component('panelUploadImagenevolucion')}.show(); return true;"/>
                                                <rich:dataGrid columns="1" rowKeyVar="row" value="#{Supervisor$AdministrarObraNew.cargadorImagenes.archivos}" var="file" >
                                                    <h:outputText  styleClass="ikont-hot-otxtnombrearchivo"   id="otxt_nombrearchivo" value=" #{file.nombre}"/>
                                                </rich:dataGrid>
                                                <a4j:commandButton id="bt_agregar" action="#{Supervisor$AdministrarObraNew.bt_agregar_imagenevolucion_action}"
                                                                   title="#{var.agregar}"
                                                                   value="Agregar" render="panel_imagenesevolucion, gpImagenModal"
                                                                   rendered="#{Supervisor$AdministrarObraNew.cargadorImagenes.numArchivos!=0}">
                                                </a4j:commandButton>
                                            </h:panelGrid>
                                        </rich:column>
                                    </rich:columnGroup>
                                </f:facet>
                            </rich:dataTable>                               
                            <interkont:spacer height="20px" />

                        </center>
                    </h:panelGroup>
                </h:panelGrid>
            </h:form>

            <ui:include src="/modal/panelUploadImagenevolucion.xhtml"/>
            <ui:include src="/modal/confirmarEstablecerVallaModal.xhtml"/>
            <ui:include src="/modal/confirmarEstablecerImagenActualModal.xhtml"/>
            <ui:include src="/modal/eliminarImageneolucionModal.xhtml"/>
            <ui:include src="/modal/editarImagenEvolucionModal.xhtml"/>
            <ui:include src="/modal/modalImagen.xhtml"/>

        </body>
    </ui:define>
</ui:composition>
