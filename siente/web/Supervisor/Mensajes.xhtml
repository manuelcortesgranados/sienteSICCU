<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition  
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:m="http://code.google.com/p/gmaps4jsf/"  
    >

    <ui:define name="head">
        <title>Cobra - Supervisor - Buz√≥n de Mensajes</title>

    </ui:define>
    <ui:define name="footer">
        <ui:include src="/facelets/footer.xhtml" />
    </ui:define>
    <ui:define name="title">
        <h:outputText  styleClass="ikont-hot-houtbuzondemensajes"   value="#{var.houtbuzondemensajes}"/>                              
    </ui:define>
    <ui:define name="body">
        <h:form id="form1">
            
            <center>
                <h:panelGrid columns="5" >
                    <h:outputLabel  styleClass="ikont-hol-labelubicacion"   id="label_ubicacion"    value="#{var.houtbuzondemensajes}"/>
                </h:panelGrid>
            </center>
            <h:panelGrid id="layoutPrincipal"  styleClass="ikont-hpg-layoutprincipal"  >
                <interkont:spacer height="10px"/>
                <h:panelGrid id="pg_nuevo" >
                    <a4j:commandButton id="bt_nuevo" onclick="#{rich:component('mp_nuevo')}.show(); return true;" value="#{var.btnenviarmensaje}" immediate="true"
                                       styleClass="ikont-acb-btnuevo"     />
                </h:panelGrid>
                <interkont:spacer height="10px"/>
                <rich:tabPanel id="tabAlimentar"  tabActiveHeaderClass="btn_sec_med"
                               tabInactiveHeaderClass="btn_pri_med"  switchType="client">
                    <rich:tab header="#{var.rtab_recibidos}" >
                        <h:panelGroup >
                            <center>
                                <h:panelGroup id="panel_filtro_recibidos">
                                    <h:outputText  styleClass="ikont-hot-houtbusquedarapida"  value="#{var.houtbusquedarapida} "/>
                                    <h:inputText value="#{Supervisor$Mensajes.valorFiltroMensajeRecibido}" id="filtroRecibidos" size="52">
                                        <a4j:ajax event="keyup" render="tablaMensajesRecibidos" />
                                    </h:inputText>
                                </h:panelGroup>
                                <interkont:spacer height="10px" />
                                <h:panelGroup id="pl_tabla">
                                    <rich:dataTable id="tablaMensajesRecibidos" sortMode="single"  value="#{Supervisor$Mensajes.listaMensajesRecibidos}" var="currentRow" rowKeyVar="filaSeleccionada" rows="10">
                                        <rich:column filterExpression="#{Supervisor$Mensajes.filtrarMensajesRecibidos}" id="tc-strasuntomensaje" sortBy="#{currentRow.datefecmensaje}" width="300px"
                                                    >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-houtasunto"   value="#{var.houtasunto}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-otxtstrasuntomensajerecibido"   id="otxt-strasuntomensajerecibido" value="#{currentRow.strasuntomensaje}"/>
                                        </rich:column>
                                        <rich:column id="tc-fkusuarioenviarecibido" sortBy="#{currentRow.jsfUsuarioByFkusuarioenvia}"  styleClass="ikont-rc-tcfkusuarioenviarecibido" 
                                                     >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-houtremitente"   value="#{var.houtremitente}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-stfkusuarioenvia"   id="st_fkusuarioenvia" value="#{currentRow.jsfUsuarioByIntusuenvia.tercero.strnombre}"/>
                                        </rich:column>
                                        <rich:column id="tc-datefecmensajerecibido" sortBy="#{currentRow.datefecmensaje}" styleClass="ikont-rc-tcdatefecmensajerecibido" 
                                                    >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-datefecmensajerecibidofecha"   value="#{var.Fecha}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-otxtdatefecmensajerecibidofecha"   id="otxt-fkdatefecmensajerecibido" value="#{currentRow.datefecmensaje}">
                                                <f:convertDateTime pattern="dd-MMM-yyyy hh:mm"/>
                                            </h:outputText>
                                        </rich:column>
                                        <rich:column    id="tc-verrecibidos"  styleClass="ikont-rc-tcverrecibidos" >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-tcverrecibidosver"   value="#{var.Ver}"/>
                                            </f:facet>
                                            <a4j:commandButton action="#{Supervisor$Mensajes.bt_verrecibidos_action}" id="bt-ver-recibidos" oncomplete="#{rich:component('mp_ver')}.show(); return true;" title="#{var.Ver}"  immediate="true" render="pg_camposVer"
                                                               styleClass="ikont-acb-btverrecibidos"    />
                                        </rich:column>
                                        <f:facet name="footer">
                                            <rich:dataScroller renderIfSinglePage="false"></rich:dataScroller>
                                        </f:facet>
                                    </rich:dataTable>
                                </h:panelGroup>
                            </center>
                        </h:panelGroup>
                    </rich:tab>
                    <rich:tab header="#{var.rtab_enviados}" >
                        <h:panelGroup >
                            <center>
                                <h:panelGroup id="panel_filtro_enviados">
                                    <h:outputText  styleClass="ikont-hot-panelfiltroenviados" value="#{var.houtbusquedarapida} "/>
                                    <h:inputText value="#{Supervisor$Mensajes.valorFiltroMensajeEnviado}" id="filtroEnviados" size="52">
                                        <a4j:ajax event="keyup" render="tablaMensajesEnviados" />
                                    </h:inputText>
                                </h:panelGroup>
                                <interkont:spacer height="10px" />
                                <h:panelGroup id="pl_tabla_enviados">
                                    <rich:dataTable id="tablaMensajesEnviados" sortMode="single"  value="#{Supervisor$Mensajes.listaMensajesEnviados}" var="currentRow" rowKeyVar="filaSeleccionada" rows="10">
                                        <rich:column filterExpression="#{Supervisor$Mensajes.filtrarMensajesEnviados}" sortBy="#{currentRow.datefecmensaje}" styleClass="ikont-rc-tablamensajesenviadosdatefecmensaje"
                                                    >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-tablamensajesenviadoshoutasunto"   value="#{var.houtasunto}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-tablamensajesenviadosstrasuntomensaje"   value="#{currentRow.strasuntomensaje}"/>
                                        </rich:column>
                                        <rich:column sortBy="#{currentRow.jsfUsuarioByIntusurecibe.tercero.strnombre}" styleClass="ikont-rc-tablamensajesenviadosstrnombre"
                                                    >
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-tablamensajesenviadoshoutremitente"   value="#{var.houtremitente}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-tablamensajesenviadosdatos"   value="#{currentRow.jsfUsuarioByIntusurecibe.tercero.strnombre} #{currentRow.jsfUsuarioByIntusurecibe.tercero.strapellido1}"/>
                                        </rich:column>
                                        <rich:column sortBy="#{currentRow.datefecmensaje}" styleClass="ikont-rc-tablamensajesenviadosdatefecmensaje">
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-datefecmensajefecha"   value="#{var.Fecha}"/>
                                            </f:facet>
                                            <h:outputText  styleClass="ikont-hot-datefecmensaje"   value="#{currentRow.datefecmensaje}">
                                                <f:convertDateTime pattern="dd-MMM-yy hh:mm:ss"/>
                                            </h:outputText>
                                        </rich:column>
                                        <rich:column   styleClass="ikont-rc-tablamensajesenviados">
                                            <f:facet name="header">
                                                <h:outputText  styleClass="ikont-hot-tablamensajesenviadosver"   value="#{var.Ver}"/>
                                            </f:facet>
                                            <a4j:commandButton action="#{Supervisor$Mensajes.bt_verenviados_action}" id="bt-ver-enviados" oncomplete="#{rich:component('mp_ver_enviados')}.show(); return true;" title="#{var.Ver}"  immediate="true" render="pg_camposVerEnviados"
                                                               styleClass="ikont-acb-btverenviados"    />
                                        </rich:column>
                                        <f:facet name="footer">
                                            <rich:dataScroller renderIfSinglePage="false"></rich:dataScroller>
                                        </f:facet>
                                    </rich:dataTable>
                                </h:panelGroup>
                            </center>
                        </h:panelGroup>
                    </rich:tab>
                </rich:tabPanel>
            </h:panelGrid>
        </h:form>
        <ui:include src="/modal/verRecibidosModal.xhtml" />
        <ui:include src="/modal/verEnviadosModal.xhtml" />
        <ui:include src="/modal/responderMensajeModal.xhtml" />
        <ui:include src="/modal/nuevoMensajeModal.xhtml" />
    </ui:define>

</ui:composition>