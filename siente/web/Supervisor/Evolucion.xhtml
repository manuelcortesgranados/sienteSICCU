<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" 
                xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets" 
                template="/facelets/template_main.xhtml"
                >


    <ui:define name="head">
        <script src="/#{var.versioncobra}/resources/amcharts/amcharts.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/amcharts/serial.js" type="text/javascript"></script>        
    </ui:define>
    <ui:define name="title">
        <h:outputText rendered="#{!var.permisonuevodiseno}" styleClass="ikont-hot-evoluciónproyecto"   value="#{var.evoluciónproyecto}"/>
        <h:outputText rendered="#{!var.permisonuevodiseno}" styleClass="ikont-hot-strnombremedio"    value="#{Supervisor$AdministrarObraNew.obra.strnombremedio}"/>
    </ui:define>  
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>
            <ui:include src="/facelets/menu_lateral_administrar.xhtml"/>
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml"/>
        </h:panelGroup>

    </ui:define>
    <ui:define  rendered="#{var.permisonuevodiseno}" name="menusuperior">
        <ui:include  src="/facelets/menu_superior_administrar_proyecto.xhtml"/>
    </ui:define>
    <ui:define name="body" >
        <h:form prependId="false" >
            <interkont:spacer height="35" />
            <rich:collapsiblePanel id="simpleToggleEvolucionFisi" header="#{var.evolucion}">
                <center>
                    <f:param name="paginaOrigen" value="1"/>
                    <h:outputText  styleClass="ikont-hot-scriptGrafico"   value="#{Supervisor$GraficoEvolucionProyectoSupervisor.grafico.scriptGrafico}" escape="false"/>
                    <div id="graficoEvolucionProyecto" style="width:100%;height: 350px;text-align: left;"> </div>
                </center>
            </rich:collapsiblePanel>
        </h:form>

        <h:form>     
            <rich:collapsiblePanel id="simpleToggleSelechv" header="#{var.houthojavida}" >
                <h:outputLabel  styleClass="ikont-hol-periododecorte"   id="lbperi"  value="#{var.periododecorte} "  />
                <h:selectOneMenu id="cmbencargo" value="#{Supervisor$DetalleObra.periodoevo.intidperiodo}" >
                    <f:selectItem itemValue="-1" itemLabel="Seleccione"/>
                    <f:selectItems value="#{Supervisor$DetalleObra.periodoaliment}"/>
                    <a4j:ajax event="change" execute="@this"  listener="#{Supervisor$DetalleObra.obtenerAlimentacionMostrar}" render="layoutGral, simpleToggleSelechv,imgspanel" >
                    </a4j:ajax>
                </h:selectOneMenu>

                <h:outputText  styleClass="ikont-hot-intidalimenta"    value="(#{Supervisor$DetalleObra.alimentacionmostrar.intidalimenta})" 
                               rendered="#{Supervisor$DetalleObra.veralimenta}"/>
                <center>
                    <interkont:spacer  height="20"/>
                    <rich:dataTable id="tablaavancesporperiodo"  rows="4"   var="avance"
                                    rowKeyVar="filaSeleccionada" value="#{Supervisor$DetalleObra.listaAlimenta}"
                                    rendered="#{Supervisor$DetalleObra.periodoevo.intidperiodo != -1}" binding="#{Supervisor$DetalleObra.tablalistaavances}"
                                    >
                        <rich:column id="avnfecalim" width="100px">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-houtfechaalimentacion"   value="#{var.houtfechaalimentacion}" />
                            </f:facet>
                            <h:outputText  styleClass="ikont-hot-datefechaalimen"   id="otfecalim" value="#{avance.datefechaalimen}" >
                                <f:convertDateTime pattern="#{var.formatofecha}"/>
                            </h:outputText>
                        </rich:column>

                        <rich:column id="avntotalejec" width="100px" >
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-totalejecutado"   value="#{var.valorejecutadoperiodo}" />
                            </f:facet>
                            <h:outputText  styleClass="ikont-hot-ottotejec"   id="ottotejec" value="#{avance.numtotalejec}">
                                <f:convertNumber pattern="#{var.formatomoneda}"/>

                            </h:outputText>
                        </rich:column>

                        <rich:column id="avntotalproyacu" width="100px" >
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-valorejecutadoacumulado"   value="#{var.valorejecutadoacumulado}" />
                            </f:facet>
                            <h:outputText  styleClass="ikont-hot-ottotproyacu"   id="ottotproyacu" value="#{avance.numtotalejecacu}">
                                <f:convertNumber pattern="#{var.formatomoneda}"/>

                            </h:outputText>
                        </rich:column>
                        <rich:column id="avnver" width="100px" >
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-veravance"   value="#{var.veravance}" />
                            </f:facet>
                            <a4j:commandButton value="#{var.veravance}" action="#{Supervisor$DetalleObra.encontraralimentacion}" render="imgspanel,layoutGral,simpleToggleSelechv"/>

                        </rich:column>
                        <rich:dataScroller for="tablaavancesporperiodo" render="tablaavancesporperiodo"/>
                    </rich:dataTable>
                    <interkont:spacer  height="20"/>
                </center>


                <rich:collapsiblePanel  rendered="#{Supervisor$DetalleObra.veralimenta}"  header="#{var.periododecorte}">
                    <center>
                        <h:panelGrid id="layoutGral"  width="40%" styleClass="ikont-hpg-layoutGral"  >
                            <h:panelGrid styleClass="ikont-hpg-avancesemaforo"   
                                         columns="4" columnClasses="column-grid-panel,column-grid-panel,column-grid-panel,column-grid-panel"
                                         rendered="#{Supervisor$DetalleObra.periodoevo.intidperiodo != -1}">
                                <rich:panel header="#{var.imagen}" bodyClass="rich-panel-grid-body" styleClass="ikont-rp-imagen"    headerClass="font-header-panel">
                                    <h:panelGroup>
                                        <h:graphicImage  styleClass="ikont-hgi-imagenevolucioobraubicacion"   value="#{Supervisor$DetalleObra.alimentacionmostrar.imagenevolucionobra.strubicacion}"                                         
                                                         height="120" width="160"
                                                         rendered="#{Supervisor$DetalleObra.alimentacionmostrar.imagenevolucionobra.strubicacion != null}"/>
                                        <h:graphicImage  styleClass="ikont-hgi-noimagen"   value="#{var.noimagen}" height="120" width="160"
                                                         rendered="#{Supervisor$DetalleObra.alimentacionmostrar.imagenevolucionobra.strubicacion == null}"/>
                                    </h:panelGroup>
                                </rich:panel>
                                <rich:panel style="width: 222px;" header="#{var.avancefisico}" bodyClass="rich-panel-grid-body" styleClass="ikont-rp-avancefisico"   headerClass="font-header-panel">


                                    <h:panelGrid columns="2" columnClasses="panelderecha, panelizquierda" >
                                        <h:outputText  styleClass="ikont-hot-houtobraestaen"   value="#{var.houtobraestaen}" />
                                        <h:outputText  styleClass="ikont-hot-numvaltotobra"   value="#{Supervisor$DetalleObra.alimentacionmostrar.numtotalejecacu/Supervisor$AdministrarObraNew.obra.numvaltotobra}">
                                            <f:convertNumber pattern="###.## %"/>
                                        </h:outputText>
                                        <h:outputText  styleClass="ikont-hot-deberiaestaren"   value="#{var.deberiaestaren}" />
                                        <h:outputText  styleClass="ikont-hot-numvaltotobra"   value="#{Supervisor$DetalleObra.alimentacionmostrar.numtotalproyacu/Supervisor$AdministrarObraNew.obra.numvaltotobra}">
                                            <f:convertNumber pattern="###.## %"/>
                                        </h:outputText>
                                    </h:panelGrid>

                                </rich:panel>
                                <rich:panel  style="width: 152px;" header="#{var.valoravancefisico}" bodyClass="rich-panel-grid-body" styleClass="ikont-rp-valoravancefisico"   headerClass="font-header-panel">
                                    <interkont:spacer height="35"/>
                                    <h:panelGroup>
                                        <h:panelGrid columns="1" columnClasses="tabla-center">
                                            <h:outputText  styleClass="ikont-hot-numtotalejec"   id="stcantidadejecutada" value="#{Supervisor$DetalleObra.alimentacionmostrar.numtotalejec}">
                                                <f:convertNumber pattern="#{var.formatomoneda}"/>
                                            </h:outputText>
                                            <h:outputText  styleClass="ikont-hot-valorejecutado"   value="#{var.valorejecutadoperiodo}" />
                                        </h:panelGrid>
                                    </h:panelGroup>
                                </rich:panel>
                                <rich:panel header="#{var.houtsemaforo}" bodyClass="rich-panel-grid-body" styleClass="ikont-rp-houtsemaforo"   headerClass="font-header-panel">
                                    <h:panelGroup>
                                        <center>
                                            <h:graphicImage  styleClass="ikont-hgi-imgSemaObra"   id="imgSemaObra"
                                                             value="#{Supervisor$DetalleObra.alimentacionmostrar.semaforo.strimagen}"
                                                             rendered="#{Supervisor$DetalleObra.alimentacionmostrar.semaforo.strimagen != null}"/>
                                            <h:graphicImage  styleClass="ikont-hgi-noinfo"   value="#{var.noinfo}" height="100px"
                                                             rendered="#{Supervisor$DetalleObra.alimentacionmostrar.semaforo.strimagen == null}"/>
                                            <h:outputText  styleClass="ikont-hot-semaforo"   value="#{Supervisor$DetalleObra.semaforo}"
                                                           rendered="#{Supervisor$DetalleObra.alimentacionmostrar.semaforo.strimagen != null}"
                                                           />
                                        </center>
                                    </h:panelGroup>
                                </rich:panel>
                            </h:panelGrid>
                        </h:panelGrid>
                    </center>
                    <interkont:spacer height="30"/>
                    <center>
                        <h:panelGrid id="imgspanel" width="10%" styleClass="ikont-hpg-imgspanel"  >
                            <h:panelGrid width="443" columns="1" rendered="#{Supervisor$DetalleObra.periodoevo.intidperiodo != -1}" styleClass="ikont-hpg-alimentacionmostrar"  
                                         columnClasses="column-grid-panel">
                                <rich:panel header="#{var.observaciongeneral}" bodyClass="rich-panel-grid-body-obser" styleClass="ikont-rp-observaciongeneral"   headerClass="font-header-panel">

                                    <h:inputTextarea style="width: 98%!important" value="#{Supervisor$DetalleObra.alimentacionmostrar.textcomentario}" 
                                                     rows="5" disabled="true"/>

                                </rich:panel>
                            </h:panelGrid>
                        </h:panelGrid>
                    </center>

                    <interkont:spacer height="30" />
                    <center>
                        <h:panelGrid columns="8" styleClass="ikont-hpg-logrosdificultad"  >
                            <a4j:commandLink id="btlogros" styleClass="ikont-a4jcl-btlogros"  
                                             action="#{Supervisor$DetalleObra.mostrarAlimentacionCualitativa}"
                                             oncomplete="#{rich:component('modalLogros')}.show();"

                                             render="tablaLogrosProyecto"/>
                            <a4j:commandLink id="btlogrosx" styleClass="ikont-a4jcl-btlogrosx"  
                                             action="#{Supervisor$DetalleObra.mostrarAlimentacionCualitativa}"

                                             oncomplete="#{rich:component('modalDificultad')}.show();" render="modalDificultad"/>
                            <a4j:commandLink id="btlogrosxx" styleClass="ikont-a4jcl-btlogrosxx"  
                                             action="#{Supervisor$DetalleObra.llenarFactoratraso}"

                                             oncomplete="#{rich:component('modalFactoresAtraso')}.show();" render="tablaFactores"/>

                            <a4j:commandLink id="btlogrosxxx" styleClass="ikont-a4jcl-btlogrosxxx"  
                                             action="#{Supervisor$DetalleObra.llenaractividadesAlimentacion}"

                                             oncomplete="#{rich:component('modalactividades')}.show();" render="listaractividades" />
                            <a4j:commandLink id="btlogros1" styleClass="ikont-a4jcl-btlogros1"  

                                                 oncomplete="#{rich:component('modalImpacto')}.show();" render="tablaaliperim" />
                            <a4j:commandLink id="btlogrosx2" styleClass="ikont-a4jcl-btlogrosx2"  
                                                 action="#{Supervisor$DetalleObra.LlenarDocumentos}"

                                                 oncomplete="#{rich:component('modalDocumento')}.show();" render="tablaDocsAlim"/>
                            <a4j:commandLink id="btlogrosx3" styleClass="ikont-a4jcl-btlogrosx3"   rendered="#{Supervisor$AdministrarObraNew.obra.enalimentacion and SessionBeanCobra.usuarioObra.renderrecurso.btnvalidaravance and 
                                                                                                                   supervisor$DetalleObra.periodoultimo == Supervisor$DetalleObra.alimentacionmostrar.datefecha}"
                                                 action="#{Supervisor$DetalleObra.llenarmodalvalidacion}"

                                                 oncomplete="#{rich:component('modalValidarAlimentacion')}.show();" render="frmValidarAlimentacion"/>
                            <a4j:commandLink id="pruebamodal" styleClass="ikont-a4jcl-solicitumaestro" value="prueba" rendered="#{Supervisor$AdministrarObraNew.obra.solicitudmaestro!=null}"
                                                 action="#{Supervisor$DetalleObra.llenarBeneficiariosxavance}">
                                    <a4j:ajax event="complete" onbeforesubmit="#{rich:component('beneficiarioxperiodo')}.show();" render="rpListaBeneficiarios"/>
                                </a4j:commandLink>
                        </h:panelGrid>
                        <h:panelGrid columns="1" id="panelVali" styleClass="ikont-hpg-panelVali"    >
                            <h:outputText  styleClass="ikont-hot-validacionultimaalimentacion"   value="La última alimentación no ha sido validada aún por el funcionario de Colombia Humanitaria"
                                           rendered="#{Supervisor$AdministrarObraNew.obra.enalimentacion}"/>
                        </h:panelGrid>
                    </center>

                </rich:collapsiblePanel>
            </rich:collapsiblePanel>
            <br/>
        </h:form>

        <ui:include src="/modal/logrosModal.xhtml"/>
        <ui:include src="/modal/dificultadModal.xhtml"/>
        <ui:include src="/modal/factoresAtrasoModal.xhtml"/>
        <ui:include src="/modal/actividadesModal.xhtml"/>
        <ui:include src="/modal/impactoModalEvo.xhtml"/>
        <ui:include src="/modal/documentoModal.xhtml"/>
        <ui:include src="/modal/modalVideoEvo.xhtml"/>
        <ui:include src="/modal/modalValidarAlimentacion.xhtml"/>
        <ui:include src="/modal/modalFormularioValidarAlimentacion.xhtml"/>
        <ui:include src="/modal/atencionHumanitaria/beneficiarioxperiodo.xhtml"/>


    </ui:define>
</ui:composition>

