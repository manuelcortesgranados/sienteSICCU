<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" 
                xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"   
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/facelets/template_main.xhtml">
    <ui:define name="head">
        <link href="/#{var.versioncobra}/resources/css/reloj.css" rel="stylesheet" type="text/css" />
        <link href="/#{var.versioncobra}/resources/css/style.css" rel="stylesheet" type="text/css" />
        <link href="/#{var.versioncobra}/resources/css/sliderman.css" rel="stylesheet" type="text/css" />
        <link href="/#{var.versioncobra}/resources/reloj/css/flipclock.css" rel="stylesheet" type="text/css" />
        <script src="/#{var.versioncobra}/resources/amcharts/amcharts.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/amcharts/serial.js" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="/#{var.versioncobra}/resources/css/estilos.css" media="all" />
        <link href="/#{var.versioncobra}/resources/css/style.css" rel="stylesheet" type="text/css" />
        <link href="/#{var.versioncobra}/resources/css/valla.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript">
            localStorage.setItem('accionAdminConvenio', "ikont-img-posicion-administrar-convenio ikont-posicion-nuevo-detalle-admconvenio");</script>
    </ui:define>
    <ui:define name="title">
        <h:panelGroup id="layoutTitle">
            <h:outputText rendered="#{!var.permisonuevodiseno}" styleClass="ikont-"   value="#{var.resumencontrato} #{Supervisor$Contrato.tipoContCon}" />
            <h:outputText rendered="#{!var.permisonuevodiseno}" styleClass="ikont- ikont-hot-intcodobra"    value="(#{Supervisor$Contrato.contrato.intidcontrato})" />
        </h:panelGroup>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml" />
    </ui:define>
    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_gestion.xhtml" />
            <ui:include src="/facelets/menu_lateral_contrato.xhtml" />
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml"/>
        </h:panelGroup>
    </ui:define>
    <ui:define  rendered="#{var.permisonuevodiseno and Supervisor$Contrato.tipoContCon == 'Convenio'}" name="menusuperior">
        <ui:include src="/facelets/menu_superior_administrar_convenio.xhtml"/>
    </ui:define>
    <ui:define name="body">
        <h:form prependId="false">
            <h:inputHidden id="finfecha" value="#{Supervisor$Contrato.finentrega}" />
        </h:form>
        <h:panelGroup layout="block" id="pgcontratoconvenio" >

            <h:form id="ccForm">
                <h:commandLink value="#{var.volver}" action="#{Supervisor$AdministrarObraNew.detalleContrato}"  disabled="#{!Supervisor$Contrato.boolBack}" >
                    <a4j:param assignTo="#{Supervisor$AdministrarObraNew.mostrarContratoConvenio}" value="#{Supervisor$Contrato.contrato.contrato.intidcontrato}" />
                    <a4j:param assignTo="#{Supervisor$Contrato.isFromContracts}" value="true" />
                </h:commandLink>
                <rich:collapsiblePanel switchType="client" header="#{var.infoGeneral}" style="width: 87%;" expanded="true">
                    <h:panelGrid columns="2" style="width: 100%;">
                        <h:panelGrid style="width: 400px; border-spacing: 4px">
                            <h:panelGroup >

                                <h:outputLabel class="ikont-hol-detalle-proyecto"  >#{var.contratanteCliente}</h:outputLabel>
                                <interkont:spacer width="20" />
                                <B>
                                    <h:outputLabel id="entiodadcontratantevalue" styleClass="ikont-" value="#{Supervisor$Contrato.contrato.tercero.strnombrecompleto}">
                                    </h:outputLabel>
                                </B>
                            </h:panelGroup>
                            <hr class="ikont-hr" />
                            <h:panelGroup>
                                <h:outputLabel rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}" class="ikont-"  >#{var.nroConvenio}</h:outputLabel>
                                <h:outputLabel rendered="#{!Supervisor$Contrato.contrato.booltipocontratoconvenio}" class="ikont-"  >#{var.noContrato}</h:outputLabel>
                                <interkont:spacer width="20" />
                                <B>
                                    <h:outputText  styleClass="ikont-"   id="txtNumero"   value="#{Supervisor$Contrato.contrato.strnumcontrato}" /> 
                                </B>
                            </h:panelGroup>
                            <hr class="ikont-hr" />
                            <h:panelGroup>
                                <h:outputLabel class="ikont-hol-detalle-proyecto">#{var.vigenciaConvenio}</h:outputLabel>
                                <interkont:spacer width="20" />
                                <h:outputLabel class="ikont-" style="font-weight: bold;">#{Supervisor$Contrato.contrato.datefechaini} #{Supervisor$Contrato.contrato.datefechafin} </h:outputLabel>
                                <hr class="ikont-hr" />
                            </h:panelGroup>
                            <h:outputLabel class="ikont-hol-detalle-proyecto">#{var.objetoMay}</h:outputLabel>
                            <interkont:spacer width="20" />
                            <div id = "objetoId">
                                <h:outputLabel id ="objetoId" class="ikont-" style="font-weight: bold;" >#{Supervisor$Contrato.objetoSub}
                                    <rich:tooltip followMouse="true" direction="bottomRight" styleClass="ikont-rtt-btndetalleproyecto" >
                                        <h:outputText styleClass="ikont-hol-strnombreobra" value="#{Supervisor$Contrato.contrato.textobjeto}"></h:outputText> <br/>
                                    </rich:tooltip>
                                </h:outputLabel>
                            </div>
                            <br/><br/>
                            <h:panelGroup rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                <B>
                                    <h:outputLabel class="ikont-hol-detalle-proyecto" style="color: grey"  >Plan nacional de desarrollo</h:outputLabel>    
                                </B>
                                <hr class="ikont-hr-separador-inicial" />
                            </h:panelGroup>
                            
                                                        <h:panelGroup rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                <h:outputLabel class="ikont-hol-detalle-proyecto">Sector Económico:</h:outputLabel>
                                <interkont:spacer width="20" />
                                <h:outputLabel class="ikont-" style="font-weight: bold;" value="
                                        #{ Supervisor$Contrato.contrato.tipificacionConvenio eq null ?
                                        'no asignado':
                                        Supervisor$Contrato.contrato.tipificacionConvenio.tipificacionConvenioSector.nombre}" >
                                </h:outputLabel>
                                <hr class="ikont-hr" />
                            </h:panelGroup>

                            <h:panelGroup rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                <h:outputLabel class="ikont-hol-detalle-proyecto">Objetivos PND:</h:outputLabel>
                                <interkont:spacer width="20" />
                                <h:outputLabel class="ikont-" style="font-weight: bold;" value=" 
                                        #{ Supervisor$Contrato.contrato.tipificacionConvenio eq null ?
                                        'no asignado':
                                        Supervisor$Contrato.contrato.tipificacionConvenio.tipificacionConvenioObjetivo.nombre}" >
                                </h:outputLabel>
                                <hr class="ikont-hr" />
                            </h:panelGroup>
                           <h:panelGroup rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                <h:outputLabel class="ikont-hol-detalle-proyecto" >Estrategia:</h:outputLabel>
                                <interkont:spacer width="20" />
                                <h:outputLabel class="ikont-" style="font-weight: bold;" value=" 
                                        #{ Supervisor$Contrato.contrato.tipificacionConvenio eq null ?
                                        'no asignado':
                                        Supervisor$Contrato.contrato.tipificacionConvenio.tipificacionConvenioEstrategia.nombre}" >
                                </h:outputLabel>
                                <hr class="ikont-hr" />
                            </h:panelGroup>

                        </h:panelGrid>
                        <h:panelGrid style="width: 100%;">
                            <center>
                                <h:panelGrid style="width:100%;" columns="1">
                                    <h:panelGroup style="alignment-adjust: central">
                                        <center>
                                            <h:outputText styleClass="ikont-" value="#{var.tiempoentrega}" />
                                            <br/><br/>
                                            <div class="your-clock"></div>
                                        </center>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </center>
                        </h:panelGrid>
                    </h:panelGrid>
                </rich:collapsiblePanel>
                <rich:collapsiblePanel switchType="client" header="#{var.informeFisico}" style="width: 87%;" expanded="true">
                    <h:panelGrid columns="2">
                        <h:panelGrid  columns="1">
                            <h:outputText styleClass="ikont-hol-detalle-proyecto" value="#{var.estado}"/>
                            <br/><br/>
                            <h:outputText styleClass="ikont-hcl-#{Supervisor$GraficoAvanceFisicoConvenio.semaforo} ikont-hot-semaforo dtsemafomoro" >
                                <f:convertNumber pattern="###.## %" />
                            </h:outputText>
                            <br/><br/><br/>
                            <div id="grafAvaFiConvenio" style="width: 350px; height: 100px; margin-top: -50px; margin-left: -15px; font-weight: 600; font-size: 20px">
                            </div>
                            <h:outputText  styleClass="ikont-hot-scriptGraf"   value="#{Supervisor$GraficoAvanceFisicoConvenio.grafico.scriptGrafico}" escape="false" >
                            </h:outputText>
                        </h:panelGrid>
                        <h:panelGrid id="pg_ubicacion_evolucion"  columns="1" >
                            <h:outputLabel>#{var.evolucionFisica}</h:outputLabel>
                            <h:panelGroup layout="block" styleClass="panelcenter">
                                <h:outputText  styleClass="ikont-hot-scriptGrafico1"   value="#{Supervisor$GraficoEvolucionFisicoConvenio.grafico.scriptGrafico}" escape="false"/>
                                <!-- al div que va a contener el grafico debe tener los valores de width y heigth en su atriburo style -->
                                <div id="grafEvoFisConvenio" style="width: 550px; height: 300px; text-align: left;">
                                </div>
                            </h:panelGroup>
                        </h:panelGrid>
                    </h:panelGrid>
                </rich:collapsiblePanel>
                <rich:collapsiblePanel switchType="client" header="#{var.informeFinanciero}" style="width: 87%;" expanded="true">
                    <h:panelGrid  style="width: 100%;" columns="2">
                        <h:panelGroup>
                            <fieldset class="fieldset-interkont2" style="width: 50%;">
                                <h:panelGrid  columns="1">
                                    <center>
                                        <h:outputLabel rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}" class="ikont-hol-detalle-proyecto"  >#{var.valorConvenio}</h:outputLabel>
                                        <h:outputLabel rendered="#{!Supervisor$Contrato.contrato.booltipocontratoconvenio}" class="ikont-hol-detalle-proyecto"  >#{var.valorGContrato}</h:outputLabel>
                                    </center>
                                    <h:outputText  styleClass="ikont-hot-zoom-numvobra"   id="vlrcc" value="#{Supervisor$Contrato.contrato.numvlrcontrato}">
                                        <f:convertNumber pattern="#{var.formatomoneda}" />
                                    </h:outputText>    
                                </h:panelGrid>
                            </fieldset>
                            <fieldset class="fieldset-interkont2" style="width: 50%;">
                                <h:panelGrid  columns="1">
                                    <h:outputLabel class="ikont-label-title2"  >#{var.fuenterecurso}</h:outputLabel>
                                    <interkont:spacer width="20" />
                                    <h:panelGroup>
                                        <h:outputText  styleClass="ikont-"   id="lblnumrecursospropios" value="#{var.numrecursospropios} (Entidad Contratante):" />
                                        <h:panelGroup rendered="#{!SessionBeanCobra.usuarioObra.renderrecurso.btn_editarRecursosPropios or Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                            <h:outputLabel  id="numrecursospropios" value="#{Supervisor$Contrato.contrato.numrecursospropios}" styleClass="ikont-"   rendered="true">
                                                <f:convertNumber pattern="#{var.formatomoneda}" />
                                            </h:outputLabel>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                    <hr style="border-color: #CECECE; border-width: 1px;" />
                                    <h:panelGroup>
                                        <h:outputText  styleClass="ikont-"   id="lblnumrecursosch"  value="#{var.numrecursosch}:" />
                                        <interkont:spacer width="20" />
                                        <h:panelGroup rendered="#{!SessionBeanCobra.usuarioObra.renderrecurso.btn_editarRecursosCH  or  Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                            <h:outputLabel     id="spinumrecursosch" value="#{Supervisor$Contrato.contrato.numrecursosch}" styleClass="ikont-"   rendered="true">
                                                <f:convertNumber pattern="#{var.formatomoneda}" />
                                            </h:outputLabel>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                    <hr style="border-color: #CECECE; border-width: 1px;" />
                                    <h:panelGroup>
                                        <h:outputText  styleClass="ikont-"   id="lblnumrecursoster" value="#{var.numrecursoster}:" />
                                        <interkont:spacer width="20" />
                                        <h:panelGroup rendered="#{!SessionBeanCobra.usuarioObra.renderrecurso.btn_editarRecursosTerceros or Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                                            <h:outputLabel    id="spinumrecursoster" value="#{Supervisor$Contrato.contrato.numrecursostercero}" styleClass="ikont-"   rendered="true">
                                                <f:convertNumber pattern="#{var.formatomoneda}" />
                                            </h:outputLabel>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </fieldset>
                            <fieldset class="fieldset-interkont2" style="width: 50%;">
                                <h:panelGrid  columns="1">
                                    <h:panelGroup >
                                        <h:outputLabel class="ikont-label-title2"  >#{var.desembolsosRealizados}</h:outputLabel>
                                        <interkont:spacer width="20" />
                                        <h:outputLabel value="$0,00" styleClass="ikont-"   rendered="true"/>
                                    </h:panelGroup>
                                    <hr style="border-color: #CECECE; border-width: 1px;" />
                                    <h:panelGroup >
                                        <h:outputLabel  styleClass="ikont-"   id="dispo" value="#{var.vlrdispo}:" />
                                        <interkont:spacer width="20" />
                                        <h:outputLabel    id="strdispocontrato" styleClass="ikont-"   value="#{Supervisor$Contrato.contrato.numvlrcontrato-(Supervisor$Contrato.contrato.numvlrsumahijos+Supervisor$Contrato.contrato.numvlrsumaproyectos)}">
                                            <f:convertNumber pattern="#{var.formatomoneda}" />
                                        </h:outputLabel>  
                                    </h:panelGroup>
                                </h:panelGrid>
                            </fieldset>
                        </h:panelGroup>
                        <h:panelGroup style="width:60%;">

                            <h:outputLabel>#{var.evolucionFinanciera}</h:outputLabel>
                            <!--                            <h:panelGroup layout="block" styleClass="panelcenter">
                                                            <h:outputText  styleClass="ikont-hot-scriptGrafico1"   value="#{Supervisor$GraficoEvolucionContrato.graficoEvolucionContrato.scriptGrafico}" escape="false"/>
                                                             al div que va a contener el grafico debe tener los valores de width y heigth en su atriburo style 
                                                            <div id="graficoEvolucionContrato" style="width: 550px; height: 200px; text-align: left;">
                                                            </div>
                                                        </h:panelGroup>-->
                            <h:panelGroup layout="block" styleClass="panelcenter">
                                <div id="imagenId" style="width: 550px; height: 400px; text-align: left;">
                                    <h:graphicImage value="/resources/imgs/TABLASINDATOS.png"></h:graphicImage>
                                </div>
                            </h:panelGroup>

                        </h:panelGroup>
                    </h:panelGrid>

                </rich:collapsiblePanel>
                <h:panelGroup rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}" style="width: 87%">
                    <ui:include src="contratosConvenio.xhtml" />
                </h:panelGroup>
                <h:panelGroup rendered="#{!Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                    <ui:include src="proyectosContrato.xhtml" />
                </h:panelGroup>                        
                <rich:collapsiblePanel switchType="client" header="Datos relevantes" expanded="true">
                    <h:panelGrid columns="2" class="ikont-hpg-datosrelevantes" columnClasses="verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop">
                        <h:panelGrid styleClass="ikont-hpg-griddetaob">
                            <h:outputText styleClass="ikont-hcl-imgduracion img-detalle-proyecto" />
                            <h:outputLabel>Duración</h:outputLabel>
                        </h:panelGrid>

                        <h:panelGrid  styleClass="ikont-hgi-imgestobra">
                            <h:outputText styleClass="ikont-hcl-imgestadoproyecto img-detalle-proyecto estado#{Supervisor$Contrato.contrato.estadoconvenio.idestadoconvenio}" />
                            <h:outputLabel>Estado</h:outputLabel>
                        </h:panelGrid>
                        <h:panelGrid styleClass="ikont-hpg-griddetaob">
                            <interkont:spacer height="15" />
                            <h:outputText styleClass="ikont-hot-intplazoo" value="#{Supervisor$Contrato.contrato.intduraciondias} #{var.dias}"></h:outputText>
                            <h:panelGrid columns="2" styleClass="panelcenter">
                                <h:outputLabel styleClass="ikont-hot-desde" value="Desde:"></h:outputLabel>
                                <h:outputLabel styleClass="ikont-hot-fecinob" value="#{Supervisor$Contrato.contrato.datefechaini}">
                                    <f:convertDateTime pattern="#{var.formatofecha}" />
                                </h:outputLabel>
                                <h:outputLabel styleClass="ikont-hot-hasta" value="Hasta:" ></h:outputLabel>
                                <h:outputLabel styleClass="ikont-hot-fecfiob" value="#{Supervisor$Contrato.contrato.datefechafin}">
                                    <f:convertDateTime pattern="#{var.formatofecha}" />
                                </h:outputLabel>
                            </h:panelGrid>

                        </h:panelGrid>    
                        <h:panelGrid  styleClass="ikont-hgi-imgestobra">
                            <h:outputText styleClass="ikont-hot-estobra " value="#{Supervisor$Contrato.contrato.estadoconvenio.strestadoconv}" ></h:outputText>
                        </h:panelGrid>
                    </h:panelGrid>
                </rich:collapsiblePanel>

                <rich:collapsiblePanel id="simpleTogglePolizas" switchType="ajax"
                                       header="#{var.polizas}" expanded="#{Supervisor$Contrato.boolpolizas}"
                                       toggleListener="#{Supervisor$Contrato.llenarPolizas}">
                    <a4j:ajax event="switch" render="polizasContrato, notienepoliza"  />
                    <center>
                        <h:panelGroup id="notienepoliza" styleClass="font-general">
                            <h:outputLabel  styleClass="ikont-"   rendered="#{Supervisor$Contrato.listaPolizacontratos.size()==0}" value="#{var.notienepolizas}"/>
                        </h:panelGroup>
                        <h:panelGroup id="polizasContrato">
                            <rich:dataTable id="tablaPolizasContrato" sortMode="single" 
                                            binding="#{Supervisor$Contrato.tablaPolizasbin}"   
                                            var="localRow"
                                            value="#{Supervisor$Contrato.listaPolizacontratos}" rendered="#{Supervisor$Contrato.listaPolizacontratos.size()>0}">
                                <rich:column id="tc-strTipoPolizaContr" width="100px">
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.tipoPolizaContrato}" />
                                    </f:facet>
                                    <h:outputText   id="otxt-strDescTipoPoliza" styleClass="ikont-"   value="#{localRow.tipopoliza.strdesctipopoliza}" />
                                </rich:column>
                                <rich:column id="tc-strnumPolizaContrato1" width="100px">
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.numPolizaContrato}"/>
                                    </f:facet>
                                    <h:outputText  styleClass="ikont-"   id="otxt-strnumPolizaContrato1" value="#{localRow.strnumpoliza}" />
                                </rich:column>
                                <rich:column id="tc-strVencimientoPolizaContr" width="100px">
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.fecha} #{var.vencimientoPoliza}"  />
                                    </f:facet>
                                    <h:outputText  styleClass="ikont-"   id="otxt-strVencimientoPoliza1" value="#{localRow.datefechavecimiento}" />
                                </rich:column>
                                <rich:column id="tc-strEntidadContr" width="100px">
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.entidadPoliza}" />
                                    </f:facet>
                                    <h:outputText  styleClass="ikont-"   id="otxt-strEntidad" value="#{localRow.aseguradora.strnombreentidad}"/>
                                </rich:column>
                                <rich:column id="tc-streditarpoliza" width="100px" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.btn_editarpoliza}" >
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.editar}" />
                                    </f:facet>
                                    <a4j:commandLink id="commandLinkEditarPoliza" title="#{var.editar}"
                                                     action="#{Supervisor$Contrato.editarPoliza}"
                                                     render="gpPolizaSelec, notienepoliza"
                                                     oncomplete="#{rich:component('mp_nueva_poliza')}.show();">
                                        <h:graphicImage  styleClass="ikont-"    width="25" height="25" value="/resources/imgs/bt_editar.png" />
                                        <a4j:param value="true" assignTo="#{Supervisor$Contrato.boolcrearpoliza}" />
                                    </a4j:commandLink>
                                </rich:column>
                                <rich:column id="tc-streliminarpoliza" width="100px" rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.btn_eliminarpoliza}">
                                    <f:facet name="header">
                                        <h:outputText  styleClass="ikont-"   value="#{var.eliminar}" />
                                    </f:facet>
                                    <a4j:commandLink id="commandLinkEliminarPoliza" title="#{var.eliminar}"
                                                     action="#{Supervisor$Contrato.eliminarPolizaNueva}"
                                                     immediate="true" render="polizasContrato, notienepoliza">
                                        <h:graphicImage  styleClass="ikont-"    width="25" height="25" value="/resources/imgs/bt_eliminar.png" />
                                    </a4j:commandLink>
                                </rich:column>
                            </rich:dataTable>
                            <a4j:commandButton id="commandButtonNuevaPoliza" value="Nueva póliza"
                                               rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.btn_insertarpoliza}"
                                               action="#{Supervisor$Contrato.instanciarPolizar}"
                                               oncomplete="#{rich:component('mp_nueva_poliza')}.show();"
                                               render="gpPolizaSelec">
                                <a4j:param assignTo="#{Supervisor$Contrato.boolcrearpoliza}" value="false" />
                            </a4j:commandButton>
                        </h:panelGroup>
                    </center>
                </rich:collapsiblePanel>

                <rich:collapsiblePanel id="collapsiblePanelComponentesImpactados" header="Componentes impactados"
                                       switchType="ajax" expanded="false" immediate="true"
                                       onclick="#{Supervisor$Contrato.encontrarComponentesImpactados()}"
                                       rendered="#{var.aplicacomponentescontrato and !Supervisor$Contrato.booltipocontratoconvenio}">
                    <h:panelGrid id="panelGridComponentesImpactadosConsulta" styleClass="totalwidth">
                        <rich:dataTable id="dataTableComponentesImpactadosConsulta" noDataLabel="No se agregaron componentes."
                                        value="#{Supervisor$Contrato.listacomponentesimpactados}"
                                        var="contratoComponenteImpactado" rows="10">
                            <rich:column sortBy="#{contratoComponenteImpactado.componente.strnombrecomponente}">
                                <f:facet name="header">
                                    <h:outputLabel value="Componente" />
                                </f:facet>

                                <h:outputText value="#{contratoComponenteImpactado.componente.strnombrecomponente}" rendered="#{contratoComponenteImpactado.componente.componente.strnombrecomponente == null}" />
                                <h:outputText value="#{contratoComponenteImpactado.componente.componente.strnombrecomponente}" rendered="#{contratoComponenteImpactado.componente.componente.strnombrecomponente != null}" />
                            </rich:column>

                            <rich:column sortBy="#{contratoComponenteImpactado.componente.strnombrecomponente}">
                                <f:facet name="header">
                                    <h:outputLabel value="Subcomponente" />
                                </f:facet>

                                <h:outputLabel value="No aplica." rendered="#{contratoComponenteImpactado.componente.componente.strnombrecomponente == null}" />
                                <h:outputText value="#{contratoComponenteImpactado.componente.strnombrecomponente}" rendered="#{contratoComponenteImpactado.componente.componente.strnombrecomponente != null}" />
                            </rich:column>
                        </rich:dataTable>
                    </h:panelGrid>
                </rich:collapsiblePanel>

                <rich:collapsiblePanel id="simpleTogglemodificarcontrato" switchType="ajax"
                                       header="#{var.modificacionescontrato} #{Supervisor$Contrato.tipoContCon}" 
                                       expanded="#{Supervisor$Contrato.boolmodifca}"
                                       toggleListener="#{Supervisor$Contrato.llenarModifacionesContrato}">
                    <a4j:ajax event="switch" render="pnmodificar" />
                    <h:panelGroup id="pnmodificar">
                        <h:panelGroup id="nomodificar">
                            <h:outputLabel  styleClass="ikont-"    rendered="#{Supervisor$Contrato.listaModificarContrato.size()==0}" value="#{var.notienemodificar}" />
                        </h:panelGroup>
                        <rich:dataTable id="tablamodificar" sortMode="single" 
                                        value="#{Supervisor$Contrato.listaModificarContrato}"
                                        rendered="#{Supervisor$Contrato.listaModificarContrato.size()>0}"
                                        rowKeyVar="filaSeleccionada"
                                        binding="#{Supervisor$ModificarContrato.binditablamodi}"
                                        var="modificarcontr">
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.fechamodificacion} " />
                                </f:facet>
                                <h:outputText  styleClass="ikont-"    id="datemodificacion" value="#{modificarcontr.datefechamodificacionseleccionada}" />
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.fechatermianter} " />
                                </f:facet>
                                <h:outputText  styleClass="ikont-"   id="datemodificacionanter" value="#{modificarcontr.datefechafin}" />
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.fechterminacion}" />
                                </f:facet>
                                <h:outputText  styleClass="ikont-"   id="dateterminacion" value="#{modificarcontr.datefechafinalizacion}" />
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.valorcontranter}" />
                                </f:facet>
                                <h:outputText  styleClass="ikont-"    value="#{modificarcontr.numvlrcontrato}">
                                    <f:convertNumber pattern="#{var.formatomoneda}" />
                                </h:outputText>
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.valorcontractua}" />
                                </f:facet>
                                <h:outputText  styleClass="ikont-"    value="#{modificarcontr.numvlrnuevo}">
                                    <f:convertNumber pattern="#{var.formatomoneda}" />
                                </h:outputText>
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   value="#{var.modificaciones}" />
                                </f:facet>
                                <rich:list var="tipo" value="#{modificarcontr.listatiposmodificacion}" rows="5">
                                    <h:outputText  styleClass="ikont-"   value="#{tipo.strdesctipomodif}" />
                                </rich:list>
                            </rich:column>
                            <rich:column width="120px">
                                <f:facet name="header">
                                    <h:outputText  styleClass="ikont-"   id="documento2" value="#{var.documento}" />
                                </f:facet>
                                <a4j:commandLink id="btAdjuntarImagenmodi" >
                                    <a4j:ajax event="click" listener="#{Supervisor$ModificarContrato.llenarDocumentosModifContrato}"
                                              onbeforesubmit="#{rich:component('panelModiContratoDoc')}.show();"
                                              render="tabladocumentomodi"/>
                                    <h:graphicImage  styleClass="ikont-"    value="/resources/imgs/bt_ver.png" />
                                </a4j:commandLink>
                            </rich:column>
                        </rich:dataTable>
                    </h:panelGroup>
                </rich:collapsiblePanel>

                <rich:collapsiblePanel header="#{var.generarReportes}">

                    <h:panelGrid columns="3" columnClasses="panelcenter" rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}" styleClass="font-general">
                        <h:panelGrid columnClasses="panelcenter">
                            <h:commandLink styleClass="pdf butonreport"   action="#{Supervisor$Contrato.ReporteConvenio}" />
                            <h:outputText  styleClass="ikont- font-general"   id="reporteconvenio" value="#{var.reporte} #{var.convenio}" />
                        </h:panelGrid>
                        <h:panelGrid columnClasses="panelcenter">
                            <h:commandLink styleClass="excel" action="#{Supervisor$Contrato.ReporteConvenioExcel}" />
                            <h:outputText id="reporteconvenioexcel" styleClass="font-general" value="#{var.reporte} #{var.convenio}"  />
                        </h:panelGrid>
                        <h:panelGrid columnClasses="panelcenter" rendered="#{Supervisor$Contrato.filtrocontrato.idestrategia != 1}">
                            <h:commandLink styleClass="excel butonreport"   action="#{Supervisor$Contrato.reporteProyectosConvenio}" id="excel" target="_blank" />
                            <h:outputText  styleClass="ikont- font-general"   id="reporteexcel" value="#{var.listadoproyectos}" />
                        </h:panelGrid>
                    </h:panelGrid>

                </rich:collapsiblePanel>

            </h:form>

        </h:panelGroup>
        <ui:include src="/modal/gestionpolizas/nuevapoliza.xhtml" />
        <ui:include src="/modal/modicontratoDetaDoc.xhtml" />
        <!--El orden de estos scripst se deben consevar para el buen funcionamiento-->
        <script src="/#{var.versioncobra}/resources/reloj/js/jquery.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/script_supervisor.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/js/sliderman.1.3.6.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/reloj/js/flipclock/libs/prefixfree.min.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/reloj/js/flipclock/flipclock.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            var $jpanel = jQuery.noConflict();
            $jpanel(document).ready(function() {
                var clock = $jpanel('.your-clock').FlipClock({
                    autoStart: true,
                    countdown: true,
                    clockFace: 'DailyCounter'
                });
                var timefalta = document.getElementById("finfecha").value;
                var futuro = new Date(timefalta).getTime();
                var ahora = #{SessionBeanCobra.fechaMilisegundosServidor} - (1000 * 60 * 60 * 24);
                var faltan = futuro - ahora;
                if (faltan > 0) {
                    var segundos = Math.round(faltan / 1000);
                }
                else {
                    var segundos = 00;
                }
                clock.setTime(segundos);
                clock.start();
            });</script>

        <h:outputScript name="csspopup.js" library="js" />
        <h:outputScript name="jquery.timers-1.0.0.js" library="js" />
        <script type="text/javascript" language="JavaScript">
            window.onload = iniciarFunciones();
            function iniciarFunciones() {
                var timefalta = document.getElementById("finfecha").value;
                var futuro = new Date(timefalta);
                var fechaNavegador = new Date();
                var milisegundosNavegador = fechaNavegador.getTime();
                var fechaSever =#{SessionBeanCobra.fechaMilisegundosServidor1} + (1000 * 60 * 60 * 24);
                var diferencia = new Date(fechaSever);
                setInterval(function() {
                    var ahora = new Date();
                    var faltan = futuro - diferencia;
                    if (faltan > 0) {
                        var segundos = Math.round(faltan / 1000);
                        var minutos = Math.floor(segundos / 60);
                        var segundos_s = segundos % 60;
                        var horas = Math.floor(minutos / 60);
                        var minutos_s = minutos % 60;
                        var dias = Math.floor(horas / 24);
                        var horas_s = horas % 24;
                        horas_s = (!(horas_s > 9)) ? '0' + horas_s : horas_s;
                        dias = (!(dias > 9)) ? '0' + dias : dias;
                        minutos_s = (!(minutos_s > 9)) ? '0' + minutos_s : minutos_s;
                        segundos_s = (!(segundos_s > 9)) ? '0' + segundos_s : segundos_s;
                        document.getElementById('refreshMeDias').innerHTML = dias;
                        document.getElementById('refreshMeHoras').innerHTML = horas_s;
                        document.getElementById('refreshMeMinutos').innerHTML = minutos_s;
                        document.getElementById('refreshMeSeg').innerHTML = segundos_s;
                    }
                }, 100);
            }
        </script>
    </ui:define>
</ui:composition>
