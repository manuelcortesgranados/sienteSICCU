<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" 
                xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:fiji="http://exadel.com/fiji"
                xmlns:m="http://code.google.com/p/gmaps4jsf/"
                template="/facelets/template_main.xhtml">
    <ui:define name="head">
        <script src="/#{var.versioncobra}/resources/amcharts/amcharts.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/amcharts/serial.js" type="text/javascript"></script>        
    </ui:define>
    <ui:define rendered="#{!var.permisonuevodiseno}" name="title">
        <h:outputText rendered="#{!var.permisonuevodiseno}" styleClass="ikont-hot-evolucioncontrato"   value="#{var.evolucioncontrato} #{Supervisor$Contrato.tipoContCon}"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>
            <ui:include src="/facelets/menu_lateral_contrato.xhtml"/>
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml"/>
        </h:panelGroup>

    </ui:define>
    <ui:define  rendered="#{var.permisonuevodiseÃ±o and Supervisor$Contrato.tipoContCon == 'Convenio'}" name="menusuperior">
        <ui:include src="/facelets/menu_superior_administrar_convenio.xhtml"/>
    </ui:define>
    <ui:define name="body" >


        <h:form prependId="false" >
            <interkont:spacer height="35" />
<!--            <rich:collapsiblePanel id="simpleToggleEvolucionFisi" header="#{var.evolucion}">
                <center>
                    <h:outputText  styleClass="ikont-hot-scriptGrafico"   value="#{Supervisor$GraficoEvolucionContrato.graficoEvolucionContrato.scriptGrafico}" escape="false"/>
                    <div id="graficoEvolucionContrato" style="width: 100%; height: 400px; text-align: left; overflow: hidden;">
                    </div>
                </center>
            </rich:collapsiblePanel>-->
            <rich:collapsiblePanel id="simpleToggleEvolucionFisiContrato" header="#{var.evolucion}" rendered="#{!Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                <center>
                    <h:outputText  styleClass="ikont-hot-scriptGrafico"   value="#{Supervisor$GraficoEvolucionFinancieraContrato.graficoEvolucionFinancieraContrato.scriptGrafico}" escape="false"/>
                    <div id="graficoEvolucionFinancieraContrato" style="width: 100%; height: 400px; text-align: left; overflow: hidden;">
                    </div>
                </center>
            </rich:collapsiblePanel>
            <rich:collapsiblePanel id="simpleToggleEvolucionFisiConvenio" header="#{var.evolucion}" rendered="#{Supervisor$Contrato.contrato.booltipocontratoconvenio}">
                <center>
                    <h:outputText  styleClass="ikont-hot-scriptGrafico"   value="#{Supervisor$GraficoEvolucionFinancieraConvenio.graficoEvolucionFinancieraConvenio.scriptGrafico}" escape="false"/>
                    <div id="graficoEvolucionFinancieraConvenio" style="width: 100%; height: 400px; text-align: left; overflow: hidden;">
                    </div>
                </center>
            </rich:collapsiblePanel>
        </h:form>


        <h:panelGrid styleClass="totalwidth" columnClasses="verticalalingtop" id="planificacion_movimientos" columns="2" >


            <h:panelGroup layout="block" id="gpListadoPlanificacion">

                <h:panelGrid id="formaanti" columns="3" columnClasses="panelderecha, panelizquierda, panelizquierda" styleClass="font-general">

                    <h:outputLabel  styleClass="ikont-hol-formadepago"   value="#{var.formadepago}:"/>
                    <interkont:spacer width="20"/>
                    <h:outputLabel  styleClass="ikont-hol-strdescformapago"    value="#{Supervisor$Contrato.contrato.formapago.strdescformapago}"/>

                    <h:outputLabel  styleClass="ikont-hol-porcentajeanticipopago"   value="#{var.porcentaje}#{var.anticipopago}:" rendered="#{Supervisor$Contrato.anticiforma==1}"/>
                    <interkont:spacer width="20" rendered="#{Supervisor$Contrato.anticiforma == 1}"/>
                    <h:outputLabel  styleClass="ikont-hol-porcenanticipo"  value="% #{Supervisor$Contrato.porcenanticipo}" rendered="#{Supervisor$Contrato.anticiforma == 1}"/>

                    <h:outputLabel  styleClass="ikont-hol-valoranticipo"   value="#{var.valoranticipo}:" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}"/>
                    <interkont:spacer width="20" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}"/>
                    <h:outputText  styleClass="ikont-hot-vloranticipo" value="#{Supervisor$Contrato.vloranticipo}" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}">
                        <f:convertNumber pattern="#{var.formatomoneda}"/>
                    </h:outputText>

                    <h:outputLabel  styleClass="ikont-hol-fechaanticipopago"   value="#{var.fecha} #{var.anticipopago}:" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}"/>
                    <interkont:spacer width="20" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}"/>
                    <h:outputText  styleClass="ikont-hot-fechapago" value="#{Supervisor$Contrato.fechapago}" rendered="#{Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 3}">
                        <f:convertDateTime pattern="#{var.formatofecha}"/>
                    </h:outputText>

                </h:panelGrid>

                <h:form>
                    <h:panelGrid style="width: 100%;"  rendered="#{(Supervisor$Contrato.anticiforma == 1 or Supervisor$Contrato.anticiforma == 2) and !Supervisor$Contrato.booltipocontratoconvenio}">
                        <interkont:spacer height="5" />
                        <rich:dataTable id="tablaPlanificacionContrato"
                                        rows="5"
                                        var ="planificacion"
                                        onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                        sortMode="single"
                                        value="#{SessionBeanCobra.cobraService.listaPlanificacionpagos}"
                                        >
                            <f:facet name="header">
                                <rich:columnGroup>
                                    <rich:column width="100px" breakRowBefore="true" colspan="3">
                                        <h:outputText  styleClass="ikont-hot-numeroactasparciales"   value="#{var.numero} de Actas Parciales"/>
                                    </rich:column>
                                    <rich:column width="100px" breakRowBefore="true">
                                        <h:outputText  styleClass="ikont-hot-porcentajedeciuacta"   value="#{var.porcentaje} #{var.deCiu}l #{var.acta}"/>
                                    </rich:column>
                                    <rich:column width="100px">
                                        <h:outputText  styleClass="ikont-hot-valordeciuacta"   value="#{var.valor} #{var.deCiu}l #{var.acta}" />
                                    </rich:column>
                                    <rich:column width="100px">
                                        <h:outputText  styleClass="ikont-hot-fechadeciuacta"   value="#{var.fecha} #{var.deCiu}l #{var.acta}" />
                                    </rich:column>
                                </rich:columnGroup>
                            </f:facet>
                            <rich:columnGroup>
                                <rich:column  width="100px" breakRowBefore="true">
                                    <h:outputText  styleClass="ikont-hot-numvlrporcentage"   value="#{planificacion.numvlrporcentage} %"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText  styleClass="ikont-hot-numvlrpago"   value="#{planificacion.numvlrpago}">
                                        <f:convertNumber pattern="#{var.formatomoneda}"/>
                                    </h:outputText>
                                </rich:column>
                                <rich:column >
                                    <h:outputText  styleClass="ikont-hot-datefechapago"   value="#{planificacion.datefechapago}">
                                        <f:convertDateTime pattern="#{var.formatofecha}"/>
                                    </h:outputText>
                                </rich:column>
                            </rich:columnGroup>

                        </rich:dataTable>
                    </h:panelGrid>
                    <h:panelGrid style="width: 100%;"  rendered="#{Supervisor$Contrato.booltipocontratoconvenio}">
                        <interkont:spacer height="5" />
                        <rich:dataTable id="tablaPlanificacionConvenio"
                                        rows="5"
                                        var ="planificacion"
                                        onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                        sortMode="single"
                                        value="#{SessionBeanCobra.cobraService.planificadoConvenio}"
                                        >
                            <f:facet name="header">
                                <rich:columnGroup>
                                    <rich:column width="100px" breakRowBefore="true" colspan="3">
                                        <h:outputText  styleClass="ikont-hot-numeroactasparciales"   value="#{var.numero} de Actas Parciales"/>
                                    </rich:column>
                                    <rich:column width="100px" breakRowBefore="true">
                                        <h:outputText  styleClass="ikont-hot-fechadeciuacta"   value="#{var.fecha} #{var.deCiu}l #{var.acta}" />
                                    </rich:column>
                                    <rich:column width="100px">
                                        <h:outputText  styleClass="ikont-hot-valordeciuacta"   value="#{var.valor} #{var.deCiu}l #{var.acta}" />
                                    </rich:column>
                                </rich:columnGroup>
                            </f:facet>
                            <rich:columnGroup>
                                <rich:column >
                                    <h:outputText  styleClass="ikont-hot-datefechapago"   value="#{planificacion.key}">
                                        <f:convertDateTime pattern="#{var.formatofecha}"/>
                                    </h:outputText>
                                </rich:column>
                                <rich:column>
                                    <h:outputText  styleClass="ikont-hot-numvlrpago"   value="#{planificacion.value}">
                                        <f:convertNumber pattern="#{var.formatomoneda}"/>
                                    </h:outputText>
                                </rich:column>
                            </rich:columnGroup>
                        </rich:dataTable>
                    </h:panelGrid>
                </h:form>
            </h:panelGroup>

            <h:panelGroup layout="block" id="gpListadoMovimientos">

                <h:form>
                    <h:panelGrid  style="width: 83%" rendered="#{!Supervisor$Contrato.booltipocontratoconvenio}">
                        <interkont:spacer height="5" />
                        <rich:dataTable id="tablaDesembolsosContrato"
                                        var ="desembolso"
                                        onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                        sortMode="single"
                                        value="#{Supervisor$GraficosEvolucion.desembolsos}"
                                        >
                            <f:facet name="header">
                                <rich:columnGroup>
                                    <rich:column width="200px" breakRowBefore="true" colspan="2">
                                        <h:outputText  styleClass="ikont-hot-movimientosfinancieros"   value="#{var.movimientosfinancieros}"/>
                                    </rich:column>
                                    <rich:column width="100px"  breakRowBefore="true" >
                                        <h:outputText  styleClass="ikont-hot-fecha"   value="#{var.fecha}"/>
                                    </rich:column>
                                    <rich:column width="100px">
                                        <h:outputText  styleClass="ikont-hot-valormovimiento"   value="#{var.valormovimiento}" />
                                    </rich:column>
                                </rich:columnGroup>
                            </f:facet>
                            <rich:columnGroup>
                                <rich:column >
                                    <h:outputText  styleClass="ikont-hot-fechamovimiento"   value="#{desembolso.fecha}">
                                        <f:convertDateTime pattern="#{var.formatofecha}"/>
                                    </h:outputText>
                                </rich:column>
                                <rich:column>
                                    <h:outputText  styleClass="ikont-hot-numvlrejecutado"   value="#{desembolso.valor}">
                                        <f:convertNumber pattern="#{var.formatomoneda}"/>
                                    </h:outputText>
                                </rich:column>
                            </rich:columnGroup>

                        </rich:dataTable>
                    </h:panelGrid>
                    <h:panelGrid  style="width: 83%" rendered="#{Supervisor$Contrato.booltipocontratoconvenio}" >
                        <interkont:spacer height="5" />
                        <rich:dataTable id="tablaDesembolsosConvenio"
                                        var ="desembolso"
                                        onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                        sortMode="single"
                                        value="#{Supervisor$GraficosEvolucion.desembolsoEntry}"
                                        >
                            <f:facet name="header">
                                <rich:columnGroup>
                                    <rich:column width="200px" breakRowBefore="true" colspan="2">
                                        <h:outputText  styleClass="ikont-hot-movimientosfinancieros"   value="#{var.movimientosfinancieros}"/>
                                    </rich:column>
                                    <rich:column width="100px"  breakRowBefore="true" >
                                        <h:outputText  styleClass="ikont-hot-fecha"   value="#{var.fecha}"/>
                                    </rich:column>
                                    <rich:column width="100px">
                                        <h:outputText  styleClass="ikont-hot-valormovimiento"   value="#{var.valormovimiento}" />
                                    </rich:column>
                                </rich:columnGroup>
                            </f:facet>
                            <rich:columnGroup>
                                <rich:column >
                                    <h:outputText  styleClass="ikont-hot-fechamovimiento"   value="#{desembolso.key}">
                                        <f:convertDateTime pattern="#{var.formatofecha}"/>
                                    </h:outputText>
                                </rich:column>
                                <rich:column>
                                    <h:outputText  styleClass="ikont-hot-numvlrejecutado"   value="#{desembolso.value}">
                                        <f:convertNumber pattern="#{var.formatomoneda}"/>
                                    </h:outputText>
                                </rich:column>
                            </rich:columnGroup>

                        </rich:dataTable>
                    </h:panelGrid>
                </h:form>

            </h:panelGroup>

        </h:panelGrid>
        <rich:collapsiblePanel switchType="client" header="Avance fisico del convenio" expanded="true" rendered="#{Supervisor$Contrato.boolavanceproyectoconvenio}">
            <h:form>
                <h:panelGrid width="95%">
                    <rich:dataTable rows="12"  value="#{Supervisor$Contrato.listaavancefisico}" var="avancefisico" id="rdtlistaavance">
                        <rich:column  width="100px" >
                            <f:facet name="header">
                                <h:outputText     value="Proyectos"/>
                            </f:facet>
                            <h:outputText value="#{avancefisico.nombreobra}"/>
                            <f:facet name="footer">
                                <h:outputText value="Valor convenio"/>
                            </f:facet>
                        </rich:column>
                        <rich:column  width="100px" >
                            <f:facet name="header">
                                <h:outputText     value="Valor"/>
                            </f:facet>
                            <h:outputText value="#{avancefisico.valortotalobra}">
                                <f:convertNumber type="currency"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputText value="#{Supervisor$Contrato.valorconvenio}">
                                    <f:convertNumber type="currency"/>
                                </h:outputText>
                            </f:facet>
                        </rich:column>
                        <rich:column  width="100px" >
                            <f:facet name="header">
                                <h:outputText  value="Avance proyecto"/>
                            </f:facet>
                            <h:outputText value="#{avancefisico.valorejecobra}">
                                <f:convertNumber type="currency"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputLabel value="Suma proyectos" />
                            </f:facet>
                        </rich:column>
                        <rich:column  width="100px" >
                            <f:facet name="header">
                                <h:outputText    value="Avance proyecto porcentual"/>
                            </f:facet>
                            <h:outputText value="#{avancefisico.avanceobra} %">
                                <f:convertNumber type="percent"/>
                            </h:outputText>
                            <f:facet name="footer">
                                <h:outputLabel value="#{Supervisor$Contrato.sumaproyectosconvenio}">
                                    <f:convertNumber type="currency"/>
                                </h:outputLabel>                                    
                            </f:facet>
                        </rich:column>    

                        <rich:column  width="100px" >
                            <f:facet name="header">
                                <h:outputText    value="Avance fisico convenio"/>
                            </f:facet>
                            <h:outputText value="#{avancefisico.avancefisico} %">
                                <f:convertNumber type="percent"/>
                            </h:outputText>  
                            <f:facet name="footer">                                 
                                <h:outputText value="#{Supervisor$Contrato.avancefisicoconvenio}%">
                                    <f:convertNumber type="percent"/>
                                </h:outputText>                                     
                            </f:facet>
                        </rich:column>                        
                    </rich:dataTable>
                    <h:panelGrid width="95%">
                        <rich:dataScroller for="rdtlistaavance" style="width: 95%"/>
                    </h:panelGrid>
                </h:panelGrid>
            </h:form>
        </rich:collapsiblePanel>
    </ui:define>
</ui:composition>
