<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition  
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:m="http://code.google.com/p/gmaps4jsf/"  
    template="/facelets/template_main.xhtml">

    <ui:define name="head">
        <title>Cobra - Supervisor</title>
        <h:outputScript name="script_supervisor.js"/>
    </ui:define>
    <ui:define name="title">
        <h:outputText rendered="#{!var.permisonuevodiseno}"  styleClass="ikont-hot-finalizarproyecto"   value="#{var.finalizarproyecto}"/>                              
        <h:outputText rendered="#{!var.permisonuevodiseno}"  styleClass="ikont-hot-finalizarproyectostrnombre"    value="#{Supervisor$AdministrarObraNew.obra.strnombremedio}"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>
            <ui:include src="/facelets/menu_lateral_administrar.xhtml"/>
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml"/>
        </h:panelGroup>
    </ui:define>
    <ui:define  rendered="#{var.permisonuevodiseno}" name="menusuperior">
        <ui:include  src="/facelets/menu_superior_administrar_proyecto.xhtml"/>
    </ui:define>
    <ui:define name="body">
        <h:form>
            <h:panelGroup id="layoutFinalizar">
                <center>
                    <h:panelGroup id="gpErrorFin">
                        <h:outputText  styleClass="ikont-hot-mensajefinalizar"  value="#{Supervisor$AdministrarObraNew.mensajefinaliza}"/>
                    </h:panelGroup>
                    <h:panelGrid id="panel_FinalizarPaso1"   columnClasses="aiu" styleClass="totalwidth">
                        <rich:panel header="#{var.finalizarobra}">
                            <h:outputText  styleClass="ikont-hot-panelfinalizarpaso1"   rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra!=1 and Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra!=4 and Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra!=5}"
                                           value="#{var.solopuedefinalizaobrasactivas}" />
                            <h:panelGroup>
                                <center>
                                    <h:outputText  styleClass="ikont-hot-pasosparafinalizarobra"   value="#{var.pasosparafinalizarobra}" />
                                    <br/>
                                    <interkont:spacer height="15px;"/>
                                </center>
                            </h:panelGroup>
                            <center>
                                <h:panelGrid id="gridPasosFin" columns="1" styleClass="font-general">
                                    <h:panelGroup >
                                        <h:outputText  styleClass="ikont-hot-registrarelrecibofinal"  value="#{var.registrarelrecibofinal}"/>
                                        <interkont:spacer width="10"/>
                                        <h:outputText  styleClass="ikont-hot-noseharealizado" value="(#{var.noseharealizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==1 }"/>
                                        <h:outputText  styleClass="ikont-hot-realizado "   value="(#{var.realizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==4 || Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==2 || Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==5}"/>
                                    </h:panelGroup>
                                    <h:panelGroup>
                                        <h:outputText  styleClass="ikont-hot-registrarlaultimaacta" value="#{var.registrarlaultimaacta}"/> <interkont:spacer width="15px;"/>
                                        <interkont:spacer width="10"/>
                                        <h:outputText  styleClass="ikont-hot-noseharealizado" value="(#{var.noseharealizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==4}"/>
                                        <h:outputText  styleClass="ikont-hot-realizado"    value="(#{var.realizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==5 || Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==2}"/>
                                    </h:panelGroup>
                                    <h:panelGroup>
                                        <h:outputText  styleClass="ikont-hot-registraliquidacionfinal"  value="#{var.registraliquidacionfinal}"/><interkont:spacer width="15px;"/>
                                        <interkont:spacer width="10"/>
                                        <h:outputText  styleClass="ikont-hot-noseharealizado" value="(#{var.noseharealizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==5}"/>
                                        <h:outputText  styleClass="ikont-hot-realizado"    value="(#{var.realizado})" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==2}"/>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </center>
                            <h:panelGroup>
                                <center><interkont:spacer height="25px;"/>
                                    <h:panelGrid id="finPaso1"   columnClasses="aiu" styleClass="font-general" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==1}">
                                        <h:panelGroup>
                                            <h:outputText  styleClass="ikont-hot-registrar"  value="#{var.registrar} "/>
                                            <h:outputText  styleClass="ikont-hot-elrecibofinaldeobra " value="#{var.elrecibofinaldeobra}"/>
                                        </h:panelGroup>
                                        <h:outputText  styleClass="ikont-hot-antesderegistrarelrecibofinal" value="#{var.antesderegistrarelrecibofinal}"/>
                                        <interkont:spacer height="10px;"/>
                                        <h:panelGrid id="layoutActaRecFin" columns="2" width="500" columnClasses="labelsDetalle">
                                            <a4j:commandButton id="btActaRecFin" value="#{var.examinar}" immediate="true"   styleClass="ikont-acb-btactarecfin"  
                                                               onclick="#{rich:component('panelActaRecFin')}.show();
                                                                       return true;" />
                                            <h:inputText size="40" id="txtActaRecFin" disabled="true" value="#{Supervisor$AdministrarObraNew.urlactarecfin}" />
                                            <h:outputText  styleClass="ikont-hot-fecactarecfin "    value="#{var.fechadelacta} "/>
                                            <rich:calendar locale="#{var.rcalendarlocale}" id="fecActaRecfin" value="#{Supervisor$AdministrarObraNew.obra.datefecrecfin}"/>
                                        </h:panelGrid>
                                        <h:outputText  styleClass="ikont-hot-estatotalmenteseguroregistrar"  value="#{var.estatotalmenteseguroregistrar}"/>
                                        <h:panelGroup>
                                            <a4j:commandButton id="BTaceptarFinPaso1"  value="#{var.si}" styleClass="ikont-acb-btaceptarfinalpaso1"   render="gpErrorFin, layoutFinalizar"
                                                               action="#{Supervisor$AdministrarObraNew.registrarReciboFinal}" >
                                            </a4j:commandButton>
                                            <interkont:spacer width="10"/>
                                            <a4j:commandButton id="BTnoFinPaso1"  value="#{var.no}" styleClass="ikont-acb-btnofinpaso1"   action="admindetalleObra"/>

                                        </h:panelGroup>
                                        <interkont:spacer height="30" width="200"/>
                                        <h:outputText  styleClass="ikont-hot-notaunavez"  value="#{var.notaunavez}"/>

                                    </h:panelGrid>
                                    <h:panelGrid id="finPaso2"  columnClasses="aiu" styleClass="font-general" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==4}">

                                        <h:panelGroup>
                                            <h:outputText  styleClass="ikont-hot-registrar2" value="#{var.registrar2}"/>
                                            <h:outputText  styleClass="ikont-hot-laultimaacta" value="#{var.laultimaacta}"/>
                                        </h:panelGroup>
                                        <h:outputText  styleClass="ikont-hot-estatotalmenteseguroregistrar" value="#{var.estatotalmenteseguroregistrar}"/>
                                        <h:panelGroup>
                                            <h:outputText  styleClass="ikont-hot-antesdedarclick" value="#{var.antesdedarclick}"/>
                                        </h:panelGroup>

                                        <h:panelGroup>
                                            <a4j:commandButton id="BTaceptarFinPaso2"  value="#{var.si}" styleClass="ikont-acb-btaceptarfinpaso2"  
                                                               render="gpErrorFin, layoutFinalizar" action="#{Supervisor$AdministrarObraNew.registrarUltimaActaParcial}"
                                                               />
                                            <interkont:spacer width="10"/>
                                            <a4j:commandButton id="BTno1"  value="#{var.no}" styleClass="ikont-acb-btno1"   action="admindetalleObra"/>
                                        </h:panelGroup>
                                        <interkont:spacer height="30" width="200"/>

                                    </h:panelGrid>
                                    <h:panelGrid id="finPaso3"  columnClasses="aiu" styleClass="font-general" rendered="#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra==5}">
                                        <h:panelGroup>
                                            <h:outputText  styleClass="ikont-hot-registrar3" value="#{var.registrar3} "/>
                                            <h:outputText  styleClass="ikont-hot-laliquidaciondestaobra" value="#{var.laliquidaciondestaobra}"/>
                                        </h:panelGroup>
                                        <h:outputText  styleClass="ikont-hot-antesderegistrarlaliquidacion"    value="#{var.antesderegistrarlaliquidacion}"/>
                                        <h:panelGrid id="layoutActaFin" columns="2" styleClass="layoutactafin" columnClasses="labelsDetalle">
                                            <a4j:commandButton id="btActaFin" styleClass="ikont-"   value="#{var.examinar}"  immediate="true"
                                                               oncomplete="#{rich:component('panelActaFin')}.show(); return true;" />
                                            <h:inputText size="40" id="txtActaFin" disabled="true" value="#{Supervisor$AdministrarObraNew.urlactafin}" />
                                            <h:outputText  styleClass="ikont-hot-fechadelacta"    value="#{var.fechadelacta} "/>
                                            <rich:calendar locale="#{var.rcalendarlocale}" id="fecActafin" value="#{Supervisor$AdministrarObraNew.obra.datefecliqui}" >
                                                <a4j:ajax execute="@this" ></a4j:ajax>
                                            </rich:calendar>
                                        </h:panelGrid>
                                        <h:outputText  styleClass="ikont-hot-estatotalmenteseguroliquidacion"    value="#{var.estatotalmenteseguroliquidacion}"/>
                                        <h:panelGroup>
                                            <h:outputText  styleClass="ikont-hot-aldarclickensi"    value="#{var.aldarclickensi}"/>
                                        </h:panelGroup>
                                        <a4j:commandButton id="BTaceptarFinPaso3" styleClass="ikont-acb-btaceptarfinpaso3"   value="#{var.si}" action="#{Supervisor$AdministrarObraNew.validarLiquidacion}"
                                                           render="gpErrorFin, layoutConfFin" oncomplete="#{rich:component('panelConfirmaFin')}.show(); return true;"  execute="@this">

                                        </a4j:commandButton>

                                        <interkont:spacer height="30" width="200"/>
                                    </h:panelGrid>
                                </center>
                            </h:panelGroup>
                        </rich:panel>
                    </h:panelGrid>
                </center>
            </h:panelGroup>
        </h:form>
        <ui:include src="/modal/panelConfirmaFinModal.xhtml" />
        <ui:include src="/modal/panelActaFinModal.xhtml" />
        <ui:include src="/modal/panelActaRecFinModal.xhtml" />
        <ui:include src="/modal/panelFinalizadoModal.xhtml" />
    </ui:define>

</ui:composition>