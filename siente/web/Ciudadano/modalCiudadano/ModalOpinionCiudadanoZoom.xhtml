<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition  
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:m="http://code.google.com/p/gmaps4jsf/"  
    >
    <h:head>
        <link href="/#{var.versioncobra}/resources/css/valla.css" rel="stylesheet" type="text/css" />
    </h:head>
    <h:body>
        <rich:popupPanel width="562" id="participacionciudadanomodal" resizeable="false" autosized="true"
                         >

            <f:facet name="controls">
                <h:form>
                    <h:panelGroup>
                        <a4j:commandLink id="esconder_modalDetalleObra" styleClass="ikont-acl-escondermodaldetalleobra closemodal"   
                                         title="#{var.cerrar}" immediate="true" onclick="#{rich:component('participacionciudadanomodal')}.hide();
                                                 return false;"/>
                    </h:panelGroup>
                </h:form>
            </f:facet>
            <h:form id="form_">

                <div class="ikont-rp-OpinionCiu1"></div>
                <h:panelGroup layout="block" styleClass="ikont-rp-gpdetaobramodal"  id="gpDetaObraModal">
                    <rich:panel styleClass="ikont-rp-OpinionCiu" >
                        <center>
                            <h:outputText styleClass="ikont-txt-titulo-opinion" value="#{Ciudadano$PerfilCiudadano.opinion}"/>
                        </center>
                        <h:outputText  styleClass="ikont-hot-idnuevo"   id="idnuevo" value="#{rowcomentario_par.jsfUsuario.tercero.strnombrecompleto}" rendered="#{!rowcomentario_par.boolidentidadoculta}"   />

                        <h:form target="_blank">
                            <h:panelGroup>
                                <h:panelGrid id="comen_par" >
                                    <a4j:repeat id="repeatopinion" value="#{Ciudadano$PerfilCiudadano.listopinion}"  binding="#{Ciudadano$PerfilCiudadano.repeatopinion}" var="rowcomentario_par" >
                                        <h:panelGrid id="tablaopinionciudadano" styleClass="ikont-table-opinion"  columns="1">
                                            <h:panelGroup >

                                                <h:graphicImage styleClass="ikont-img-opinion-ciudadano"   url="#{var.ipserver}#{var.versioncobra}#{rowcomentario_par.jsfUsuario.tercero.strfoto}" 
                                                       rendered="#{!rowcomentario_par.boolidentidadoculta}" />
                                                <h:graphicImage   styleClass="ikont-img-opinion-ciudadano"   url="/resources/imgs/bt_nodisponible.png" rendered="#{rowcomentario_par.boolidentidadoculta}" />

                                                <h:outputText  styleClass="ikont-hot-idstrnombre_parnuevo"   id="idstrnombre_parnuev" value="#{rowcomentario_par.jsfUsuario.tercero.strnombrecompleto}" rendered="#{!rowcomentario_par.boolidentidadoculta}"   />
                                                <h:outputText  styleClass="ikont-hot-idstrnombre_par_nnuevo"   id="idstrnombre_par_nnue" value="Anonimo" rendered="#{rowcomentario_par.boolidentidadoculta}" />
                                                <br/>
                                                <h:outputText  styleClass="ikont-date-opinion-fecha"   id="iddate_parnuev" value="#{rowcomentario_par.datefechaopinion}" >
                                                    <f:convertDateTime timeZone="GMT-5" type="both" dateStyle="long"/>
                                                </h:outputText>
                                            </h:panelGroup>

                                            <h:panelGrid styleClass="ikont-table-opinion" cellspacing="10" columns="2" >
                                                <h:outputText styleClass="ikont-txt-opinion-proyecto" value="#{var.obra}"/>
                                                <h:outputText  styleClass="ikont-hot-idstrnombre_obra"   id="idstrnombre_obra" value="#{Supervisor$AdministrarObraNew.obra.strnombreobra}" /> 

                                                <h:outputText styleClass="ikont-txt-opinion-proyecto" value="#{var.direccion}"/>
                                                <h:outputText  styleClass="ikont-hot-idstrdireccion_obra"   id="idstrdireccion_obra" value="#{Supervisor$AdministrarObraNew.obra.strdireccion}" /> 
                                            </h:panelGrid>
                                            <hr class="ikont-hr-oponion-separador"/>
                                            <h:panelGrid>
                                                <h:outputLabel  styleClass="ikont-hol-idcomentario_par"    id="idcomentario_par" value="#{rowcomentario_par.stropinion}" />
                                                <h:graphicImage rendered="#{rowcomentario_par.strfotoopinion != null}" styleClass="ikont-img-opinion-comentario"   url="#{var.ipserver}#{var.versioncobra}#{rowcomentario_par.strfotoopinion}" />
                                                <h:graphicImage rendered="#{rowcomentario_par.strfotoopinion == null}" styleClass="ikont-img-opinion-comentario"   url="/resources/imgs/bt_nodisponible.png"/>

                                            </h:panelGrid>
                                            <h:panelGroup rendered="false">



                                                <h:outputText  styleClass="ikont-hot-idcontarmensaje2"   id="idcontarmensa" value="#{Ciudadano$PerfilCiudadano.contarmensaje}" /><br/>
                                                <h:inputTextarea  id="iacomentario2" styleClass="ikont-hit-iacomentario2"   rows="5" cols="40" onkeydown="return maximaLongitud(this, 400)"  
                                                                  value="#{SessionBeanCobra.ciudadanoservice.opinionciudadano.stropinion}" onclick="borrar_campo(this);" >
                                                    <a4j:ajax listener="#{Ciudadano$PerfilCiudadano.contarcomentario}" event="keyup" render="idcontarmensa" status="idstatuscomentario2" />
                                                </h:inputTextarea>

                                                <h:panelGroup>
                                                    <a4j:commandLink styleClass="ikont-acl-cancelarComentario"   action="#{Ciudadano$PerfilCiudadano.cancelarComentario}" oncomplete="document.location.href='../Supervisor/DetalleObra.xhtml?id=#{Supervisor$AdministrarObraNew.obra.intcodigoobra}';">Cancelar</a4j:commandLink>
                                                    <a4j:commandLink styleClass="ikont-acl-guardarComentarioOpinion"   action="#{Ciudadano$PerfilCiudadano.guardarComentarioOpinionZoom}" render="pgPrincipalComentario, layoutDocCiu, panelImagenCiu">guardar
                                                    </a4j:commandLink>
                                                </h:panelGroup>

                                            </h:panelGroup>
                                        </h:panelGrid>

                                    </a4j:repeat>

                                </h:panelGrid>
                                <center>
                                <rich:dataScroller   for="repeatopinion" render="repeatopinion"/>
                                </center>
                            </h:panelGroup>
                            <rich:hotKey key="esc" onkeyup="#{rich:component('participacionciudadanomodal')}.hide();
                                         return false;" />
                        </h:form>

                    </rich:panel>

                </h:panelGroup>   
            </h:form>
        </rich:popupPanel>
    </h:body>
</ui:composition>