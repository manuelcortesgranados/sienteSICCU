<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:composite="http://java.sun.com/jsf/composite"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:a4j="http://richfaces.org/a4j"
                xmlns:rich="http://richfaces.org/rich"
                template="/facelets/template_main.xhtml"
                xmlns:interkont="http://www.interkont.com/jsf">
    <ui:define name="head">
        <h:outputScript library="amcharts" name="amcharts.js"></h:outputScript>
        <h:outputScript  name="RGraph.meter.js" library="js/RGraph" />
        <h:outputScript  name="RGraph.common.core.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.effects.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.context.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.annotate.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.tooltips.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.zoom.js" library="js/RGraph" />
        <h:outputScript name="RGraph.common.resizing.js" library="js/RGraph"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>
    <ui:define name="title">
        <h:outputText  styleClass="ikont- "   value="#{var.tablerodecontrol}"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>                
        <ui:include src="/facelets/menu_lateral_novedades.xhtml"/>
        <h:panelGroup rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.btnslider_dashboard}" id="gpSliderpanelesdash2">
            <ui:include src="/Ciudadano/Slider_paneles_dashboard.xhtml"/>
        </h:panelGroup>

    </ui:define>
    <ui:define name="body">
        <h:form id="dashboard">
            <h:panelGrid columns="1" id="panelgerencial" cellpadding="0" cellspacing="0" width="90%">
                <h:outputText  styleClass="ikont-hot-texto1inversion "   value="#{var.texto1_inversion_tablerocontrol}" />
                <h:panelGrid id="panelcombos"  columns="5"  >
                    <h:panelGroup styleClass="ikont-hpg-panelcombos"  >
                        <h:selectOneMenu value="#{ControlGerencial.vistaicom}" styleClass="ikont-hsom-vistaicom"  >
                            <f:selectItem itemLabel="#{var.zonaespec}" itemValue="1"/>
                            <f:selectItem itemLabel="#{var.localidad}" itemValue="0"/>
                            <a4j:ajax event="change" render="panelcombos" />
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:panelGroup styleClass="ikont-hpg-deptos"   rendered="#{ControlGerencial.vistaicom != 1}">
                        <h:selectOneMenu value="#{ControlGerencial.deptos}" styleClass="ikont-hsom-deptos"  >
                            <f:selectItem itemValue="0" itemLabel="Todos"/>
                            <f:selectItems value="#{ControlGerencial.sedeptos}" />
                            <a4j:ajax event="change" listener="#{ControlGerencial.llenarMunici}" render="municipioincom"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:panelGroup id="municipioincom" styleClass="ikont-hpg-municipioincom"   rendered="#{ControlGerencial.vistaicom != 1}">
                        <h:selectOneMenu value="#{ControlGerencial.muni}" styleClass="ikont-hsom-muni"  >
                            <f:selectItem itemValue="0" itemLabel="Todos"/>
                            <f:selectItems value="#{ControlGerencial.semuni}" />
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:panelGroup styleClass="ikont-hpg-intzona"   rendered="#{ControlGerencial.vistaicom == 1}">
                        <h:selectOneMenu value="#{ControlGerencial.intzona}" styleClass="ikont-hsom-intzona"  >
                            <f:selectItem itemValue="0" itemLabel="Todos"/>
                            <f:selectItems value="#{ControlGerencial.zonaespecifica}"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                    <h:panelGroup >
                        <h:commandLink value="Graficar" action="#{ControlGerencial.generarGraficos}" styleClass="ikont-hcl-graficar"   />
                    </h:panelGroup>
                </h:panelGrid>
                <rich:panel bodyClass="ikont-rp-sliderbody" headerClass="ikont-rp-sliderheader" >
                    <f:facet name="header">
                        <h:outputText  styleClass="ikont-hot-header"   value="Los últimos 10 proyectos reportados"/>
                    </f:facet>

                    <div id="container">
                        <div id="slider" styleClassdivSlider">
                            <a4j:repeat value="#{ControlGerencial.listaimagenesslider}" var="imagen">
                                <div>
                                    <h:graphicImage  styleClass="ikont-hgi-strnombrecrot"   alt="#{imagen.obra.strnombrecrot}" url="#{var.ipserver}siente#{imagen.strubicacion}" />
                                    <h:outputLink
                                        value="#{facesContext.externalContext.requestContextPath}/faces/Supervisor/DetalleObra.xhtml?id=#{imagen.obra.intcodigoobra}" >
                                        <h:outputText  styleClass="ikont-hot-strnombrecrot"   value="#{imagen.obra.strnombrecrot}"/>
                                    </h:outputLink>
                                </div>
                            </a4j:repeat>
                        </div>
                    </div>
                </rich:panel>
                <h:panelGrid columns="2" cellpadding="0" cellspacing="0" >
                    <h:panelGrid cellpadding="0" cellspacing="0">
                        <rich:panel headerClass="ikont-topheader" bodyClass="ikont-panelTableroControl">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-headerinvporregion"  value="#{(ControlGerencial.invporregion)?'Inversión Total por Región':'Inversión Total Nacional'}"/>
                            </f:facet>
                            <center>
                                <h:panelGrid  columns="2" styleClass="ikont-hpg-invporregion"   rendered="#{!ControlGerencial.invporregion}">
                                    <h:graphicImage  styleClass="ikont-hgi-invporregion "   url="/resources/imgs/dash_01.png" width="50" height="50" />
                                    <h:panelGroup >
                                        <h:outputText  styleClass="ikont-hot-inversionTotalNal"   value="#{ControlGerencial.informaciondash.inversionTotalNal}">
                                            <f:convertNumber pattern="$###,###"/>
                                        </h:outputText>
                                    </h:panelGroup>
                                </h:panelGrid>

                                <h:panelGrid   columns="2" styleClass="ikont-hpg-invporregion1"   rendered="#{ControlGerencial.invporregion}">
                                    <h:graphicImage  styleClass="ikont-hgi-invporregion1"   url="/resources/imgs/dash_01.png" width="50" height="50" />
                                    <h:panelGroup >
                                        <h:outputText  styleClass="ikont-hot-inversionTotalRegion"   value="#{ControlGerencial.informaciondash.inversionTotalRegion}">
                                            <f:convertNumber pattern="$###,###"/>
                                        </h:outputText>
                                    </h:panelGroup>
                                </h:panelGrid>
                            </center>
                            <interkont:spacer height="10"/>
                            <h:panelGrid columns="3"  rendered="false">
                                <interkont:spacer width="30"/>
                                <h:panelGrid>
                                    <h:outputLabel  styleClass="ikont-hot-carteracolectiva"   value="#{var.carteracolectiva}" />
                                    <h:outputText  styleClass="ikont-hot-porcentajeCartera "   value="#{ControlGerencial.porcentajeCartera}%" />
                                    <h:outputLabel  styleClass="ikont-hol-totalCartera"   value="#{ControlGerencial.totalCartera}" >
                                        <f:convertNumber pattern="$###,###"/>
                                    </h:outputLabel>
                                </h:panelGrid>

                                <h:outputText  styleClass="ikont-hot-scriptcolumnaporcentual"   value="#{ControlGerencial.columnatotalgeneral.scriptcolumnaporcentual}" escape="false"/>
                            </h:panelGrid>
                            <interkont:spacer height="30"/>
                            <h:panelGrid columns="3"  rendered="false">
                                <interkont:spacer width="30"/>
                                <h:panelGrid>
                                    <h:outputLabel  styleClass="ikont-hol-pago"   value="#{var.pago} a contratistas" />
                                    <h:outputText  styleClass="ikont-hot-porcentajePago"   value="#{ControlGerencial.porcentajePago}%" />
                                    <h:outputLabel  styleClass="ikont-hol-totalPago"   value="#{ControlGerencial.totalPago}" >
                                        <f:convertNumber pattern="$###,###"/>
                                    </h:outputLabel>
                                </h:panelGrid>
                                <h:outputText  styleClass="ikont-hot-scriptcolumnaporcentual1"   value="#{ControlGerencial.columnapagocontratistas.scriptcolumnaporcentual}" escape="false"/>
                            </h:panelGrid>
                            <interkont:spacer height="30"/>
                            <h:panelGrid columns="3"  rendered="false">
                                <interkont:spacer width="30"/>
                                <h:panelGrid>
                                    <h:outputLabel  styleClass="ikont-hol-legalizacion"   value="#{var.legalizacion}" />
                                    <h:outputText  styleClass="ikont-hot-porcentajeLegalizado"   value="#{ControlGerencial.porcentajeLegalizado}%"  />
                                    <h:outputText  styleClass="ikont-hot-totalLegalizado"   value="#{ControlGerencial.totalLegalizado}" >
                                        <f:convertNumber pattern="$###,###"/>
                                    </h:outputText>
                                </h:panelGrid>
                                <h:outputText  styleClass="ikont-hot-scriptcolumnaporcentual2"   value="#{ControlGerencial.columnalegalizacion.scriptcolumnaporcentual}" escape="false"/>
                            </h:panelGrid>
                            <interkont:spacer height="20"/>
                            <interkont:spacer height="40"/>
                        </rich:panel>
                    </h:panelGrid>
                    <h:panelGrid columns="2" cellpadding="0" cellspacing="0">
                        <rich:panel headerClass="ikont-rp-headertablerocontrol1" bodyClass="ikont-rp-bodytablerocontrol1">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-personashogares"   value="Personas y hogares"/>
                            </f:facet>
                            <h:panelGrid>
                                <h:panelGroup>
                                    <h:panelGrid columns="2" cellpadding="0" captionStyle="0"   >
                                        <h:graphicImage  styleClass="ikont-hgi-personas"   value="/resources/imgs/dash_07.png" />
                                        <h:outputText    value="Personas" styleClass="ikont-hot-personas"  />
                                    </h:panelGrid>
                                    <h:outputText  styleClass="ikont-hot-scriptGrafico2"   value="#{ControlGerencial.barraspersonas.scriptGrafico}" escape="false"/>
                                    <div id="chartpersonas" ></div>
                                </h:panelGroup>
                                <h:panelGroup >
                                    <h:panelGrid columns="2" cellpadding="0" captionStyle="0" styleClass="ikont-hpg-hogares"  >
                                        <h:graphicImage  styleClass="ikont-hgi-Hogares "   value="/resources/imgs/dash_06.png"   />
                                        <h:outputText  styleClass="ikont-hot-Hogares "   value="Hogares"  />
                                    </h:panelGrid>
                                    <h:outputText  styleClass="ikont-hot-scriptGrafico"   value="#{ControlGerencial.barrashogares.scriptGrafico}" escape="false"/>
                                    <div id="charthogares" ></div>
                                </h:panelGroup>
                            </h:panelGrid>
                        </rich:panel>
                        <rich:panel headerClass="ikont-rp-headertablerocontrol" bodyClass="ikont-rp-bodytablerocontrol">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-entidadesnacionalesheader"   value="Entidades Nacionales"/>
                            </f:facet>
                            <h:panelGroup>
                                <h:outputText  styleClass="ikont-hot-inversionConvenios"   value="#{ControlGerencial.informaciondash.inversionConvenios}" >
                                    <f:convertNumber pattern="$###,###"/>
                                </h:outputText>
                                <h:inputHidden id="estaen" value="#{ControlGerencial.informaciondash.intPorcentageEje}" />


                                <div id="popUpDiv">
                                    <div id="capaContent">
                                        <div>
                                            <canvas id="meterds" width="270" height="137">
                                                <div styleClasscanvasfallback">[No canvas support]</div></canvas>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h:outputText  styleClass="ikont-hot-porcentajeinversion"                                                   
                                                  value="Porcentaje de Inversión: " />
                                    <h:outputText  styleClass="ikont-hot-stEstado"   id="stEstado"
                                                  value="#{ControlGerencial.informaciondash.porInversionConvenios}">
                                        <f:convertNumber type="percent"/>
                                    </h:outputText>
                                </div>
                            </h:panelGroup>
                            <interkont:spacer height="40" />
                            <h:panelGroup>
                                <a4j:commandLink rendered="#{var.vermasdashboard}" 
                                                 value="#{var.ver}+"
                                                 styleClass="ikont-hcl-vermasdashboard"    
                                                 action="#{ControlGerencial.obtenerConsolidadoConvenios}"
                                                 execute="@this"
                                                 render=":modalDashboard_entesnacionales"
                                                 oncomplete="#{rich:component('modalDashboard_entesnacionales')}.show();">

                                </a4j:commandLink>
                            </h:panelGroup>
                        </rich:panel>

                        <rich:panel  headerClass="ikont-rp-headertablerocontrol2" bodyClass="ikont-rp-bodytablerocontrol2">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-facerentesterritoriales"   value="Entes Territoriales"/>
                            </f:facet>
                            <h:panelGrid  rowClasses="ikont-cell-top">
                                <h:panelGroup>
                                    <center>
                                        <h:panelGrid>
                                            <h:outputLabel  styleClass="ikont-hol-dashinvtipoproyecto"   value="#{var.dashinvtipoproyecto}" />
                                            <h:outputText  styleClass="ikont-hot-scriptPieDashboard"   value="#{ControlGerencial.piecontrol.scriptPieDashboard}" escape="false"/>
                                            <div id="proyectospie" ></div>
                                        </h:panelGrid>
                                        <h:outputText  styleClass="ikont-hot-inversionObra"   value="#{ControlGerencial.informaciondash.inversionObra}">
                                            <f:convertNumber pattern="$###,###"/>
                                        </h:outputText>
                                        <h:panelGrid  rendered="false">
                                            <h:outputLabel  styleClass="ikont-hol-ejecuciontotal"   value="#{var.ejecuciontotal}" />
                                            <h:outputText  styleClass="ikont-hot-scriptcolumnaporcentual2"   value="#{ControlGerencial.columnaproyectoconsolidado.scriptcolumnaporcentual}" escape="false"/>
                                        </h:panelGrid>
                                    </center>
                                </h:panelGroup>
                                <interkont:spacer height="10" />
                                <a4j:commandLink rendered="#{var.vermasdashboard}" 
                                                 value="#{var.ver}+"
                                                 styleClass="ikont-hcl-vermasdashboard"    
                                                 action="#{ControlGerencial.obtenerConsolidadoRehabilitacion}"
                                                 execute="@this"
                                                 render=":modalDashboard_rehabilitacion"
                                                 oncomplete="#{rich:component('modalDashboard_rehabilitacion')}.show();">

                                </a4j:commandLink>
                            </h:panelGrid>
                        </rich:panel>
                        <rich:panel headerClass="ikont-rp-headertablerocontrol3" bodyClass="ikont-rp-bodytablerocontrol3">
                            <f:facet name="header">
                                <h:outputText  styleClass="ikont-hot-faceatencionhumanitaria"   value="Atención humanitaria"/>
                            </f:facet>

                            <h:panelGroup>
                                <ul >
                                    <interkont:spacer height="50"/>
                                    <a4j:repeat value="#{ControlGerencial.listaServiciosAHAtendidas}" var="item">

                                        <li styleClassliItemAtencion">
                                            <h:outputText  styleClass="ikont-hot-etiqueta"   value="#{item.etiqueta}:"/>

                                            <h:outputText  styleClass="ikont-hot-valormoney"   value="#{item.valormoney}">
                                                <f:convertNumber pattern="###,###"/>
                                            </h:outputText>

                                        </li>

                                    </a4j:repeat>

                                </ul>

                            </h:panelGroup>
                            <h:panelGrid>
                                <interkont:spacer height="20" />
                                <h:outputText  styleClass="ikont-hot-inversionAh"   value="#{ControlGerencial.informaciondash.inversionAh}" >
                                    <f:convertNumber pattern="$###,###"/>
                                </h:outputText>
                                <interkont:spacer height="5" />                                        
                                <h:panelGroup>
                                    <a4j:commandLink rendered="#{var.vermasdashboard}" 
                                                     value="#{var.ver}+"
                                                     styleClass="ikont-hcl-vermasdashboard"    
                                                     action="#{ControlGerencial.obtenerConsolidadoAh}"
                                                     execute="@this"
                                                     render=":modalDashboard_ah"
                                                     oncomplete="#{rich:component('modalDashboard_ah')}.show();">  
                                    </a4j:commandLink>
                                </h:panelGroup>
                            </h:panelGrid>
                        </rich:panel>
                    </h:panelGrid>
                </h:panelGrid>
            </h:panelGrid>
        </h:form>
        <ui:include src="/ControlGerencial/modalDashboard/modalDashboardRehabilitacion.xhtml"/>
        <ui:include src="/ControlGerencial/modalDashboard/modalDashboardConvenios.xhtml"/>
        <ui:include src="/ControlGerencial/modalDashboard/modalDashboardAtencionH.xhtml"/>
        <script src="/#{var.versioncobra}/resources/gSlider/js/jquery-1.4.4.min.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/gSlider/js/image-slider.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/gSlider/js/panel-image-slider.js" type="text/javascript"></script>
        <script type="text/javascript">
            var $j = jQuery.noConflict();
            $j(document).ready(function() {
                var $i = jQuery.noConflict();
                $i('#slider').slider({speed: 500});
                $i('#slider2').slider2({speed: 500, action: true});
            });
        </script>
        <script>
            function init() {
                var estaen = document.getElementById("dashboard:estaen").value;
                var min = 0;
                var max = 100;

                var meterds = new RGraph.Meter('meterds', min, max, estaen);

                var grad1 = meterds.context.createRadialGradient(meterds.canvas.width / 2, meterds.canvas.height - 25, 0, meterds.canvas.width / 2, meterds.canvas.height - 25, 200);
                grad1.addColorStop(0, 'green');
                grad1.addColorStop(1, 'white');

                var grad2 = meterds.context.createRadialGradient(meterds.canvas.width / 2, meterds.canvas.height - 25, 0, meterds.canvas.width / 2, meterds.canvas.height - 25, 200);
                grad2.addColorStop(0, 'yellow');
                grad2.addColorStop(1, 'white');

                var grad3 = meterds.context.createRadialGradient(meterds.canvas.width / 2, meterds.canvas.height - 25, 0, meterds.canvas.width / 2, meterds.canvas.height - 25, 200);
                grad3.addColorStop(0, 'red');
                grad3.addColorStop(1, 'white');

                meterds.Set('chart.labels.position', 'inside');
                meterds.Set('chart.title.vpos', 0.5);
                meterds.Set('chart.title.color', 'black');
                meterds.Set('chart.green.color', grad1);
                meterds.Set('chart.yellow.color', grad2);
                meterds.Set('chart.red.color', grad3);
                meterds.Set('chart.background.color', 'white');
                meterds.Set('chart.background.color', 'red');
                meterds.Set('chart.border', false);
                meterds.Set('chart.needle.linewidth', 5);
                meterds.Set('chart.needle.tail', true);
                meterds.Set('chart.tickmarks.big.num', 0);
                meterds.Set('chart.tickmarks.small.num', 0);
                meterds.Set('chart.segment.radius.start', 90);
                meterds.Set('chart.needle.radius', 50);
                meterds.Set('chart.needle.linewidth', 2);
                meterds.Set('chart.linewidth.segments', 9);
                meterds.Set('chart.strokestyle', 'white');
                meterds.Set('chart.text.size', 7);
                RGraph.Effects.Meter.Grow(meterds);
            }
            window.onload = init;
        </script>

    </ui:define>


</ui:composition>