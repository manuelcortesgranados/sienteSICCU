<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" 
                xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets"> 
    <link href="#{facesContext.externalContext.requestContextPath}/resources/cssfonade/main.css?#{var.version}" rel="stylesheet" type="text/css"/>
    <center>
        <h:panelGroup  id="paneldatosbasicopo" layout="block" style="width: 900px;" styleClass="ikont-rp-db" >
            <center>
                <h:outputLabel value="#{var.informacionbasica}" styleClass="hol_info_convenio_zoom"/>
                <a4j:region id="datosBasicosConvenio" >
                    <h:panelGrid columns="1" cellpadding="5" cellspacing="10">
                        <h:panelGrid columns="2" styleClass="panel_numero_convenio">
                            <rich:column>
                                <h:outputText value="Número del Convenio" styleClass="hot_n_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputText id="hit-nro-convenio" value="#{Supervisor$Contrato.contrato.strnumcontrato}" title="#{var.numero} #{var.del} #{var.convenio}" style="height: 32px!important; width: 320px!important;" required="true" >
                                    <rich:placeholder value="Ej: 442D5" styleClass="input_num_convenio"/>
                                    <f:validateLength maximum="255"/>
                                </h:inputText>     
                                <rich:message for="hit-nro-convenio" />
                            </rich:column>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="panel_nom_abreviado">
                            <rich:column>
                                <h:outputText value="Nombre abreviado" styleClass="input_nom_abreviado label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputText id="hit-nom-convenio"  value="#{Supervisor$Contrato.contrato.strnombre}" required="true" style="width: 320px!important;height: 32px!important;">
                                    <rich:placeholder  value="#{var.nombreabreviadoconvenio}"  styleClass="input_num_convenio" />
                                    <f:validateLength maximum="255"/>
                                </h:inputText>
                                <rich:message for="hit-nom-convenio"/>
                            </rich:column>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="panel_val_estimado">
                            <rich:column>
                                <h:outputText value="Valor estimado" styleClass="input_val_estimado label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputText id="hit-valorest-convenio" value="#{Supervisor$Contrato.contrato.numvlrcontrato}" style="width: 320px!important;height: 32px!important;">
                                    <rich:placeholder value="#{var.valorestimado}" />
                                    <f:validateDoubleRange minimum="0" />
                                    <f:validateLength maximum="26"/>
                                </h:inputText>
                                <rich:message for="hit-valorest-convenio"/>
                            </rich:column>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="panel_obj_convenio">
                            <rich:column>
                                <h:outputText value="Objeto del convenio" styleClass="input_obj_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputTextarea id="hit-obj-convenio" style="height: 80px;width: 319px!important;" styleClass="campos_largos"  value="#{Supervisor$Contrato.contrato.textobjeto}"/>
                            </rich:column>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="panel_ger_convenio">
                            <rich:column>
                                <h:outputText value="Gerente del convenio" styleClass="input_ger_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <rich:select id="select-gerente-convenio"  value="#{Supervisor$Contrato.contrato.gerenteconvenio}" style="height: 32px!important; width: 306px!important;">
                                    <f:selectItems value="#{Supervisor$Contrato.gerentesDeConvenio}"  />
                                </rich:select>
                            </rich:column>
                        </h:panelGrid> 

                        <h:panelGrid columns="2" styleClass="panel_fec_suscripcion">
                            <rich:column>
                                <h:outputText value="*" styleClass="input_asterisco_convenio label_texto_convenio"/>
                                <h:outputText value="Fecha suscripción" styleClass="input_fec_convenio label_texto_convenio" />
                            </rich:column>
                            <rich:column>
                                <rich:calendar id="id-fechasuscripcion"  datePattern="yyyy-MM-dd" direction="bottomRight"  value="#{Supervisor$Contrato.contrato.datefechaini}" required="true" style="width: 320px !important;">                                                  <rich:message for="id-fechasuscripcion"  />
                                    <a4j:ajax listener="#{Supervisor$Contrato.fechaCambio}" event="change" execute="id-fechasuscripcion,id-datefechafin" render="h-ol-duraciondias"/>
                                    <rich:tooltip  value="#{var.fechasuscripcion}"/>
                                </rich:calendar>
                            </rich:column>
                        </h:panelGrid>

                        <h:panelGrid columns="2" styleClass="panel_fec_final">
                            <rich:column>
                                <h:outputText value="*" styleClass="input_asterisco_convenio label_texto_convenio"/>
                                <h:outputText value="Fecha finalización" styleClass="input_fec_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <rich:calendar id="id-datefechafin" datePattern="yyyy-MM-dd" direction="bottomRight"  value="#{Supervisor$Contrato.contrato.datefechafin}" required="true">                    
                                    <rich:message for="id-datefechafin"  />
                                    <a4j:ajax listener="#{Supervisor$Contrato.fechaCambio}" event="change" execute="id-fechasuscripcion,id-datefechafin" render="h-ol-duraciondias"/>
                                    <rich:tooltip  value="#{var.fechafinalizacion}"/>
                                </rich:calendar>   
                                <h:outputLabel value="Plazo en dias #{Supervisor$Contrato.contrato.intduraciondias}" id="h-ol-duraciondias"/>
                            </rich:column>
                        </h:panelGrid>  

                        <h:panelGrid columns="2" styleClass="panel_fec_inicio">
                            <rich:column>
                                <h:outputText value="Fecha acta de inicio" styleClass="input_fec_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <rich:calendar  id="id-datefechaini" datePattern="yyyy-MM-dd" direction="bottomRight" value="#{Supervisor$Contrato.contrato.fechaactaini}">
                                    <rich:tooltip  value="#{var.fechaactainicio}"/>
                                </rich:calendar>
                            </rich:column>
                        </h:panelGrid>
                    </h:panelGrid>
                </a4j:region>

                <br/>
                <br/>
                <br/>
                <!--rich:collapsiblePanel switchType="client" header="{var.fuenterecurso}"-->
                <center>                  
                    <h:outputLabel value="#{var.fuenterecurso}" styleClass="hol_fuente_recursos_zoom"/>
                    <h:panelGrid columns="1" style="font-size: 12px!important;font-style: italic !important;position: relative;right: -16px;">
                        <center><h:outputLabel id="hol-fuenterecsubtitulo1" value="#{var.subfuenterecursos1}"/></center>              
                        <center><h:outputLabel id="hol-fuenterecsubtitulo2" value="#{var.subfuenterecursos2}" style="position: relative;top: -7px;right: -15px;"/></center>
                    </h:panelGrid>
                </center>

                <br/>
                <h:panelGrid columns="1" cellpadding="5" cellspacing="10" id="hpg-fuenter-conv">
                    <h:panelGrid columns="2" styleClass="panel_ent_convenio">
                        <rich:column>
                            <h:outputText value="Entidad"  styleClass="input_var_convenio label_texto_convenio" />
                        </rich:column>
                        <rich:column>
                            <rich:select    id="rs-entidad" defaultLabel="Ej: Ministerio de vivienda" value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.tercero.intcodigo}" required="true" style="font-style: italic!important; font-size: 12px!important;">                                
                                <f:selectItems  value="#{Supervisor$Contrato.lstentidades}" var="ent" itemValue="#{ent.intcodigo}" itemLabel="#{ent.strnombrecompleto}" />
                            </rich:select>
                            <rich:message for="rs-entidad"  />
                        </rich:column>
                    </h:panelGrid>

                    <h:panelGroup id="hpg-fuenter-roldesempenado">
                        <h:panelGrid columns="2" styleClass="panel_rol_desem">
                            <rich:column>
                                <h:outputText value="Rol a desempeñar" styleClass="input_var_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <rich:select id="rs-roles" defaultLabel="Ej: Cliente" value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.rolentidad.idrolentidad}" required="true" requiredMessage="Ingresar el rol"  styleClass="input_num_convenio" >
                                    <f:selectItems value="#{Supervisor$Contrato.recursosconvenio.lstRoles}" var="rol" itemValue="#{rol.idrolentidad}" itemLabel="#{rol.strnombre}" />
                                </rich:select>
                                <rich:message for="rs-roles"  />
                            </rich:column>
                        </h:panelGrid>
                    </h:panelGroup>

                    <h:panelGrid id="hpg-fuenter-valoraportado" columns="1" cellspacing="5" >
                        <h:panelGrid columns="2" styleClass="panel_val_aportado">
                            <rich:column>
                                <h:outputText value="Valor aporte al convenio" styleClass="input_var_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputText id="hit-valoraportado-convenio" value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.valoraportado}" required="true" style="width: 321px!important;" >
                                    <rich:placeholder value="Ej: $74,784.0"  styleClass="input_num_convenio"/>
                                    <f:validateDoubleRange minimum="0"/>
                                    <f:validateLength maximum="26" minimum="1"/>
                                    <a4j:ajax event="change" listener="#{Supervisor$Contrato.recursosconvenio.calcularValorGerencia}" execute="hit-valoraportado-convenio,hit-cuotagerencia-convenio,rs-tipoaporte" render="hpg-valor"/>
                                </h:inputText>
                                <rich:message for="hit-valoraportado-convenio"  />
                            </rich:column>
                        </h:panelGrid>
                    </h:panelGrid> 
                </h:panelGrid> 

                <h:panelGrid id="hpg-fuenter-cuotag" columns="1" cellspacing="5" >
                    <h:panelGrid columns="3" styleClass="panel_cuo_gerencia">
                        <rich:column>
                            <h:outputText value="Cuota de gerencia" styleClass="input_var_convenio label_texto_convenio"/>
                        </rich:column>
                        <rich:column>
                            <rich:select id="rs-tipoaporte" defaultLabel="#{var.tipoaporte}"  value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.tipoaporte}" required="true">
                                <f:selectItems value="#{Supervisor$Contrato.recursosconvenio.tipoAporte}"  />
                                <a4j:ajax event="selectitem"  listener="#{Supervisor$Contrato.recursosconvenio.calcularValorGerencia}" 
                                          execute="hpg-fuenter-cuotag,hit-valoraportado-convenio,hit-cuotagerencia-convenio,rs-tipoaporte,panel_res_iva,panel_otr_reserva,hit-reservaiva-convenio,hit-otrasreservas-convenio" render="hpg-valor,hpg-fuenter-cuotag" />
                            </rich:select> 
                            <rich:message for="rs-tipoaporte"  />
                        </rich:column>
                        <rich:column>
                            <h:inputText id="hit-cuotagerencia-convenio"  value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.valorcuotagerencia}" required="true" style="width: 222px;position: relative;left: 11px;" >
                                <rich:placeholder value="#{var.cuotagerencia}" />
                                <f:validateDoubleRange  minimum="0"  />                            
                                <f:validateLength maximum="26" minimum="1" />
                                <a4j:ajax event="change" listener="#{Supervisor$Contrato.recursosconvenio.calcularValorGerencia}" 
                                          execute="hit-valoraportado-convenio,hit-cuotagerencia-convenio,rs-tipoaporte,panel_res_iva,panel_otr_reserva,hit-reservaiva-convenio,hit-otrasreservas-convenio" render="hpg-valor"/>
                            </h:inputText>
                            <rich:message for="hit-cuotagerencia-convenio"  />
                        </rich:column>
                    </h:panelGrid>


                    <h:panelGroup id="hpg-valor">
                        <h:panelGrid columns="3" styleClass="panel_val_porcentaje">
                            <rich:column>
                                <h:outputText value="Valor/porcentaje" styleClass="input_var_convenio label_texto_convenio"/>
                            </rich:column>
                            <rich:column>
                                <h:inputText id="hit-valorgerencia-convenio" disabled="true"
                                             value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.strporcentajecuotagerencia}"  required="true" style="width: 321px!important;">                            
                                    <rich:placeholder value="#{var.cuotagerencia}" />                            
                                </h:inputText>
                                <rich:message for="hit-valorgerencia-convenio"  />
                            </rich:column>
                        </h:panelGrid>
                    </h:panelGroup>

                </h:panelGrid>  
                <h:panelGrid columns="2" styleClass="panel_res_iva">
                    <rich:column>
                        <h:outputText value="Reserva para IVA"  styleClass="input_var_convenio label_texto_convenio"/>
                    </rich:column>
                    <rich:column>
                        <h:inputText id="hit-reservaiva-convenio" value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.reservaiva}" style="width: 321px!important;">
                            <rich:placeholder value="Ej: $74,784.0"  styleClass="input_num_convenio"/>
                        </h:inputText>
                    </rich:column>
                </h:panelGrid>
                <h:panelGrid columns="2" styleClass="panel_otr_reserva">
                    <rich:column>
                        <h:outputText value="Otras reservas" styleClass="input_var_convenio label_texto_convenio"/>
                    </rich:column>
                    <rich:column>
                        <h:inputText id="hit-otrasreservas-convenio" value="#{Supervisor$Contrato.recursosconvenio.fuenteRecursoConvenio.otrasreservas}" style="width: 321px!important;" >
                            <rich:placeholder value="Ej: $975.356.00"  styleClass="input_num_convenio"/>
                        </h:inputText>
                    </rich:column>
                </h:panelGrid>
                <br/>
                <br/>

                <rich:messages id="messagesDatoBasPlanOpe" globalOnly="true"
                               styleClass="ikont-rm-messages"   ajaxRendered="true"
                               >
                    <f:facet name="infoMarker">
                        <h:graphicImage  styleClass="ikont-hgi-msginfopng"   height="20px" width="20px" url="/resources/imgs/msginfo.png" />
                    </f:facet>
                    <f:facet name="warnMarker">
                        <h:graphicImage  styleClass="ikont-hgi-msgwarnpng"   height="10px" width="20px" url="/resources/imgs/msgwarn.png" />
                    </f:facet>
                    <f:facet name="errorMarker">
                        <h:graphicImage  styleClass="ikont-hgi-msgerrorpng"   height="20px" width="20px" url="/resources/imgs/msgerror.png" />
                    </f:facet>
                    <f:facet name="fatalMarker">
                        <h:graphicImage  styleClass="ikont-hgi-msgerrorpngfatal"    height="20px" width="20px" url="/resources/imgs/msgerror.png" />
                    </f:facet>
                </rich:messages>
                <h:panelGrid cellspacing="10" cellpadding="10">
                    <a4j:commandButton value="#{var.adicionar}" 
                                       action="#{Supervisor$Contrato.recursosconvenio.adicionarFuenteRecursos}" 
                                       render="hpg-fuenter-conv,hpg-fuenter-cuotag, hpg-fuenter-valoraportado,hit-valorgerencia-convenio,panel_res_iva,panel_otr_reserva,hit-reservaiva-convenio,hit-otrasreservas-convenio, rdt-fuenteRecurso" 
                                       execute="hpg-fuenter-conv,hpg-fuenter-cuotag, hpg-fuenter-valoraportado,hit-valorgerencia-convenio,panel_res_iva, panel_otr_reserva,hit-reservaiva-convenio,hit-otrasreservas-convenio, rdt-fuenteRecurso"/>

                </h:panelGrid>        
                <!--/rich:collapsiblePanel-->
                <rich:dataTable id="rdt-fuenteRecurso"
                                var="fuente"
                                value="#{Supervisor$Contrato.recursosconvenio.lstFuentesRecursos}"
                                onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                onrowmouseout="this.style.backgroundColor='#FFFFFF'"
                                sortMode="single" rows="5"
                                style="text-align:center;"
                                rowKeyVar="filaSeleccionada"
                                binding="#{Supervisor$Contrato.recursosconvenio.tableFuente}"
                                >                                      
                    <f:facet name="header">
                        <rich:columnGroup>
                            <rich:column colspan="7" id="titulo" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.fuenterecurso} "/>
                            </rich:column>
                            <rich:column width="200px" breakRowBefore="true" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.entidad}"/>
                            </rich:column>
                            <rich:column width="200px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.rol}"/>
                            </rich:column>
                            <rich:column width="200px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.reservaiva}"/>
                            </rich:column>
                            <rich:column width="200px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.otrasreservas}"/>
                            </rich:column>
                            <rich:column width="100px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.cuotagerencia}"/>
                            </rich:column>
                            <rich:column width="100px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.valoraportado}"/>
                            </rich:column>
                            <rich:column width="100px" styleClass="ikont-colum-superior-fuente-recurso">
                                <h:outputText value="#{var.eliminar}"/>
                            </rich:column>
                        </rich:columnGroup>      
                    </f:facet>
                    <rich:columnGroup id="cuerpofuente">
                        <rich:column width="200px" breakRowBefore="true">
                            <h:outputText value="#{fuente.tercero.strnombrecompleto}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{fuente.rolentidad.strnombre}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{fuente.reservaiva}">
                                <f:convertNumber currencySymbol="$" type="currency" />
                            </h:outputText>
                        </rich:column>
                        <rich:column >
                            <h:outputText value="#{fuente.otrasreservas}">
                                <f:convertNumber currencySymbol="$" type="currency" />
                            </h:outputText>
                        </rich:column>
                        <rich:column >
                            <h:outputText value="#{fuente.valorcuotagerencia}">
                                <f:convertNumber currencySymbol="$" type="currency" />
                            </h:outputText>
                        </rich:column>
                        <rich:column >
                            <h:outputText value="#{fuente.valoraportado}">
                                <f:convertNumber currencySymbol="$" type="currency" />
                            </h:outputText>
                        </rich:column>
                        <rich:column>
                            <a4j:commandLink   value="#{var.eliminar}" id="bt_eliminarfuente"  render="rdt-fuenteRecurso" execute="rdt-fuenteRecurso"
                                               action="#{Supervisor$Contrato.recursosconvenio.eliminarFuenteRecursos}"
                                               />
                        </rich:column>
                    </rich:columnGroup>
                    <f:facet name="footer">
                        <rich:columnGroup id="headerFuente">
                            <rich:column colspan="4">
                                <h:outputText value="Total:"/>
                            </rich:column>
                            <rich:column colspan="2">
                                <h:outputText value="#{Supervisor$Contrato.recursosconvenio.sumafuentes}">
                                    <f:convertNumber currencySymbol="$" type="currency" />
                                </h:outputText>
                            </rich:column>
                            <rich:column breakRowBefore="true" colspan="6">
                                <rich:dataScroller for="rdt-fuenteRecurso" stepControls="auto" render="rdt-fuenteRecurso" execute="rdt-fuenteRecurso"/>
                            </rich:column>
                        </rich:columnGroup>
                    </f:facet>
                </rich:dataTable>                       
                <br/>            
            </center>

        </h:panelGroup>
    </center>
</ui:composition>
