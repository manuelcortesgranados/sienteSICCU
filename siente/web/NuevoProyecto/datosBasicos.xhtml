<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:ui="http://java.sun.com/jsf/facelets" template="/facelets/template_proyecto.xhtml">    

    <ui:define name="head">
        <title>Nuevo #{var.proyecto} - Supervisor</title>
        <h:outputScript library="js" name="/resources/script_supervisor.js"/>
        <h:outputScript library="js" name="/resources/js/validarletra.js"/>

    </ui:define>
    <ui:define name="title">
        <h:outputText value="#{var.ingresarnuevoproyecto} - #{var.datosbasicos}"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml"/>
    </ui:define>

    <ui:define name="body">

        <h:form id="form_datos_basicos"  >
            <a4j:jsFunction oncomplete="#{rich:component(modalAvisoSupervisor)}.hide();" rendered="#{SessionBeanCobra.vermensajeinterventor and var.varmodalsupervisor}"
                            id="editdatosbasicos" name="showModal" action="#{SessionBeanCobra.visualizoModal}" ></a4j:jsFunction> 
            <table  style="width:100%;" align="center" border="0" cellspacing="8" cellpadding="0">
                <tr>
                    <td rowspan="6" valign="top" style="height: 400px; width: 20%">
                        <ui:include src="/facelets/menu_lateral_gestion.xhtml"/>
                        <ui:include src="/facelets/menu_lateral_proyecto.xhtml"/>
                    </td>
                    <td valign="top" height="35" style="width: 80%">
                        <rich:panel id="mp-proyectosPadres">
                            <f:facet name="header" >
                                <h:panelGroup >
                                    <h:outputText value="#{var.pasosIniciales}" styleClass="txt_header" />
                                </h:panelGroup>
                            </f:facet>
                           
                            <rich:collapsiblePanel switchType="ajax" header="3. #{var.datosbasicos}"  >
                                <h:outputText style="font-size:8px;float:right;" value="(#{Supervisor$IngresarNuevaObra.obranueva.intcodigoobra})" rendered="#{Supervisor$IngresarNuevaObra.obranueva.intcodigoobra!=0}"/>
                                <h:panelGrid id="layoutPrincipalTab" columnClasses="aiu" columns="2" >

                                    <h:outputLabel id="lblnomabrev"  value="#{var.nombreabre}:" for="txtNombreAbrev">
                                        <rich:message for="txtNombreAbrev" style="color: #ed0606;"/>
                                    </h:outputLabel>
                                    <h:inputTextarea  id="txtNombreAbrev" value="#{Supervisor$IngresarNuevaObra.obranueva.strnombreobra}" 
                                                      cols="60" rows="2" >

                                    </h:inputTextarea>


                                    <h:outputLabel id="lblFecIni"  value="#{var.fechaactainicio}" for="fecIni">
                                        <rich:message for="fecIni" style="color: #ed0606;"/>
                                    </h:outputLabel>

                                    <rich:calendar locale="#{var.rcalendarlocale}" datePattern="yyyy-MM-dd" direction="top-right" id="fecIni" inputSize="10" value="#{Supervisor$IngresarNuevaObra.obranueva.datefeciniobra}" disabled="#{Supervisor$IngresarNuevaObra.cargadorCronograma.numArchivos>0}" >
                                        <a4j:ajax listener="#{Supervisor$IngresarNuevaObra.feciniCambio}" event="onchanged" render="layoutPeriodo" />
                                    </rich:calendar>

                                    <h:outputLabel id="lblFecFin"  value="#{var.fechaterminacion}"/>

                                    <h:panelGroup id="layoutFechaFin" >
                                        <rich:calendar locale="#{var.rcalendarlocale}" datePattern="yyyy-MM-dd" id="fecFin" inputSize="10" value="#{Supervisor$IngresarNuevaObra.obranueva.datefecfinobra}" disabled="#{Supervisor$IngresarNuevaObra.cargadorCronograma.numArchivos>0}" >
                                            <a4j:ajax listener="#{Supervisor$IngresarNuevaObra.fechaCambio}" event="onchanged" render="layoutPeriodo"/>
                                        </rich:calendar>
                                    </h:panelGroup>
                                    <h:outputLabel  value="#{var.periodomedida}"/>
                                    <h:panelGroup id="layoutPeriodoMedi2">
                                        <h:selectOneMenu id="comboperiodomedida" value="#{Supervisor$IngresarNuevaObra.obranueva.periodomedida.intidperiomedida}"  >
                                            <f:selectItems value="#{Supervisor$IngresarNuevaObra.periodoMedida}" />
                                        </h:selectOneMenu>
                                    </h:panelGroup>

                                    <h:outputLabel id="lblPlazodias"  value="#{var.plazodias}" for="plazodias">
                                        <rich:message for="plazodias" style="color: #ed0606;"/>
                                    </h:outputLabel>
                                    <h:panelGroup id="layoutPeriodo">
                                        <h:inputText  size="15" id="plazodias" value="#{Supervisor$IngresarNuevaObra.obranueva.intplazoobra}" disabled="true">
                                            <f:validateLongRange minimum="0"/>
                                            <f:validateLength maximum="6" minimum="1"/>
                                            <a4j:ajax event="onchange" listener="#{Supervisor$IngresarNuevaObra.feciniCambio}" render="layoutPeriodo"/>
                                        </h:inputText>
                                    </h:panelGroup>

                                    <h:outputLabel id="lblEntidadContratantec"  value="#{var.entidadcontratante}"/>
                                    <h:panelGroup id="layoutenco">
                                        <rich:select  style="width: 400px;" id="cmbEntidadContratantec" 
                                                       defaultLabel="Ingrese Entidad" value="#{Supervisor$IngresarNuevaObra.obranueva.tercero.strnombrecompleto}"
                                                       disabled="#{Supervisor$IngresarNuevaObra.validacion.contratos or Supervisor$IngresarNuevaObra.desdeconvenio or Supervisor$IngresarNuevaObra.obranueva.solicitudmaestro!=null}">
                                            <f:selectItems value="#{Supervisor$IngresarNuevaObra.terceroOption}" />
                                            <a4j:ajax event="onchange" listener="#{Supervisor$IngresarNuevaObra.comboEntidadesObraguardar}" >
                                                <a4j:ajax event="oncomplete" render="gpentidadministerios" />
                                            </a4j:ajax>
                                        </rich:select>
                                    </h:panelGroup>

                                    <h:outputLabel id="lblinterventor"  value="#{var.houtsupervisor}" for="txtInterventor"/>
                                    <h:inputText  id="txtInterventor" value="#{Supervisor$IngresarNuevaObra.obranueva.strinterventor}" disabled="#{Supervisor$IngresarNuevaObra.obranueva.solicitudmaestro!=null}"
                                                  maxlength="100" size="40"/>

                                    <h:outputLabel id="lblsolicitante"  value="#{var.solicitante}:" for="txtSolicitante" rendered="#{Supervisor$IngresarNuevaObra.obranueva.solicitud_obra!=null}"/>
                                    <h:panelGroup id="gpsolicitante" rendered="#{Supervisor$IngresarNuevaObra.obranueva.solicitud_obra!=null}">
                                        <h:outputText id="txtSolicitante" value="#{Supervisor$IngresarNuevaObra.solicitante.strnombrecompleto}"/>
                                    </h:panelGroup>

                                    <h:outputLabel id="lblcargo"  value="#{var.cargo}" for="txtCargo" rendered="#{Supervisor$IngresarNuevaObra.obranueva.solicitudmaestro != null || Supervisor$IngresarNuevaObra.obranueva.solicitud_obra!=null}"/>
                                    <h:panelGroup id="gpsolicitanteCargo" rendered="#{Supervisor$IngresarNuevaObra.obranueva.solicitudmaestro != null || Supervisor$IngresarNuevaObra.obranueva.solicitud_obra!=null}">
                                        <h:outputText  id="txtCargo" value="#{Supervisor$IngresarNuevaObra.solicitante.cargo.strdescripcion}"/>
                                    </h:panelGroup>

                                </h:panelGrid>
                                <h:panelGrid columns="2" id="gpentidadministerios" >
                                    <h:outputLabel id="lblruta"  value="#{var.seleccionruta}:" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio==2}" />
                                    <h:panelGroup id="pginvias" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio==2}" >
                                        <h:inputText  id="txtruta" size="25" maxlength="250" disabled="true" value="#{Supervisor$IngresarNuevaObra.obranueva.ruta.strcodigotramo} #{Supervisor$IngresarNuevaObra.obranueva.ruta.strnombretramo}" >
                                        </h:inputText>
                                        <a4j:commandButton id="btnBuscarRuta" value="#{var.asociar}" action="#{Supervisor$EntidadConvenio.llenarRuta}"  
                                                           render="mp-listado-rutas,tabla-listado-ruta" immediate="true"
                                                           oncomplete="javascript:Richfaces.showModalPanel('mp-listado-rutas')">
                                            <a4j:ajax event="oncomplete" oncomplete="javascript:Richfaces.showModalPanel('mp-listado-rutas')" render="mp-listado-rutas,tabla-listado-ruta,layoutPrincipalTab,gpTotalRuta" immediate="true"/>
                                        </a4j:commandButton>
                                        <a4j:commandButton id="btndesasociarrRuta" value="#{var.desasociar}" action="#{Supervisor$IngresarNuevaObra.desasociarRuta}" render="pginvias,layoutPrincipalTab,mp-proyectosPadres" rendered="#{Supervisor$IngresarNuevaObra.obranueva.ruta!=null}">
                                        </a4j:commandButton>
                                    </h:panelGroup>
                                    <h:outputLabel id="lbsede"  value="#{var.seleccionar} Sede:" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio==1}"/>
                                    <h:panelGroup id="gpEducacion" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio==1}">

                                        <h:inputText  id="txtsede" size="25" maxlength="250" disabled="true" value="#{Supervisor$IngresarNuevaObra.obranueva.sedeeducativa.strnombre}">
                                        </h:inputText>

                                        <h:panelGroup>
                                            <a4j:commandButton id="btnBus" value="#{var.buscar} Sede Educativa" action="#{Supervisor$EntidadConvenio.llenarlistaSedes}"
                                                               render="mp-listado-sedeseducativas,tablasedeseducativas" immediate="true"
                                                               oncomplete="javascript:Richfaces.showModalPanel('mp-listado-sedeseducativas')">
                                                <a4j:ajax event="oncomplete"   oncomplete="javascript:Richfaces.showModalPanel('mp-listado-sedeseducativas')" render="tablasedeseducativas"/>
                                            </a4j:commandButton>
                                            <a4j:commandButton id="btndesasociarrSede" value="Desasociar" action="#{Supervisor$IngresarNuevaObra.desasociarSede}" render="gpEducacion,layoutPrincipalTab,mp-proyectosPadres"
                                                               rendered="#{Supervisor$IngresarNuevaObra.obranueva.sedeeducativa!=null}" >
                                            </a4j:commandButton>
                                        </h:panelGroup>
                                    </h:panelGroup>

                                </h:panelGrid>
                                <h:panelGrid columns="1">
                                    <h:outputLabel id="lblObjetoObra"  value="#{var.objetodeobra}" />
                                    <h:inputTextarea cols="80" id="txtObjetoObra" rows="4" value="#{Supervisor$IngresarNuevaObra.obranueva.strobjetoobra}" disabled="#{Supervisor$IngresarNuevaObra.objeto}"/>
                                    <h:outputLabel id="lblLogroObra"  value="#{var.logroProyecto}" />
                                    <h:inputTextarea cols="80" id="txtLogroProyecto" rows="4" value="#{Supervisor$IngresarNuevaObra.obranueva.strlogros}"/>
                                    <h:outputLabel id="lblObseroObra"  value="#{var.observacionesProyecto}" />
                                    <h:inputTextarea cols="80" id="txtObserProyecto" rows="4" value="#{Supervisor$IngresarNuevaObra.obranueva.strconclucompro}"/>
                                </h:panelGrid>

                                <h:panelGrid id="valores" columns="3" >

                                    <h:outputText value="#{var.numbeneficiarios}:" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio!=1 and Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}"  />
                                    <h:outputText value="#{var.poblacionestudiantil}:" rendered="#{Supervisor$EntidadConvenio.intentidadconvenio==1 and Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}" />
                                    <h:outputText value="#{var.otrosactores}" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra==59}" />
                                    <rich:inputNumberSpinner id="numBeneficiarios" value="#{Supervisor$IngresarNuevaObra.obranueva.numhabbeneficiados}" minValue="0" maxValue="50000000" inputSize="20" />
                                    <rich:tooltip value="#{var.numbeneficiarios}" followMouse="true" direction="top-right" horizontalOffset="5"
                                                  verticalOffset="5" layout="block"/>

                                    <h:outputText value="#{var.numempleosdirectos}:" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}"/>
                                    <h:outputText value="#{var.institucionesfortalecidas}:" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra==59}"/>
                                    <rich:inputNumberSpinner id="numEmpleosDirectos" value="#{Supervisor$IngresarNuevaObra.obranueva.numempdirectos}" minValue="0" maxValue="50000000" inputSize="20" />
                                    <rich:tooltip value="#{var.numempleosdirectos}"  followMouse="true" direction="top-right" horizontalOffset="5"
                                                  verticalOffset="5" layout="block" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}"/>
                                    <rich:tooltip value="#{var.institucionesfortalecidas}" followMouse="true" direction="top-right" horizontalOffset="5"
                                                  verticalOffset="5" layout="block" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra==59}"/>

                                    <h:outputText value="#{var.numempleosindirectos}:" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}"/>
                                    <h:outputText value="#{var.organizacionesfortalecidas}:" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra==59}"/>
                                    <rich:inputNumberSpinner id="numEmpleosIndirectos" value="#{Supervisor$IngresarNuevaObra.obranueva.numempindirectos}" minValue="0" 
                                                             maxValue="50000000" inputSize="20" />

                                    <rich:tooltip value="#{var.numempleosindirectos}" followMouse="true" direction="top-right" horizontalOffset="5"
                                                  verticalOffset="5" layout="block" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra!=59}"/>
                                    <rich:tooltip value="#{var.organizacionesfortalecidas}" followMouse="true" direction="top-right" horizontalOffset="5"
                                                  verticalOffset="5" layout="block" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tipoobra.inttipoobra==59}"/>                                        


                                </h:panelGrid>
                                <h:panelGrid id="valores2" columns="2" rendered="#{Supervisor$IngresarNuevaObra.obranueva.contrato!=null and var.vervlrsdeclaradosentipifiobra}">
                                    <h:outputLabel id="lblnumvaldeclarado" styleClass="txt_label" value="#{var.numvaldeclarado}" >
                                    </h:outputLabel>
                                    <h:inputText value="#{Supervisor$IngresarNuevaObra.obranueva.numvaldeclarado}"
                                                 size="20"  maxlength="20"
                                                 onkeypress="return validar(event)">
                                        <f:convertNumber maxFractionDigits="2" minFractionDigits="2" type="number"  />

                                    </h:inputText>



                                    <h:outputLabel id="lblnumvalavanfisicodeclarado" styleClass="txt_label" value="#{var.numvalavanfisicodeclarado}" >
                                    </h:outputLabel>
                                    <h:panelGrid columns="2">
                                        %
                                        <h:inputText value="#{Supervisor$IngresarNuevaObra.obranueva.numvalavanfisicodeclarado}"
                                                     size="20"  maxlength="20">                                             
                                            <f:convertNumber maxFractionDigits="2" minFractionDigits="2" type="number" />
                                        </h:inputText>
                                    </h:panelGrid>


                                    <h:outputLabel id="lblnumvalavanfinancierodeclarado" styleClass="txt_label" value="#{var.numvalavanfinancierodeclarado}" >
                                    </h:outputLabel>
                                    <h:inputText value="#{Supervisor$IngresarNuevaObra.obranueva.numvalavanfinanciaerodeclarado}"
                                                 size="20"  maxlength="20"
                                                 onkeypress="return validar(event)" >
                                        <f:convertNumber maxFractionDigits="2" minFractionDigits="2" type="number"  />
                                    </h:inputText>

                                    <h:outputLabel id="lblnumvalprogramadoejecicion" styleClass="txt_label" value="#{var.numvalprogejecucion}" >
                                    </h:outputLabel>
                                    <h:inputText value="#{Supervisor$IngresarNuevaObra.obranueva.numvalprogramejec}"
                                                 size="20"  maxlength="20"
                                                 onkeypress="return validar(event)" >
                                        <f:convertNumber maxFractionDigits="2" minFractionDigits="2" type="number"  />
                                    </h:inputText>
                                </h:panelGrid>
                                <h:panelGrid id="valores3" columns="2" rendered="#{Supervisor$IngresarNuevaObra.obranueva.contrato!=null}">
                                    <h:outputLabel value="Sector:"/>
                                    <h:outputText value="#{Supervisor$IngresarNuevaObra.obranueva.contrato.tercero.sector.strnombre}"/>

                                    <h:outputLabel value="Número de Convenio:"/>
                                    <h:outputText value="#{Supervisor$IngresarNuevaObra.obranueva.contrato.strnumcontrato}"/>

                                    <h:outputLabel value="Contratista:"/>
                                    <h:outputText value="#{Supervisor$IngresarNuevaObra.obranueva.contrato.contratista.strnombre}"/>
                                </h:panelGrid>


                            </rich:collapsiblePanel>
                            <interkont:spacer height="10px" style="width:100%;"/>
                            <h:panelGroup >
                                <a4j:commandButton id="btVolverTipif"  value="#{var.volver}"
                                                   action="#{Supervisor$IngresarNuevaObra.volverTipificacion}" render="rpTipificacion" />

                                <h:commandButton value="#{var.continuar}"  action="#{Supervisor$IngresarNuevaObra.validabasicos}" />
                                <h:commandButton id="btCancelarNuevaObra"  value="#{var.cancelar}" immediate="true"
                                                 action="#{Supervisor$IngresarNuevaObra.cancelar_action}" >
                                </h:commandButton>
                                <a4j:outputPanel id="panelErrorDB">
                                    <rich:messages id="messagesDB" globalOnly="true"
                                                   styleClass="mensajes_error_background mensajes_error" ajaxRendered="true"
                                                   >
                                        <f:facet name="infoMarker">
                                            <h:graphicImage height="20px" width="20px" url="/resources/imgs/msginfo.png" />
                                        </f:facet>
                                        <f:facet name="warnMarker">
                                            <h:graphicImage height="10px" width="20px" url="/resources/imgs/msgwarn.png" />
                                        </f:facet>
                                        <f:facet name="errorMarker">
                                            <h:graphicImage height="20px" width="20px" url="/resources/imgs/msgerror.png" />
                                        </f:facet>
                                        <f:facet name="fatalMarker">
                                            <h:graphicImage  height="20px" width="20px" url="/resources/imgs/msgerror.png" />
                                        </f:facet>
                                    </rich:messages>

                                </a4j:outputPanel>
                            </h:panelGroup>

                        </rich:panel>
                    </td>
                </tr>
            </table>
        </h:form>
        <ui:include src="/modal/modallistadosedes.xhtml"/>
        <ui:include src="/modal/listadoRuta.xhtml"/>
    </ui:define>
</ui:composition>

