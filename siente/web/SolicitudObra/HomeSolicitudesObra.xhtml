<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/facelets/template_main.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:a4j="http://richfaces.org/a4j" 
                xmlns:interkont="http://www.interkont.com/jsf"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:ui="http://java.sun.com/jsf/facelets">


    <ui:define name="head">
        <title>Inicio Solicitudes de Obra</title>
        <h:outputScript namme="script_supervisor.js"/>
    </ui:define>
    <ui:define name="title">
        <h:outputText value="#{var.encontrarsolobra}"/>
    </ui:define>
    <ui:define name="menu">
        <ui:include src="/facelets/menu_soliobra.xhtml"/>
    </ui:define>
    <ui:define name="menu_lateral">
        <ui:include src="/facelets/menu_lateral_soliobra.xhtml"/>
    </ui:define>
    <ui:define name="body">
        <h:form>
            <table style="width:100%;" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td><div class="buscador"><div id="buscador_space">
                                <label>
                                    <h:inputText id="txtPalabraClave" styleClass="buscador_field" onfocus="clearText(this)" onblur="clearText(this)"
                                                 value="#{SolicitudObra$GestionarSolicitudObra.filtro.palabraclave}"/>
                                    <h:commandButton type="button" action="#{SolicitudObra$GestionarSolicitudObra.buscar}"
                                                     id="filtrar"  value="#{var.buscar}" styleClass="buscador_button"/>
                                </label>
                            </div></div>
                    </td>
                    <td><a4j:commandLink styleClass="busquedavanzada anchorLink" type="submit" render="panelFiltroObra" value="#{var.houtbusquedaavanza}"
                                         oncomplete="#{rich:component('panelFiltroObra')}.show();" 
                                         action="#{SolicitudObra$GestionarSolicitudObra.iniciarfiltro}"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <blink>
                            <h:outputText rendered="#{SolicitudObra$GestionarSolicitudObra.resulbusqueda}" value="#{SessionBeanCobra.solicitudService.mensaje}" />
                        </blink>
                    </td>
                </tr>
            </table>
            <rich:panel id="mp-proyectosPadres">
                <h:panelGrid columns="1" style="width:100%;">

                    <interkont:spacer height="20"/>
                    <rich:dataTable rendered="#{!SessionBeanCobra.solicitudService.tablasver}"
                                    id="tablaSolicitudObraTemp"
                                    rows="5"
                                    var ="currentRowTemp"
                                    rowKeyVar="filaSeleccionada"
                                    onrowmouseout="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
                                    onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                                    sortMode="single"
                                    value="#{SessionBeanCobra.solicitudService.solicitudObrachTemps}"
                                    render="scrolltablaSolicitudObraTemp"
                                    style="text-align:center;width:100%;">
                        <f:facet name="header">
                            <rich:columnGroup>
                                <rich:column colspan="10">
                                    <h:outputText value="#{var.totalsolicitues} #{SolicitudObra$GestionarSolicitudObra.totalfilas} #{var.paginaCiu} #{SolicitudObra$GestionarSolicitudObra.pagina} #{var.deCiu} #{SolicitudObra$GestionarSolicitudObra.totalpaginas}" />
                                </rich:column>

                                <rich:column breakRowBefore="true">
                                    <h:outputText value="#{var.codigoSolicitud}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.NOMBRE}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.valorSolicitado}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.departamento}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.municipio}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.estadoSolicitud}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.tipoSolicitud}"/>
                                </rich:column>
                                <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 5}">
                                    <h:outputText value="#{var.consultar}"/>
                                </rich:column>
                                <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 5 ||
                                                         SolicitudObra$GestionarSolicitudObra.valuegrupo == 6 ||
                                                         SolicitudObra$GestionarSolicitudObra.valuegrupo == 7}">
                                    <h:outputText value="#{var.editar}"/>
                                </rich:column>
                                <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 7}">
                                    <h:outputText value="#{var.eliminar}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.consultar} #{var.proyectos}"/>
                                </rich:column>
                            </rich:columnGroup>
                        </f:facet>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.strconsecutivo}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.strnombresolicitud}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.doublevalorsolicitado}">
                                <f:convertNumber pattern="$ ###,###"/>
                            </h:outputText>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.localidad.strdepartamento}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.localidad.strmunicipio}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.estadosolicitudch.strnombreestadosolicitud}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowTemp.tiposolicitudobra.strdescripcion}"/>
                        </rich:column>
                        <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 5}">
                            <a4j:commandButton  title="#{var.buscarProyecto}"
                                                action="#{SolicitudObra$GestionarSolicitudObra.consultarSolicitud(filaSeleccionada)}"
                                                styleClass="busquedavanzada" value="#{var.consultar}"/>
                        </rich:column>
                        <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 6||
                                                 SolicitudObra$GestionarSolicitudObra.valuegrupo == 5}">
                            <a4j:commandButton  action="#{SolicitudObra$GestionarSolicitudObra.editarSolicitud(filaSeleccionada)}"
                                                rendered="#{currentRowTemp.estadosolicitudch.oidestadosolicitud != 1}"
                                                styleClass="editaravanzada" />
                        </rich:column>
                        <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 7}">
                            <a4j:commandButton  title="#{var.aprobar}"
                                                action="#{SolicitudObra$GestionarSolicitudObra.consultarSolicitud(filaSeleccionada)}"
                                                rendered="#{currentRowTemp.estadosolicitudch.oidestadosolicitud == 1 and
                                                            currentRowTemp.boolaprobado != false}"
                                                styleClass="editaravanzada" />
                        </rich:column>
                        <rich:column rendered="#{SolicitudObra$GestionarSolicitudObra.valuegrupo == 7}">
                            <a4j:commandButton  title="#{var.modificarobra}"
                                                rendered="#{currentRowTemp.boolnuevo}"
                                                action="#{SolicitudObra$GestionarSolicitudObra.eliminarsolicitud(filaSeleccionada)}"
                                                oncomplete="#{rich:component('panelEliminarSolicitud')}.show();"
                                                styleClass="eliminaravanzada"/>
                        </rich:column>
                        <rich:column>
                            <a4j:commandLink  title="#{var.consultar} #{var.solicitudproyecto}" style="font-size:11px;"
                                              action="#{SolicitudObra$GestionarSolicitudObra.llenarProyectosxSolicitudTemp(filaSeleccionada)}"
                                              render="modaltablaproyectos, tablaproyectos"
                                              rendered="#{currentRowTemp.boolaprobado}">
                                <h:graphicImage style="border:0px;border-style:none" value="/resources/imgs/bt_consultar.png"/>
                                <a4j:ajax event="complete" oncomplete="#{rich:component('modaltablaproyectos')}.show();" />
                            </a4j:commandLink>
                        </rich:column>
                        <f:facet name="footer">
                            <h:panelGroup>
                                <center>
                                    <h:panelGrid columns="4">
                                        <a4j:commandButton value="#{var.primeroCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.veranteriorreales}" render="tablaSolicitudObraTemp" action="#{SolicitudObra$GestionarSolicitudObra.primerosreales}"/>
                                        <a4j:commandButton value="#{var.anteriorCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.veranteriorreales}" render="tablaSolicitudObraTemp" action="#{SolicitudObra$GestionarSolicitudObra.anterioresReales}"/>
                                        <a4j:commandButton value="#{var.siguienteCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.verultimosreales}" render="tablaSolicitudObraTemp" action="#{SolicitudObra$GestionarSolicitudObra.siguientesReales}"/>
                                        <a4j:commandButton value="#{var.ultimoCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.verultimosreales}" render="tablaSolicitudObraTemp" action="#{SolicitudObra$GestionarSolicitudObra.ultimoReales}"/>
                                    </h:panelGrid>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </rich:dataTable>

                    <rich:dataTable
                        rendered="#{SessionBeanCobra.solicitudService.tablasver}"
                        id="tablaSolicitudObra"
                        rows="5"
                        var ="currentRowObra"
                        rowKeyVar="filaSeleccionada"
                        onrowmouseout="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
                        onrowmouseover="this.style.backgroundColor='#B4DDEC'"
                        sortMode="single"
                        value="#{SessionBeanCobra.solicitudService.solicitudObrachs}"
                        render="scrolltablaSolicitudObra"
                        style="text-align:center;width:100%;">
                        <f:facet name="header">
                            <rich:columnGroup>
                                <rich:column colspan="10">
                                    <h:outputText value="#{var.solicitudesapro} #{SolicitudObra$GestionarSolicitudObra.totalfilasobra} #{var.paginaCiu} #{SolicitudObra$GestionarSolicitudObra.paginaobra} #{var.deCiu} #{SolicitudObra$GestionarSolicitudObra.totalpaginasobra}" />
                                </rich:column>
                                <rich:column breakRowBefore="true">
                                    <h:outputText value="#{var.codigoSolicitud}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.NOMBRE}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.valorSolicitado}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.departamento}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.municipio}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.estadoSolicitud}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.tipoSolicitud}"/>
                                </rich:column>
                                <!--
                                <rich:column>
                                    <h:outputText value="#{var.consultar}"/>
                                </rich:column>                                        
                                -->
                                <rich:column>
                                    <h:outputText value="#{var.asociarproyecto}"/>
                                </rich:column>
                                <rich:column>
                                    <h:outputText value="#{var.consultar} Proyecto"/>
                                </rich:column>
                            </rich:columnGroup>
                        </f:facet>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.strconsecutivo}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.strnombresolicitud}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.doublevalorsolicitado}">
                                <f:convertNumber pattern="$ ###,###"/>
                            </h:outputText>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.localidad.strdepartamento}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.localidad.strmunicipio}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.estadosolicitudch.strnombreestadosolicitud}"/>
                        </rich:column>
                        <rich:column>
                            <h:outputText value="#{currentRowObra.tiposolicitudobra.strdescripcion}"/>
                        </rich:column>
                        <!--
                        <rich:column>
                            <a4j:commandLink  title="#{var.buscarProyecto}" style="font-size:11px;"
                                              action="#{SolicitudObra$GestionarSolicitudObra.consultarSolicitudDirector(filaSeleccionada)}" >
                                <h:graphicImage style="border:0px;border-style:none" value="/resources/imgs/bt_ver.png"/>
                            </a4j:commandLink>
                        </rich:column>
                        -->
                        <rich:column>
                            <a4j:commandLink  title="#{var.asociarproyecto}" style="font-size:11px;"
                                              action="#{SolicitudObra$GestionarSolicitudObra.asociarProyectoaSolicitud(filaSeleccionada)}">
                                <h:graphicImage style="border:0px;border-style:none" value="/resources/imgs/bt_contrato.png"/>
                            </a4j:commandLink>
                        </rich:column>
                        <rich:column>
                            <a4j:commandLink  title="#{var.consultar} #{var.solicitudproyecto}" style="font-size:11px;"
                                              action="#{SolicitudObra$GestionarSolicitudObra.llenarProyectosxSolicitud(filaSeleccionada)}"
                                              render="modaltablaproyectos, tablaproyectos" >
                                <h:graphicImage style="border:0px;border-style:none" value="/resources/imgs/bt_consultar.png"/>
                                <a4j:ajax event="complete" oncomplete="#{rich:component('modaltablaproyectos')}.show()" />
                            </a4j:commandLink>
                        </rich:column>
                        <f:facet name="footer">
                            <h:panelGroup>
                                <center>
                                    <h:panelGrid columns="4">
                                        <a4j:commandButton value="#{var.primeroCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.veranteriorrealesobra}" render="tablaSolicitudObra" action="#{SolicitudObra$GestionarSolicitudObra.primerosrealesobras}"/>
                                        <a4j:commandButton value="#{var.anteriorCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.veranteriorrealesobra}" render="tablaSolicitudObra" action="#{SolicitudObra$GestionarSolicitudObra.anterioresRealesobras}"/>
                                        <a4j:commandButton value="#{var.siguienteCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.verultimosrealesobra}" render="tablaSolicitudObra" action="#{SolicitudObra$GestionarSolicitudObra.siguientesRealesobras}"/>
                                        <a4j:commandButton value="#{var.ultimoCiu}" disabled="#{!SolicitudObra$GestionarSolicitudObra.verultimosrealesobra}" render="tablaSolicitudObra" action="#{SolicitudObra$GestionarSolicitudObra.ultimoRealesobras}"/>
                                    </h:panelGrid>
                                </center>
                            </h:panelGroup>
                        </f:facet>
                    </rich:dataTable>

                </h:panelGrid>
            </rich:panel>
        </h:form>
        <ui:include src="/modal/modalsolicitudobra/busquedaavanzada.jspx"/>
        <ui:include src="/modal/modalsolicitudobra/eliminarsolicitud.jspx"/>
        <ui:include src="/modal/modalverProyectosAso.jspx"/>
    </ui:define>
</ui:composition>
