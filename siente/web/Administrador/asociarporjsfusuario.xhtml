<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition  xmlns="http://www.w3.org/1999/xhtml"
                 xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
                 xmlns:f="http://java.sun.com/jsf/core"
                 xmlns:h="http://java.sun.com/jsf/html"
                 xmlns:rich="http://richfaces.org/rich"
                 xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                 xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:form >
        <h:panelGroup layout="block" id="pgasociarObrasUsuario"  >
            <h:panelGrid columns="2" >
                <h:outputLabel  styleClass="ikont-outtext-subtitulo"    id="lblEntidadusuario"  value="#{var.entidad}: "/>
                <h:selectOneMenu  id="comboEntidadNuevoUsuario" style="position: relative;left: 163px;" value="#{Perfil$Usuario.entidadproyecto.intcodigo}">
                    <f:selectItems  value="#{Perfil$Usuario.entidadcreacionusuario}" />
                    <a4j:ajax   event="valueChange"  execute="@this,combodepartamentoproyecto,tableasociarproyecto,asociarproyecto,ikont-panel-proyecto"
                                listener="#{Perfil$Usuario.cargarObras}"  render="comboEntidadNuevoUsuario,tableasociarproyecto,ikont-panel-proyecto,pgasociarObrasUsuario"/>
                </h:selectOneMenu>
            </h:panelGrid>
            <h:panelGroup rendered="#{Perfil$Usuario.listaobrasasociar.size()==0}">
                <h:outputText value=" La Entidad no tiene proyectos"/>
            </h:panelGroup>
            <h:panelGroup rendered="#{Perfil$Usuario.listaobrasasociar.size()>0}" id="ikont-panel-proyecto" >
                <h:panelGrid style="width: 100%;" id="panelcontenidoproyecto" columns="3">
                    <h:panelGroup>
                        <h:panelGrid>
                            <a4j:commandButton value="#{var.Buscar} #{var.obra}"/>
                        </h:panelGrid>
                        <rich:dataTable  style="border-collapse: inherit!important;"  binding="#{Perfil$Usuario.datatablelistaobras}"
                                         rows="8" var="varproyecto"  value="#{Perfil$Usuario.listaobrasasociar}" id="tableasociarproyecto">
                            <rich:column>
                                <f:facet name="header">
                                    <h:outputLabel value="#{var.seleccionar}"/>
                                </f:facet>
                                <h:selectBooleanCheckbox value="#{Perfil$Usuario.listaproyectosbooleana[varproyecto]}"
                                                         immediate="true" valueChangeListener="#{Perfil$Usuario.seleccionarUnProyecto}">
                                    <f:ajax event="click" render="@form"/>

                                </h:selectBooleanCheckbox>
                            </rich:column>

                            <rich:column>
                                <f:facet name="header">
                                    <h:outputText value="#{var.codigo} #{var.obra}"/>
                                </f:facet>
                                <h:outputText value="#{varproyecto.intcodigoobra}"/>
                            </rich:column>
                            <rich:column>
                                <f:facet name="header">
                                    <h:outputText value="#{var.nombreobra}"/>
                                </f:facet>
                                <h:outputText value="#{varproyecto.strnombrecrot}"/>
                            </rich:column>
                        </rich:dataTable>
                        <rich:dataScroller rendered="#{Perfil$Usuario.listaobrasasociar.size()>10}" for="tableasociarproyecto" maxPages="5" />
                    </h:panelGroup>
                    <rich:column>
                        <center>
                            <a4j:commandButton rendered="#{Perfil$Usuario.listaproyectosbooleana.size()>0}" immediate="true" execute="repeatproyectosselecionados,idbuscarproyecto,pgasociarObrasUsuario" render="repeatproyectosselecionados,asociarproyecto,idbuscarproyecto,pgasociarObrasUsuario" actionListener="#{Perfil$Usuario.listarProyectosSeleccionadas}" value="#{var.listar} #{var.obra} #{var.seleccion}"/>
                            <br/>
                            <br/>
                            <a4j:commandButton rendered="#{Perfil$Usuario.listaproyecto.size()>0}" immediate="true" execute="repeatproyectosselecionados,idbuscarproyecto" render="repeatproyectosselecionados,asociarproyecto,pgasociarObrasUsuario" actionListener="#{Perfil$Usuario.limpiarSeleccionproyecto}" value="#{var.cancelar}"/>
                        </center>
                    </rich:column>

                    <h:panelGroup rendered="#{Perfil$Usuario.inhabilitarseleccionproyecto and Perfil$Usuario.listaproyecto.size()>0}" >
                            <rich:dataTable  style="border-collapse: inherit!important;width:422px;bottom: -49px;position: relative;"
                                             rows="5" var="varproyecto"  value="#{Perfil$Usuario.listaproyecto}" id="repeatproyectosselecionados">
                                <rich:column>
                                    <h:selectBooleanCheckbox value="#{Perfil$Usuario.listaproyectosbooleana[varproyecto]}"
                                                             immediate="true" valueChangeListener="#{Perfil$Usuario.seleccionarUnProyecto}">
                                        <f:ajax event="click" render="@form"/>
                                    </h:selectBooleanCheckbox>
                                </rich:column>
                                <rich:column>
                                    <f:facet name="header">
                                        <h:outputText value="#{var.nombreobra}"/>
                                    </f:facet>
                                    <h:outputText value="#{varproyecto.strnombrecrot}"/>
                                </rich:column>
                            </rich:dataTable>
                            <rich:dataScroller rendered="#{Perfil$Usuario.listaobrasasociar.size()> 4}" for="repeatproyectosselecionados" maxPages="5" />
                        </h:panelGroup>
                    </h:panelGrid>
            </h:panelGroup>
        </h:panelGroup>
    </h:form>
</ui:composition>
