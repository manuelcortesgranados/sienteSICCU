<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition    xmlns="http://www.w3.org/1999/xhtml"
                   xmlns:ui="http://java.sun.com/jsf/facelets"
                   template="./../facelets/template_main.xhtml"
                   xmlns:a4j="http://richfaces.org/a4j"
                   xmlns:interkont="http://www.interkont.com/jsf"
                   xmlns:f="http://java.sun.com/jsf/core"
                   xmlns:h="http://java.sun.com/jsf/html"
                   xmlns:rich="http://richfaces.org/rich"
                   xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                   xmlns:m="http://code.google.com/p/gmaps4jsf/"  
                   >
    <ui:define name="head">
        <link href="/#{var.versioncobra}/resources/css/style.css" rel="stylesheet" type="text/css" />
        <link href="/#{var.versioncobra}/resources/css/main.css" rel="stylesheet" type="text/css" />

        <script src="/#{var.versioncobra}/resources/amcharts/amcharts.js" type="text/javascript"></script>
        <script src="/#{var.versioncobra}/resources/amcharts/gauge.js" type="text/javascript"></script>
        <script type="text/javascript">
            localStorage.setItem('accionDetalleProyecto', "ikont-img-posicion-menu-proyecto ikont-posicion-detalle-proyecto");
        </script>
        <ui:include src="/includes/google_maps_key.xhtml" />   
    </ui:define>

    <ui:define name="title">
        <h:outputText styleClass="ikont-hot-houtdetalle" rendered="#{!var.nuevomapa}" value="#{var.houtdetalle}" />
        <h:outputText styleClass="ikont-hot-intcodobra" rendered="#{!var.nuevomapa}" value="(#{Supervisor$AdministrarObraNew.obra.intcodigoobra})" />
        <h:outputText styleClass="ikont-hot-strnombremedio" rendered="#{!var.nuevomapa}" value="#{Supervisor$AdministrarObraNew.obra.strnombremedio}" />
    </ui:define>

    <ui:define name="menu">
        <ui:include src="/facelets/menu_gestion.xhtml" />
    </ui:define>

    <ui:define name="menu_lateral">
        <h:panelGroup  rendered="#{!var.permisonuevodiseno}">
            <ui:include src="./../facelets/menu_lateral_gestion.xhtml" />
            <ui:include src="./../facelets/menu_lateral_administrar.xhtml" />  
        </h:panelGroup>
        <h:panelGroup rendered="#{var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_lateral_novedades_zoom.xhtml" />
        </h:panelGroup>
    </ui:define>

    <ui:define name="menusuperior">
        <h:panelGroup rendered="#{SessionBeanCobra.cobraService.ciu and !var.permisonuevodiseno}">
            <ui:include src="/facelets/menu_superior_detalle_ciudadano.xhtml" />
        </h:panelGroup>
        <ui:include rendered="#{var.permisonuevodiseno}" src="/facelets/menu_superior_administrar_proyecto.xhtml" />
    </ui:define>

    <ui:define name="body">
        <h:body>
            <h:form prependId="false">               

                <h:inputHidden id="finfecha" value="#{Supervisor$DetalleObra.finentrega}" />
            </h:form>

            <h:panelGroup rendered="#{var.nuevomapa}" layout="block" styleClass="ikont-hpg-zoom-detalleobra">                
                <interkont:spacer height="10" />
                <h:panelGrid  id="gpPrincipalInfCiudad-zoom" styleClass="totalwidth">
                    <h:form prependId="false">
                        <h:panelGroup layout="block">
                            <center>
                                <br/>
                                <h:graphicImage    url="../resources/imgs/proyecto/gota.png"/>           
                                <br/>
                                <h:outputText styleClass="ikont-hot-zoom-strnombremedio" value="#{Supervisor$AdministrarObraNew.obra.strnombremedio}" />
                                <br/><br/>
                                <h:outputLabel styleClass="ikont-hol-strDireccionProyectoOut" value="#{Supervisor$AdministrarObraNew.obra.strnumcuenta}" />
                                <h:panelGroup rendered="#{SessionBeanCobra.usuarioObra.renderrecurso.btn_seguirproyecto}">
                                    <br/><br/>
                                    <h:commandButton  styleClass="ikont-hcb-seguirspry" value="#{var.seguirproyectociu}" rendered="#{!Supervisor$DetalleObra.seguidorporobra}" action="#{Supervisor$DetalleObra.registrarSeguirobra}">
                                    </h:commandButton>
                                    <h:commandButton  styleClass="ikont-hcb-sinseguirpry" value="#{var.dejardeseguirproyecto}" rendered="#{Supervisor$DetalleObra.seguidorporobra}" action="#{Supervisor$DetalleObra.eliminarSeguirobra}">
                                    </h:commandButton>
                                </h:panelGroup>
                                <br/><br/>
                                <h:panelGrid cellspacing="10" columns="2">
                                    <h:panelGrid columns="2" cellspacing="5">
                                        <h:commandLink styleClass="ikont-hcl-imgpontencialener img-detalle-proyecto" />   
                                        <h:panelGrid columns="1">
                                            <h:outputLabel value="Potencial Energetico" styleClass="font-general"></h:outputLabel>
                                            <h:outputLabel value="Informe" styleClass="font-general"></h:outputLabel>
                                            <h:outputLink value="" styleClass="ikont-hol-descargapoener">Descargar</h:outputLink>
                                        </h:panelGrid>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2" cellspacing="5">
                                        <h:commandLink styleClass="ikont-hcl-imgidatosgenerales img-detalle-proyecto" />    
                                        <h:panelGroup layout="block">
                                            <h:outputLabel value="# de habitantes :  " styleClass="font-general"></h:outputLabel>
                                            <h:outputText value="645454"></h:outputText>
                                            <br/>
                                            <h:outputLabel value="# de encuestados :  " styleClass="font-general"></h:outputLabel>
                                            <h:outputText value="456456"></h:outputText>
                                        </h:panelGroup>
                                    </h:panelGrid>
                                </h:panelGrid>
                            </center>
                        </h:panelGroup>
                        <rich:collapsiblePanel switchType="client" header="Datos Básicos" expanded="true">
                            <h:panelGrid columns="3" styleClass="totalwidth">
                                <h:panelGroup layout="block">
                                    <h:panelGrid columns="2">
                                        <h:graphicImage   styleClass="ikont-hgi-strfoto ikont-img-perfil-usuario" url="../resources/imgs/bt_user.png"/>           
                                        <h:panelGrid>
                                            <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strcontratista}"  styleClass="font-general ikont-hol-nombreusuario"></h:outputLabel>
                                            <h:outputLabel value="Alcalde"  styleClass="font-general"></h:outputLabel>
                                        </h:panelGrid>
                                    </h:panelGrid>
                                </h:panelGroup>                                
                                <h:panelGrid columns="1" >
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="Dirección:" styleClass="font-general"></h:outputLabel>
                                        <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strdireccion}" styleClass="font-general"></h:outputLabel>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="Sitio web:" styleClass="font-general"></h:outputLabel>
                                        <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strestydis}" styleClass="font-general"></h:outputLabel>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="Mail:" styleClass="font-general"></h:outputLabel>
                                        <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strlogros}" styleClass="font-general"></h:outputLabel>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="Actividad Económica:" styleClass="font-general"></h:outputLabel>
                                        <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strcomuna}" styleClass="font-general"></h:outputLabel>
                                    </h:panelGrid>
                                    <h:panelGrid columns="2">
                                        <h:outputLabel value="Temperatura:" styleClass="font-general"></h:outputLabel>
                                        <h:outputLabel value="#{Supervisor$AdministrarObraNew.obra.strcorregimiento} °C" styleClass="font-general"></h:outputLabel>
                                    </h:panelGrid>

                                </h:panelGrid>
                                <h:panelGrid columns="1" columnClasses="panelcenter">
                                    <h:panelGroup>
                                        <div id="chartdiv" style="width: 250px; height: 200px;"></div>
                                        <script type="text/javascript">
                                            var chart;
                                            var arrow;
                                            var axisKM;
                                            var axisMiles;

                                            AmCharts.ready(function() {

                                                // create angular gauge
                                                chart = new AmCharts.AmAngularGauge();

                                                // kilometers axis
                                                axisKM = new AmCharts.GaugeAxis();
                                                axisKM.startValue = 0;
                                                axisKM.endValue = 240;
                                                axisKM.radius = "100%";
                                                axisKM.inside = false;
                                                axisKM.gridInside = false;
                                                axisKM.axisColor = "#2EC1DB";
                                                axisKM.tickColor = "#2EC1DB";
                                                axisKM.axisThickness = 3;
                                                chart.addAxis(axisKM);

                                                // miles axis
                                                axisMiles = new AmCharts.GaugeAxis();
                                                axisMiles.startValue = 0;
                                                axisMiles.endValue = 160;
                                                axisMiles.radius = "80%";
                                                axisMiles.axisColor = "#00B3DF";
                                                axisMiles.tickColor = "#00B3DF";
                                                axisMiles.axisThickness = 3;
                                                chart.addAxis(axisMiles);

                                                // arrow
                                                arrow = new AmCharts.GaugeArrow();
                                                arrow.radius = "85%";
                                                arrow.color = "#00B3DF";
                                                arrow.innerRadius = 50;
                                                arrow.nailRadius = 0;
                                                chart.addArrow(arrow);

                                                chart.write("chartdiv");
                                                // update value every 2 seconds
                                                randomValue();
                                            });

                                            function randomValue() {
                                                var value = Math.round(Math.random() * 240);
                                                arrow.setValue(value);
                                            }
                                        </script>
                                    </h:panelGroup>
                                    <h:panelGrid columns="1" styleClass="totalwidth panelcenter" columnClasses="panelcenter,panelcenter">
                                        <h:outputLabel styleClass="font-general">Potencial Energetico</h:outputLabel>
                                        <h:outputLabel >35 W</h:outputLabel>
                                    </h:panelGrid>
                                </h:panelGrid>

                            </h:panelGrid>
                        </rich:collapsiblePanel>

                        <rich:collapsiblePanel switchType="client" header="Datos Relevantes" expanded="true">
                            <h:panelGrid columns="4" class="ikont-hpg-datosrelevantes totalwidth" columnClasses="verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop,verticalalingtop">
                                <h:panelGrid styleClass="ikont-hpg-griddetaob">
                                    <h:commandLink styleClass="ikont-hcl-imgduracion img-detalle-proyecto" />
                                    <h:outputLabel styleClass="font-general">NBI</h:outputLabel>
                                </h:panelGrid>
                                <h:panelGrid styleClass="ikont-hpg-pg_impactosocial">
                                    <h:commandLink styleClass="ikont-hcl-imgimpactosocial img-detalle-proyecto" />
                                    <h:outputLabel styleClass="font-general">NECESIDADES ENERGÉTICAS</h:outputLabel>
                                </h:panelGrid>
                                <h:panelGrid  styleClass="ikont-hgi-imgestobra">
                                    <h:commandLink styleClass="ikont-hcl-imgestadoproyecto img-detalle-proyecto estado#{Supervisor$AdministrarObraNew.obra.tipoestadobra.intestadoobra}" />
                                    <h:outputLabel styleClass="font-general">N. DE HABITANTES</h:outputLabel>
                                </h:panelGrid>
                                <h:panelGrid styleClass="ikont-hpg-tipo_obra">
                                    <h:commandLink styleClass="ikont-hcl-imgtipoproyecto img-detalle-proyecto tipo#{Supervisor$AdministrarObraNew.obra.tipoobra.tipoproyecto.intidtipoproyecto} " />
                                    <h:outputLabel styleClass="font-general">N. DE ENCUESTAS</h:outputLabel>
                                </h:panelGrid>
                                <h:panelGrid styleClass="ikont-hpg-griddetaob">
                                    <interkont:spacer height="15" />
                                    <h:outputText styleClass="ikont-hot-intplazoo" value="#{Supervisor$AdministrarObraNew.obra.intplazoobra} #{var.diasciu}"></h:outputText>

                                    <h:panelGrid columns="2" styleClass="panelcenter">
                                        <h:outputLabel styleClass="ikont-hot-desde" value="Desde:"></h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-fecinob" value="#{Supervisor$AdministrarObraNew.obra.datefeciniobra}">
                                            <f:convertDateTime pattern="#{var.formatofecha}" />
                                        </h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-hasta" value="Hasta:" ></h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-fecfiob" value="#{Supervisor$AdministrarObraNew.obra.datefecfinobra}">
                                            <f:convertDateTime pattern="#{var.formatofecha}" />
                                        </h:outputLabel>
                                    </h:panelGrid>

                                </h:panelGrid>    
                                <h:panelGrid styleClass="ikont-hpg-griddetaob">
                                    <interkont:spacer height="15" />
                                    <h:outputText styleClass="ikont-hot-intplazoo" value="#{Supervisor$AdministrarObraNew.obra.intplazoobra} #{var.diasciu}"></h:outputText>

                                    <h:panelGrid columns="2" styleClass="panelcenter">
                                        <h:outputLabel styleClass="ikont-hot-desde" value="Desde:"></h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-fecinob" value="#{Supervisor$AdministrarObraNew.obra.datefeciniobra}">
                                            <f:convertDateTime pattern="#{var.formatofecha}" />
                                        </h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-hasta" value="Hasta:" ></h:outputLabel>
                                        <h:outputLabel styleClass="ikont-hot-fecfiob" value="#{Supervisor$AdministrarObraNew.obra.datefecfinobra}">
                                            <f:convertDateTime pattern="#{var.formatofecha}" />
                                        </h:outputLabel>
                                    </h:panelGrid>

                                </h:panelGrid>    
                                <h:panelGrid styleClass="ikont-hpg-griddetaob" columns="1">
                                    <h:outputText styleClass="ikont-hot-intplazoo" value="5424541"></h:outputText>
                                    <h:outputLabel styleClass="ikont-hot-desde" value="Población de la localidad"></h:outputLabel>
                                </h:panelGrid>    
                                <h:panelGrid styleClass="ikont-hpg-griddetaob" columns="1">
                                    <h:outputText styleClass="ikont-hot-intplazoo" value="5424541"></h:outputText>
                                    <h:outputLabel styleClass="ikont-hot-desde" value="Población de la localidad"></h:outputLabel>
                                </h:panelGrid>    
                            </h:panelGrid>
                        </rich:collapsiblePanel>

                        <rich:collapsiblePanel id="rcp-mapa-detalle-obra" switchType="client" immediate="true" onswitch="true" header="Dónde está ubicada la localidad" expanded="true" >                         
                            <h:panelGroup layout="block" styleClass="ikont-hpg">
                                <h:panelGrid columns="2" columnClasses="verticalalingtop" styleClass="panelcenter">
                                    <h:panelGrid  columnClasses="textalingright,textalingright" columns="1" styleClass="ikont-hpg-datosrelevantes">
                                        <h:panelGroup>
                                            <h:outputLabel styleClass="font-general" value="Longitud : " />
                                            <h:outputLabel styleClass="font-general" value="#{Supervisor$AdministrarObraNew.obra.floatlongitud}" />    
                                        </h:panelGroup>
                                        <br/>
                                        <h:panelGroup>
                                            <h:outputLabel styleClass="font-general" value="Latidtud : " />
                                            <h:outputLabel styleClass="font-general" value="#{Supervisor$AdministrarObraNew.obra.floatlatitud}" />
                                        </h:panelGroup>
                                        <br/>
                                        <h:panelGroup>
                                            <h:outputLabel styleClass="font-general" value="Dirección : " />
                                            <h:outputLabel styleClass="font-general" value="#{Supervisor$AdministrarObraNew.obra.strdireccion}" />
                                        </h:panelGroup>
                                        <br/>
                                        <h:panelGroup rendered="false">
                                            <h:outputLabel styleClass="font-general" value="Clima : " />
                                            <h:outputLabel styleClass="font-general" value="" />    
                                        </h:panelGroup>
                                    </h:panelGrid>
                                    <h:panelGrid id="vistaMapa" styleClass="totalwidth">
                                        <m:map  latitude="#{Supervisor$AdministrarObraNew.obra.floatlatitud}" longitude="#{Supervisor$AdministrarObraNew.obra.floatlongitud}" enableScrollWheelZoom="true"  id="map12" 
                                                jsVariable="mapa" zoom="#{var.zoommapa}"  partiallyTriggered="false"  height="200px" width="600px">                                                                 
                                            <m:marker latitude="#{Supervisor$AdministrarObraNew.obra.floatlatitud}"
                                                      longitude="#{Supervisor$AdministrarObraNew.obra.floatlongitud}"
                                       
                                                      jsVariable="#{HomeGestion.marcador.jsVariable}"
                                                      draggable="false" >
                                                <m:icon imageURL="/#{var.versioncobra}#{Supervisor$AdministrarObraNew.obra.obtenerPin()}" width="20" height="34" shadowHeight="25"  shadowWidth="40"/>

                                            </m:marker>
                                        </m:map>
                                    </h:panelGrid> 
                                </h:panelGrid> 
                            </h:panelGroup>
                        </rich:collapsiblePanel>
                        
                    </h:form>
                </h:panelGrid>
            </h:panelGroup>

            <!--El orden de estos scripst se deben consevar para el buen funcionamiento-->
            <script src="/#{var.versioncobra}/resources/script_supervisor.js" type="text/javascript"></script>

        </h:body>

    </ui:define>
</ui:composition>
