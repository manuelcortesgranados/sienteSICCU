<?xml version="1.0" encoding="UTF-8"?>

<f:view xmlns="http://www.w3.org/1999/xhtml"
        xmlns:a4j="http://richfaces.org/a4j" xmlns:interkont="http://www.interkont.com/jsf"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:rich="http://richfaces.org/rich"
        xmlns:ui="http://java.sun.com/jsf/facelets">


    <rich:popupPanel id="mp-listado-contratos" moveable="true"  width="800" height="400" headerClass="rich-panel-header" autosized="true">
        <f:facet name="header" >
            <h:panelGroup >
                <h:outputText value="#{var.listarcontratos}" styleClass="txt_header" />
            </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:form>
                <h:panelGroup>
                    <a4j:commandButton id="esconder-mp-listado-contratos" onclick="javascript:Richfaces.hideModalPanel('mp-listado-contratos')" immediate="true"
                                       styleClass="btn_cerrar"  />
                    <rich:componentControl attachTo="esconder-mp-listado-contratos" event="onclick" for="mp-listado-contratos" operation="hide"/>
                </h:panelGroup>
            </h:form>
        </f:facet>
        <center>
            <h:form execute="@this">
                <h:panelGroup id="gpTotalCont">
                    <h:panelGrid columns="2" >
                        <h:outputText value="#{var.buscar} " style="font-size:12px"/>
                        <h:panelGroup>
                            <h:inputText value="#{Supervisor$IngresarNuevaObra.filtrocontrato.palabraClave}" size="20"/>
                            <a4j:commandButton value="#{var.buscar}" action="#{Supervisor$IngresarNuevaObra.buscarContrato}" render="tablacontratos,gpTotalCont"/>

                        </h:panelGroup>
                        
                    </h:panelGrid>

                    <rich:panel >
                        <h:panelGrid style="width:100%;">
                            <h:outputText value="Debe diligenciar el campo Entidad Contratante" style="color: red" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tercero.intcodigo==0}"/>
                            <interkont:spacer height="5" style="width:100%;"/>

                            <rich:dataTable id="tablacontratos" rendered="#{Supervisor$IngresarNuevaObra.obranueva.tercero.intcodigo!=0}"
                                            rows="5"
                                            var="currentRow"
                                            binding="#{Supervisor$IngresarNuevaObra.tablacontratos}"
                                            onRowMouseOver="this.style.backgroundColor='#B4DDEC'"
                                            sortMode="single"
                                            value="#{Supervisor$IngresarNuevaObra.listacontratos}"
                                            width="800px"
                                            style="text-align:left;">
                                <f:facet name="header">
                                    <rich:columnGroup>
                                        <rich:column colspan="7">
                                            <h:outputText value="#{var.contratos} #{Supervisor$IngresarNuevaObra.totalfilas} #{var.paginaCiu} #{Supervisor$IngresarNuevaObra.pagina}#{var.deCiu}#{Supervisor$IngresarNuevaObra.totalpaginas}" />
                                        </rich:column>
                                        <rich:column width="150px" breakBefore="true">
                                            <h:outputText value="#{var.numerocontrato}"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="#{var.nombre}"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="Valor Contrato"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="Valor Disponible"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="#{var.datefechaini}"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="#{var.datefechafin}"/>
                                        </rich:column>
                                        <rich:column width="150px">
                                            <h:outputText value="#{var.seleccionar}"/>
                                        </rich:column>
                                    </rich:columnGroup>
                                </f:facet>
                                <rich:columnGroup id="cuerpoContrato">
                                    <rich:column width="150px" breakBefore="true">
                                        <h:outputText id="txt_contrato" value="#{currentRow.strnumcontrato}"/>
                                    </rich:column>
                                    <rich:column >
                                        <h:inputTextarea id="otxt_strnombreobra-listado" value="#{currentRow.strnombre}"  disabled="true" cols="35" rows="2"/>
                                    </rich:column>
                                    <rich:column>
                                        <h:outputText id="outvlcontrato" value="#{currentRow.numvlrcontrato}" >
                                            <f:convertNumber pattern="$#,###.00"/>
                                        </h:outputText>
                                    </rich:column>
                                    <rich:column>
                                        <h:outputText id="vlcondis" value="#{currentRow.numvlrcontrato-currentRow.numvlrsumahijos-currentRow.numvlrsumaproyectos}" >
                                            <f:convertNumber pattern="$#,###.00"/>
                                        </h:outputText>
                                    </rich:column>
                                    <rich:column>
                                        <h:outputText  value="#{currentRow.datefechaini}"/>
                                    </rich:column>
                                    <rich:column>
                                        <h:outputText  value="#{currentRow.datefechafin}"/>
                                    </rich:column>
                                    <rich:column width="120px" >
                                        <a4j:commandButton value="Seleccionar" action="#{Supervisor$IngresarNuevaObra.agregarContrato}"                                                           
                                                           oncomplete="javascript:Richfaces.showModalPanel('panelRelacionContrato')" render="layoutpanelRelacionContrato">
                                    </a4j:commandButton>
                                    </rich:column>
                                </rich:columnGroup>
                                <f:facet name="footer">
                                    <rich:columnGroup>
                                        <rich:column colspan="8" breakBefore="true" style="text-align: center;">
                                            <center>
                                                <h:panelGrid columns="4">
                                                    <a4j:commandButton id="btPriCont" value="#{var.primeroCiu}" disabled="#{!Supervisor$IngresarNuevaObra.veranteriorcontrato}" action="#{Supervisor$IngresarNuevaObra.primeroContratos}">
                                                        <a4j:ajax event="oncomplete" render="tablacontratos,gpTotalCont"/>
                                                    </a4j:commandButton>
                                                    <a4j:commandButton id="btAntCont" value="#{var.anteriorCiu}" disabled="#{!Supervisor$IngresarNuevaObra.veranteriorcontrato}" action="#{Supervisor$IngresarNuevaObra.anterioresContratos}">
                                                        <a4j:ajax event="oncomplete" render="tablacontratos,gpTotalCont"/>
                                                    </a4j:commandButton>
                                                    <a4j:commandButton id="btSigCont" value="#{var.siguienteCiu}" disabled="#{!Supervisor$IngresarNuevaObra.verultimoscontrato}" action="#{Supervisor$IngresarNuevaObra.siguienteContratos}">
                                                        <a4j:ajax event="oncomplete" render="tablacontratos,gpTotalCont"/>
                                                    </a4j:commandButton>
                                                    <a4j:commandButton id="btUltCont" value="#{var.ultimoCiu}" disabled="#{!Supervisor$IngresarNuevaObra.verultimoscontrato}" action="#{Supervisor$IngresarNuevaObra.ultimoContratos}">
                                                        <a4j:ajax event="oncomplete" render="tablacontratos,gpTotalCont"/>
                                                    </a4j:commandButton>
                                                </h:panelGrid>
                                            </center>
                                        </rich:column>
                                    </rich:columnGroup>
                                </f:facet>
                            </rich:dataTable>
                        </h:panelGrid>
                    </rich:panel>
                </h:panelGroup>
            </h:form>
        </center>
    </rich:popupPanel>
</f:view>